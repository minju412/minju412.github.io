---
title:  "[GCP] spring boot + jenkins + docker ë°°í¬í•˜ê¸° - 2. ë°°í¬ ì„œë²„ "

categories:
  - GCP
tags:
  - [GCP]

toc: true
toc_sticky: true
 
date: 2022-10-14 14:20:24
last_modified_at: 2022-10-14 14:20:27
---

> [ì´ ê¸€](https://velog.io/@znftm97/Jenkins%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4%EC%84%9C-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0)ì„ ì°¸ê³ í–ˆë‹¤.

```bash
$ chmod 700 ~/.ssh
$ chmod 600 ~/.ssh/authorized_keys
```









==========================

GCP í”„ë¡œì íŠ¸ ìƒì„±ë¶€í„° jenkins ì„¤ì¹˜ê¹Œì§€ëŠ” [ì´ì „ ê¸€](https://minju412.github.io/gcp/1/)ì—ì„œ ë‹¤ë¤˜ë‹¤.<br><br>
ìš°ì„ , ì´ì „ì— ë§Œë“  `jenkins` ì¸ìŠ¤í„´ìŠ¤ì—ì„œ [ìœ ì‚¬í•˜ê²Œ ë§Œë“¤ê¸°]ë¡œ `web` ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì.<br>
ìƒì„± í›„ì—ëŠ” ì™¸ë¶€ ê³ ì • IPë„ í• ë‹¹í•˜ì.<br>
(ê¸°ì¡´ì— ìˆë˜ `instance-1`ì€ ubuntu ì˜€ìœ¼ë¯€ë¡œ ì¼ë‹¨ ì¤‘ì§€í•´ë†“ì.)<br><br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-13 á„‹á…©á„’á…® 9 31 17](https://user-images.githubusercontent.com/59405576/195596730-9ca43c1c-7011-4a6c-ba3c-9ffae5f58acd.png)<br>
í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì¸ìŠ¤í„´ìŠ¤ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.
- `jenkins`: ì  í‚¨ìŠ¤ ì„œë²„, Centos7
- `web`: ë°°í¬ ì„œë²„, Centos7

ì  í‚¨ìŠ¤ ì„œë²„ì—ì„œëŠ” Dockerë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ ,<br>
ë°°í¬ ì„œë²„ì—ì„œëŠ” Dockerë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.

<br>

# ì‹œë‚˜ë¦¬ì˜¤
> [ì´ ê¸€](https://dev-gorany.tistory.com/345)ì„ ì°¸ê³ í–ˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-13 á„‹á…©á„’á…® 9 32 22](https://user-images.githubusercontent.com/59405576/195596855-1d9b623e-495e-4c70-89e8-50a569de2b20.png){: width="500" height="500"}
1. ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.
2. ê¹ƒí—™ì— Pushí•œë‹¤.
3. Webhookì´ ê±¸ë ¤ ì  í‚¨ìŠ¤ì—ê²Œ Jobì„ ì‹¤í–‰í•˜ë¼ê³  í•œë‹¤.
4. ì  í‚¨ìŠ¤ê°€ Buildí•´ì¤€ ê²°ê³¼ë¥¼ ë°°í¬ ì„œë²„ì— ë„˜ê¸´ë‹¤.
5. ë°°í¬ ì„œë²„ì—ì„œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•´ ìë™ ë°°í¬í•œë‹¤.


# ë°°í¬ ì„œë²„ (`web`)
## 1) Docker ì„¤ì¹˜
> [ì´ ê¸€](https://1mini2.tistory.com/21)ì„ ì°¸ê³ í–ˆìœ¼ë©°, [ê³µì‹ ì‚¬ì´íŠ¸](https://docs.docker.com/engine/install/centos/)ë¥¼ ì°¸ê³ í•´ë„ ëœë‹¤.

```bash
# yum-utils ì—…ë°ì´íŠ¸
$ sudo yum install -y yum-utils

# Docker-ce ì €ì¥ì†Œ ì¶”ê°€
$ sudo yum-config-manager \
--add-repo \
https://download.docker.com/linux/centos/docker-ce.repo

# ë„ì»¤ ì—”ì§„ ì„¤ì¹˜
$ sudo yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin

# ë„ì»¤ ì—”ì§„ ì‹¤í–‰ ë° ì„œë¹„ìŠ¤ ë“±ë¡
$ systemctl start docker
$ systemctl enable docker
$ systemctl status docker
```



## 2) Dockerfile ìƒì„±



## 3) `init.sh` ì‘ì„±


## 4) Githubì— Push


## 5) ìë™ ë°°í¬ ë˜ì—ˆëŠ”ì§€ í™•ì¸









# 2. ë°°í¬ ì„œë²„ì— ë„ì»¤ ì„¤ì¹˜













==========================

# `web`
## ì¸ìŠ¤í„´ìŠ¤ì— ë„ì»¤ ì„¤ì¹˜í•˜ê¸°
> [ì´ ê¸€](https://wings2pc.tistory.com/entry/%EB%8F%84%EC%BB%A4Docker-%EB%A6%AC%EB%88%85%EC%8A%A4linux%EC%97%90-%EB%8F%84%EC%BB%A4-%EC%84%A4%EC%B9%98%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%ED%99%9C%EC%9A%A9)ì„ ì°¸ê³ í–ˆë‹¤.


[](https://blog.dalso.org/google-cloud-platform-2/nas-project/8618)


```bash
$ sudo apt-get update

# í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜
$ sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common

# GCP Key ì¸ì¦
$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -

# finger pring í™•ì¸
$ sudo apt-key fingerprint 0EBFCD88

# docker repository emdfhr
$ sudo add-apt-repository \
"deb [arch=amd64] https://download.docker.com/linux/ubuntu \
$(lsb_release -cs) \
stable"

# docker ì„¤ì¹˜
$ sudo apt-get update && sudo apt-get install docker-ce docker-ce-cli containerd.io

$ docker -v

$ sudo systemctl enable docker && service docker start

# ê¶Œí•œ ë¶€ì—¬
$ sudo usermod -aG docker $USER
```




## spring boot ë°°í¬í•˜ê¸°
> [ì´ ê¸€](https://wings2pc.tistory.com/entry/%EB%8F%84%EC%BB%A4Docker-Dockerfile%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%98%EC%97%AC-springboot-app-%EB%B0%B0%ED%8F%AC-%EB%B0%8F-GCP-%EB%B0%A9%ED%99%94%EB%B2%BD-%EC%84%A4%EC%A0%95)ì„ ì°¸ê³ í–ˆë‹¤.














# Ref.





***
<br>


    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}