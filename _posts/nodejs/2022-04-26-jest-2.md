---
title:  "[Node.js] Jest - 2. ë¹„ë™ê¸° ì½”ë“œ í…ŒìŠ¤íŠ¸ "

categories:
  - NodeJs
tags:
  - [Framework, Node.js]

toc: true
toc_sticky: true
 
date: 2022-04-26
last_modified_at: 2022-04-26
---

# callback
## ë¹„ë™ê¸° ì½”ë“œ ì‘ì„±
`fn.js`
```js
const fn = {
  getName:(callback) => {
    const name="Mike";
    setTimeout(()=>{
      callback(name);
    }, 3000)
  }, // 3ì´ˆ í›„ì— ì´ë¦„ì„ ì•Œë ¤ì£¼ëŠ” í•¨ìˆ˜
};
module.exports = fn;
```
## í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
`fn.test.js`
```js
const fn = require("./fn");

test("3ì´ˆ í›„ì— ë°›ì•„ì˜¨ ì´ë¦„ì€ Mike", done => {
  function callback(name){
    expect(name).toBe("Mike");
    done();
  }
  fn.getName(callback);
}); // í…ŒìŠ¤íŠ¸ ì„±ê³µ
```
í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ì— `done`ì´ë¼ëŠ” ì½œë°±í•¨ìˆ˜ë¥¼ ì „ë‹¬ -> `done()`ì´ í˜¸ì¶œë˜ê¸° ì „ê¹Œì§€ jestëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ëë‚´ì§€ ì•Šê³  ê¸°ë‹¤ë¦°ë‹¤.
### try-catch
`fn.js`
```js
const fn = {
  getName:(callback) => {
    const name="Mike";
    setTimeout(()=>{
      // callback(name);
      throw new Error('ì„œë²„ ì—ëŸ¬...'); // ì—ëŸ¬ ì „ë‹¬
    }, 3000)
  }, 
};
module.exports = fn;
```
`fn.test.js`
```js
const fn = require("./fn");

test("3ì´ˆ í›„ì— ë°›ì•„ì˜¨ ì´ë¦„ì€ Mike", done => {
  function callback(name){
    try{
      expect(name).toBe("Mike");
      done();
    } catch(error){
      done(); // 'ì„œë²„ ì—ëŸ¬...'ê°€ í„°ë¯¸ë„ì— ì°íŒë‹¤.
    }
  }
  fn.getName(callback);
}); // í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ 
```
api ì—ëŸ¬ë¥¼ ê°ì§€í•˜ê³  ì‹¶ë‹¤ë©´ try-catchë¬¸ìœ¼ë¡œ ê°ì‹¸ì¤€ë‹¤.
# promise
## ë¹„ë™ê¸° ì½”ë“œ ì‘ì„±
`fn.js`
```js
const fn = {
  getAge:() => {
    const age=30;
    return new Promise((res,rej)=>{
      setTimeout(()=>{
        res(age);
        // rej('error'); // reject ìƒí™©ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œ..
      }, 3000)
    });
  },

};
module.exports = fn;
```
`promise`ë¥¼ ë„˜ê²¨ì£¼ë©´ jestëŠ” `resolve` ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤. ë”°ë¼ì„œ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ì— `done`ì„ ì „ë‹¬í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

## í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
```js
test("3ì´ˆ í›„ì— ë°›ì•„ì˜¨ ë‚˜ì´ëŠ” 30", () => {
  return fn.getAge().then(age => { // ğŸŒŸ
    expect(age).toBe(30);
  });
}); // í…ŒìŠ¤íŠ¸ ì„±ê³µ
```
ğŸš¨ ë¹„ë™ê¸° ì½”ë“œì— `promise`ë¥¼ ì‚¬ìš©í–ˆë‹¤ë©´, í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œ `return`ì„ ìŠìœ¼ë©´ ì•ˆë¨!

### ë³´ë‹¤ ê°„ë‹¨íˆ ì‘ì„±í•˜ê¸° ìœ„í•œ Matcher ì‚¬ìš©
#### resolves
```js
test("3ì´ˆ í›„ì— ë°›ì•„ì˜¨ ë‚˜ì´ëŠ” 30", () => {
  return expect(fn.getAge()).resolves.toBe(30);
}); // í…ŒìŠ¤íŠ¸ ì„±ê³µ
```
#### rejects
```js
test("3ì´ˆ í›„ì— ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤.", () => {
  return expect(fn.getAge()).rejects.toMatch('error');
}); // í…ŒìŠ¤íŠ¸ ì„±ê³µ
```
# async-await
## ë¹„ë™ê¸° ì½”ë“œ ì‘ì„± -> â“ğŸ¤”â“
`fn.js`
```js
const fn = async () => {
  getAge:() => {
    const age=30;
    setTimeout(()=>{
      return age;
    }, 3000)
  },

};
module.exports = fn;
```
## í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
```js
test("3ì´ˆ í›„ì— ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤.", async () => { 
  const age = await fn.getAge();
  expect(age).toBe(30);
}); // í…ŒìŠ¤íŠ¸ ì„±ê³µ
```
### ë³´ë‹¤ ê°„ë‹¨íˆ ì‘ì„±í•˜ê¸° ìœ„í•œ Matcher ì‚¬ìš©
#### resolves
```js
test("3ì´ˆ í›„ì— ë°›ì•„ì˜¨ ë‚˜ì´ëŠ” 30", () => {
  await expect(fn.getAge()).resolves.toBe(30);
}); // í…ŒìŠ¤íŠ¸ ì„±ê³µ
```
`return` ëŒ€ì‹  `await`ìœ¼ë¡œ ë³€ê²½
#### rejects
```js
test("3ì´ˆ í›„ì— ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤.", () => {
  await expect(fn.getAge()).rejects.toMatch('error');
}); // í…ŒìŠ¤íŠ¸ ì„±ê³µ
```
`return` ëŒ€ì‹  `await`ìœ¼ë¡œ ë³€ê²½

# ì°¸ê³ 
[ì½”ë”©ì•™ë§ˆ](https://www.youtube.com/watch?v=snFRUjYR6j4&list=PLZKTXPmaJk8L1xCg_1cRjL5huINlP2JKt&index=3)

***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}