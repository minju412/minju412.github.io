---
title:  "[프로그래머스] GROUP BY "
# excerpt: "sprintf에 대해 알아보자"

categories:
  - Sql
tags:
  - [Sql]

toc: true
toc_sticky: true
 
date: 2023-05-18 21:28:10
last_modified_at: 2023-05-18 21:28:12
---
## 1. 자동차 대여 기록에서 대여중 / 대여 가능 여부 구분하기 (Level 3)
[문제](https://school.programmers.co.kr/learn/courses/30/lessons/157340)

### 풀이
> [참고](https://suminii.tistory.com/entry/MYSQL-%EC%9E%90%EB%8F%99%EC%B0%A8-%EB%8C%80%EC%97%AC-%EA%B8%B0%EB%A1%9D%EC%97%90%EC%84%9C-%EB%8C%80%EC%97%AC%EC%A4%91-%EB%8C%80%EC%97%AC-%EA%B0%80%EB%8A%A5-%EC%97%AC%EB%B6%80-%EA%B5%AC%EB%B6%84%ED%95%98%EA%B8%B0)

```sql
SELECT CAR_ID,
    CASE
        WHEN CAR_ID IN (
            SELECT CAR_ID
            FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
            WHERE '2022-10-16' BETWEEN START_DATE AND END_DATE
        ) THEN '대여중'
        ELSE '대여 가능'
    END AS AVAILABILITY
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
ORDER BY CAR_ID DESC
```
- `CASE`문을 사용
- 서브쿼리를 사용해 `2022-10-06`일이 대여 시작일자(포함)와 대여 종료일자(포함) 사이에 있는 `CAR_ID`를 구한다.
  - `BETWEEN` ~ `AND` 사용
- `GROUP BY`를 통해 `CAR_ID`별로 위에서 구한 조건에 해당하는 `CAR_ID`라면 '대여중'으로, 그렇지 않으면 '대여 가능'으로 표시한 후 <br>
`AVAILABILITY`라는 컬럼에 값을 출력한다.
- `ORDER BY`를 이용해 `CAR_ID`를 기준으로 내림차순 정렬한다.





***
<br>


    💛 개인 공부 기록용 블로그입니다. 👻

[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}