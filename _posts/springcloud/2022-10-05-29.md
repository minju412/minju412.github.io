---
title:  "[E-commerce App] Profilesë¥¼ í†µí•œ Configuration ì ìš© "

categories:
  - SpringCloud
tags:
  - [SpringCloud]

toc: true
toc_sticky: true
 
date: 2022-10-05 14:16:24
last_modified_at: 2022-10-05 14:16:27
---

ë©€í‹° í™˜ê²½ì—ì„œ êµ¬ì„± ì •ë³´ë¥¼ ë‹¬ë¦¬ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ì.<br>
ì´ë¥¼ ìœ„í•´, ë‹¤ì–‘í•œ profilesë¥¼ ê°€ì§„ êµ¬ì„± ì •ë³´ íŒŒì¼(yml)ì„ ì—¬ëŸ¬ê°œ ë§Œë“¤ì–´ë†“ê³  ìƒí™©ì— ë§ëŠ” yml íŒŒì¼ì„ ì ìš©í•  ê²ƒì´ë‹¤.<br>

# ì—¬ëŸ¬ profilesë¥¼ ê°–ëŠ” yml íŒŒì¼ ìƒì„±

`ecommerce.yml`<br>
```yml
token:
  expiration_time: 864000000
  secret: my_token_default

gateway:
  ip: 127.0.0.1
```
<br>

`ecommerce-dev.yml`<br>
```yml
token:
  expiration_time: 864000000
  secret: my_token_default_dev

gateway:
  ip: 127.0.0.1
```
<br>

`ecommerce-prod.yml`<br>
```yml
token:
  expiration_time: 864000000
  secret: my_token_default_prod

gateway:
  ip: 127.0.0.1
```
<br>

add - commit ê¹Œì§€ ë§ˆì¹œë‹¤.
<br>

# `bootstrap.yml` ë³€ê²½
`user-service`ì™€ `gateway-service`ì˜ `bootstrap.yml` íŒŒì¼ì„ ë³€ê²½í•œë‹¤.<br>

`user-service`<br>
```yml
spring:
  cloud:
    config:
      uri: http://127.0.0.1:8888
      name: ecommerce
  profiles: # ğŸŒŸ ì¶”ê°€
    active: dev
```
<br>

`gateway-service`<br>
```yml
spring:
  cloud:
    config:
      uri: http://127.0.0.1:8888
      name: ecommerce
  profiles: # ğŸŒŸ ì¶”ê°€
    active: prod
```
<br>

ì´ë ‡ê²Œ ë³€ê²½í•œ ë’¤, `user-service`ì™€ `gateway-service` ë‘ ê°œì˜ ì„œë²„ë¥¼ ì¬ê¸°ë™í•œë‹¤.

# í…ŒìŠ¤íŠ¸

`user-service`ì™€ `gateway-service`ì— í† í°ì„ ê°€ì ¸ì˜¤ëŠ” ë¶€ë¶„(`env.getProperty("token.secret")`)ì— break pointë¥¼ ì°ê³ , ë””ë²„ê·¸ ëª¨ë“œë¡œ ì‹¤í–‰í•˜ì.<br>
í¬ìŠ¤íŠ¸ë§¨ìœ¼ë¡œ ë¡œê·¸ì¸ì„ ì§„í–‰í•´ë³´ì.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-05 á„‹á…©á„’á…® 2 39 32](https://user-images.githubusercontent.com/59405576/193989196-1561a523-7782-4042-bf8b-51fdc29f50f1.png)<br>
`user-service`ì—ì„œëŠ” `my_token_dev`ë¥¼ ê°€ì ¸ì™”ë‹¤.<br>
(í† í°ê°’ì„ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ”, ìœ„ ì‚¬ì§„ì—ì„œ ë³´ì´ëŠ” ê²ƒì²˜ëŸ¼ `env.getProperty("token.secret")`ì„ ì…ë ¥í•˜ê³  ì˜¤ë¥¸ìª½ `+`ë¡œ ì¶”ê°€í•œë‹¤.)<br><br>
ì´ë²ˆì—ëŠ” ë¡œê·¸ì¸ í•˜ê³  ë°›ì€ í† í°ì„ ì´ìš©í•´ `/user-service/health-check`ë¡œ ìš”ì²­í•´ë³´ì.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-05 á„‹á…©á„’á…® 2 42 23](https://user-images.githubusercontent.com/59405576/193989391-1e47ca2a-0f1b-4b47-8634-0ef642b6f428.png)<br>
`gateway-service`ì—ì„œëŠ” `my_token_prod`ë¥¼ ê°€ì ¸ì™”ë‹¤.<br><br>
ì´ì²˜ëŸ¼ í† í° ì •ë³´ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ê¶Œí•œì´ ì—†ë‹¤ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-05 á„‹á…©á„’á…® 2 47 52](https://user-images.githubusercontent.com/59405576/193990101-2caa982f-cd5c-46d6-a58a-d9af1d6c95b4.png)<br>
ë”°ë¼ì„œ ê°™ì€ í† í°ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ `gateway-service`ì˜ `bootstrap.yml`ì—ì„œ `spring.profiles.active`ë¥¼ ê¸°ì¡´ `prod`ì—ì„œ `dev`ë¡œ ë°”ê¾¼ë‹¤.<br><br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-05 á„‹á…©á„’á…® 2 52 12](https://user-images.githubusercontent.com/59405576/193990612-fb0a41ff-b6c8-451d-817f-3ed0cbbd55df.png)<br>
ì´ë²ˆì—ëŠ” 200 OK ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.






***
<br>


    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}