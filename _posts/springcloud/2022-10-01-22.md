---
title:  "[E-commerce App] Users Microservicedì™€ Spring Cloud Gateway ì—°ë™ "

categories:
  - SpringCloud
tags:
  - [SpringCloud]

toc: true
toc_sticky: true
 
date: 2022-10-01 23:02:09
last_modified_at: 2022-10-01 23:02:13
---

ì´ì „ê¹Œì§€ëŠ”, `user-microservice`ì— ëœë¤í¬íŠ¸ê°€ ì ìš©ë˜ì–´ìˆê¸° ë•Œë¬¸ì— <br>
ë§¤ë²ˆ ìœ ë ˆì¹´ë¥¼ í†µí•´ `user-microservice`ì˜ í¬íŠ¸ë²ˆí˜¸ë¥¼ í™•ì¸í•œ ë’¤ì— ìš”ì²­í•´ì•¼í–ˆë‹¤.<br><br>
ê·¸ëŸ°ë° `user-microservice`ë¥¼ ê²Œì´íŠ¸ì›¨ì´ ì„œë¹„ìŠ¤ì— ë“±ë¡í•˜ê²Œ ë˜ë©´,<br>
í• ë‹¹ëœ í¬íŠ¸ì— ìƒê´€ì—†ì´ ì„œë¹„ìŠ¤ì˜ `name`ì„ í†µí•´ ì ‘ê·¼í•  ê²ƒì´ê¸° ë•Œë¬¸ì— í›¨ì”¬ í¸í•˜ê²Œ ì‘ì—…í•  ìˆ˜ ìˆë‹¤.

# `gateway-service` ìƒì„±
- Spring Boot: 2.7.4
- dependencies<br>- `Gateway`, `Eureka Discovery Client`, `Lombok`

## 1) `gateway-service`ì— `user-service` route ì •ë³´ ë“±ë¡
### `application.yml`
```yml
server:
  port: 8000

eureka:
  client:
    register-with-eureka: true
    fetch-registry: true
    service-url:
      defaultZone: http://localhost:8761/eureka

spring:
  application:
    name: gateway-service
  cloud:
    gateway:
      routes:
        - id: user-service
          uri: lb://USER-SERVICE
          predicates:
            - Path=/user-service/**

```

## 2) ê²Œì´íŠ¸ì›¨ì´ì— ì„¤ì •í•œ í¬íŠ¸ë²ˆí˜¸ë¡œ `user-service` ì ‘ì†
### `user-service`ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ì— prefix ì§€ì •
`UserController.java`
```java
@RestController
@RequestMapping("/user-service") // ğŸŒŸ gatewayë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ prefixë¥¼ ì§€ì •í•œë‹¤.
public class UserController {
    ...
}
```

### ìš”ì²­í•  ì—”ë“œí¬ì¸íŠ¸ì— `/user-service` ì¶”ê°€
ì˜ˆë¥¼ ë“¤ì–´, `/health-check`ì— ì ‘ì†í•˜ê³  ì‹¶ë‹¤ë©´,<br>
`http://[IP]:[ê²Œì´íŠ¸ì›¨ì´ í¬íŠ¸ë²ˆí˜¸]/user-service/health-check`ë¡œ ì ‘ì†í•œë‹¤.<br><br>
ì´ì œ API Gateway ì„œë¹„ìŠ¤ë¥¼ í†µí•´ `user-service`ì— ìš”ì²­í•  ìˆ˜ ìˆë‹¤.<br>
ë˜í•œ, í•˜ë‚˜ì˜ í¬íŠ¸ ë²ˆí˜¸(ê²Œì´íŠ¸ì›¨ì´ì˜ í¬íŠ¸ ë²ˆí˜¸)ë¡œ ì—¬ëŸ¬ ë§ˆì´í¬ë¡œ ì„œë¹„ìŠ¤ì— ìš”ì²­í•  ìˆ˜ ìˆë‹¤.














***
<br>


    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}