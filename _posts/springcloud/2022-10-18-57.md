---
title:  "[E-commerce App] Docker Containerë¥¼ ì´ìš©í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ - 5. Prometheus & Grafana "

categories:
  - SpringCloud
tags:
  - [SpringCloud]

toc: true
toc_sticky: true
 
date: 2022-10-18 18:35:48
last_modified_at: 2022-10-18 18:35:50
---

ì´ì „ ê¸€ì— ì´ì–´ì„œ ì§„í–‰í•´ë³´ì.

# Docker Container
## 8. Prometheus
### 1) `prometheus.yml` íŒŒì¼ ìˆ˜ì •
ì´ì „ì— `prometheus.yml` íŒŒì¼ì— jobì„ 3ê°œ ë“±ë¡í–ˆì—ˆë‹¤.<br>
ê·¸ ë•Œ `targets`ì„ `localhost:8000`ìœ¼ë¡œ í–ˆì—ˆëŠ”ë°, ì´ê²ƒì„ ë„ì»¤ ì»¨í…Œì´ë„ˆì˜ ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•˜ì.<br>
(8000ë²ˆ í¬íŠ¸ëŠ” ê²Œì´íŠ¸ì›¨ì´ì˜ í¬íŠ¸ì´ë‹¤.)<br><br>
`docker network inspect ecommerce-network` ì»¤ë§¨ë“œë¡œ `gateway-service`ì˜ IP Addressë¥¼ í™•ì¸í•œ ë’¤ì—,<br>
IP Addressë¥¼ ì ì–´ë„ ë˜ì§€ë§Œ, IP AddressëŠ” ë³€ê²½ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì»¨í…Œì´ë„ˆì˜ ì´ë¦„ì„ ì‚¬ìš©í•˜ì.<br><br>
ë³€ê²½ ì „<br>
<img width="644" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-18 á„‹á…©á„’á…® 7 01 05" src="https://user-images.githubusercontent.com/59405576/196400376-87d7f0bf-a4a9-4db3-a93e-d7de30a9537a.png"><br><br>
ë³€ê²½ í›„<br>
<img width="648" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-18 á„‹á…©á„’á…® 7 02 51" src="https://user-images.githubusercontent.com/59405576/196400681-8e7e0e3f-1912-4e96-be3e-f90eef42dd10.png"><br>
ì´ ë•Œ, ë§¨ ìœ„ì˜ `localhost`ëŠ” `prometheus`ë¡œ ë³€ê²½í–ˆëŠ”ë°,<br>
ì´ëŠ” í”„ë¡œë©”í…Œìš°ìŠ¤ ì»¨í…Œì´ë„ˆë¥¼ ì•„ì§ ìƒì„±í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ, ì´í›„ì— `prometheus`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ìƒì„±í•  ì˜ˆì •ì´ê¸° ë•Œë¬¸ì— <br>
í”„ë¡œë©”í…Œìš°ìŠ¤ ì»¨í…Œì´ë„ˆì˜ ì´ë¦„ìœ¼ë¡œ ë¯¸ë¦¬ ë³€ê²½í•œ ê²ƒì´ë‹¤.


### 2) ë„ì»¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
> [ê³µì‹ í™ˆí˜ì´ì§€](https://prometheus.io/docs/prometheus/latest/installation/#using-docker)


#### `prometheus.yml` íŒŒì¼ ìœ„ì¹˜ ì°¾ê¸°
ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ë•Œ ë¡œì»¬ ì‹œìŠ¤í…œì— ìˆëŠ” `prometheus.yml` íŒŒì¼ì„ í”„ë¡œë©”í…Œìš°ìŠ¤ì˜ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ë¡œ ì´ë™í•´ì•¼ í•œë‹¤.<br>
ë³¼ë¥¨ ë§ˆìš´íŠ¸ë¥¼ ìœ„í•´ ë¡œì»¬ì— ì¡´ì¬í•˜ëŠ” `prometheus.yml` íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì•Œì•„ë³´ì.<br>
<img width="458" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-18 á„‹á…©á„’á…® 7 06 32" src="https://user-images.githubusercontent.com/59405576/196401515-12a0e8e2-471f-4e66-a7f9-d750dc5db31c.png"><br>
ë‚˜ëŠ” `/Users/minju/study/msa/prometheus-2.39.1.darwin-amd64` ìœ„ì¹˜ì— ì¡´ì¬í•œë‹¤.

#### ì‹¤í–‰
```bash
$ docker run -d -p 9090:9090 \
--network ecommerce-network \
--name prometheus \
-v /Users/minju/study/msa/prometheus-2.39.1.darwin-amd64/prometheus.yml:/etc/prometheus/prometheus.yml \
prom/prometheus 
```
<img width="1422" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-18 á„‹á…©á„’á…® 7 15 50" src="https://user-images.githubusercontent.com/59405576/196403363-871ff2c8-f865-4cf1-a1a8-a504c9a3df88.png"><br><br>
í”„ë¡œë©”í…Œìš°ìŠ¤ ì»¨í…Œì´ë„ˆì—ì„œ `prometheus.yml` íŒŒì¼ì˜ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ,<br>
ë³¼ë¥¨ ë§ˆìš´íŠ¸ í˜¹ì€ copyë¥¼ ì´ìš©í•˜ë©´ ë˜ëŠ”ë° ìœ„ ì˜ˆì‹œëŠ” ë³¼ë¥¨ ë§ˆìš´íŠ¸ë¥¼ ì´ìš©í–ˆë‹¤.<br><br>
`/Users/minju/study/msa/prometheus-2.39.1.darwin-amd64/prometheus.yml` ë¶€ë¶„ì— `prometheus.yml` íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì§€ì •í•˜ë©´ ëœë‹¤.<br><br>
ë³¼ë¥¨ ë§ˆìš´íŠ¸ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´, íŒŒì¼ì„ ì§ì ‘ copy í•˜ì§€ ì•Šì•„ë„ host PCì— ìˆëŠ” íŒŒì¼ì„ ì´ìš©í•´ ì»¨í…Œì´ë„ˆë¥¼ ê¸°ë™í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.<br>
(ê³µìœ  ë””ë ‰í† ë¦¬ì˜ ê°œë…ìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆë‹¤.)<br><br>
ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•´ë³´ì.
```bash
$ docker network inspect ecommerce-network
```
<img width="620" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-18 á„‹á…©á„’á…® 7 18 58" src="https://user-images.githubusercontent.com/59405576/196403971-44cf44b9-55a7-40fa-8da9-11bc2b468976.png">

ì•„ë˜ì™€ ê°™ì´ ì›¹ ë¸Œë¼ìš°ì €ë„ ì ‘ì† ê°€ëŠ¥í•˜ë‹¤.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-18 á„‹á…©á„’á…® 7 23 18](https://user-images.githubusercontent.com/59405576/196404909-783222cf-4d6f-4ec2-9668-992f63a8d70b.png){: width="500" height="500"}

## 9. Grafana
> [ê³µì‹ í™ˆí˜ì´ì§€](https://grafana.com/grafana/download?platform=docker)

```bash
$ docker run -d -p 3000:3000 \
--network ecommerce-network \
--name grafana \
grafana/grafana 
```
<img width="1421" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-18 á„‹á…©á„’á…® 7 17 43" src="https://user-images.githubusercontent.com/59405576/196403740-a8b6aab1-9aa7-45b3-b205-b6db052efbda.png"><br><br>
ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•´ë³´ì.
```bash
$ docker network inspect ecommerce-network
```
<img width="619" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-18 á„‹á…©á„’á…® 7 18 36" src="https://user-images.githubusercontent.com/59405576/196403914-a9eb5c4c-6386-4cb1-9705-1ea63c986b82.png">

ë§ˆì°¬ê°€ì§€ë¡œ ì›¹ ë¸Œë¼ìš°ì €ë„ ì ‘ì† ê°€ëŠ¥í•˜ë‹¤.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-18 á„‹á…©á„’á…® 7 21 38](https://user-images.githubusercontent.com/59405576/196404570-261e276c-2ede-42a1-b570-ae408ceeedcd.png){: width="500" height="500"}





***
<br>


    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}