---
title:  "[E-commerce App] Apache Kafka ì„¤ì¹˜ ë° ì‚¬ìš© "

categories:
  - SpringCloud
tags:
  - [SpringCloud]

toc: true
toc_sticky: true
 
date: 2022-10-08 22:31:07
last_modified_at: 2022-10-08 22:31:10
---

# ê°œìš”
## Kafka ì‚¬ìš© ì´ì „
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-08 á„‹á…©á„’á…® 10 53 13](https://user-images.githubusercontent.com/59405576/194710995-d7583cb1-e29b-4852-b915-1a41d32fc0e0.png){: width="500" height="500"}
- End-to-End ì—°ê²° ë°©ì‹ì˜ ì•„í‚¤í…ì²˜
- ë°ì´í„° ì—°ë™ì˜ ë³µì¡ì„± ì¦ê°€ (HW, ìš´ì˜ì²´ì œ, ì¥ì•  ë“±)
- ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„° Pipeline ì—°ê²° êµ¬ì¡°
- í™•ì¥ì´ ì–´ë ¤ìš´ êµ¬ì¡°

## Kafkaì˜ ë„ì…
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-08 á„‹á…©á„’á…® 10 55 25](https://user-images.githubusercontent.com/59405576/194711100-c1133275-3d11-47a0-aca8-0dc2cb082227.png){: width="500" height="500"}<br><br>
Apache Kafkaë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” ìª½(Producer)ì€ ëˆ„ê°€ ë°›ëŠ” ì§€ì— ëŒ€í•´ ì‹ ê²½ì“°ì§€ ì•Šê³ ,<br>
ë©”ì‹œì§€ë¥¼ ë°›ëŠ” ìª½(Consumer)ì€ ëˆ„ê°€ ë³´ëƒˆëŠ” ì§€ì— ëŒ€í•´ ì „í˜€ ì‹ ê²½ì“°ì§€ ì•Šê³  ë©”ì‹œì§€ë¥¼ ì£¼ê³  ë°›ì„ ìˆ˜ ìˆë‹¤.
- Producer/Consumer ë¶„ë¦¬
- ë©”ì‹œì§€ë¥¼ ì—¬ëŸ¬ Consumerì—ê²Œ í—ˆìš©
- ë†’ì€ ì²˜ë¦¬ëŸ‰ì„ ìœ„í•œ ë©”ì‹œì§€ ìµœì í™”
- Scale-out ê°€ëŠ¥ (Kafkaê°€ clustering êµ¬ì¡°ì´ê¸° ë•Œë¬¸)
- Eco-system

## Kafka Broker
- ì‹¤í–‰ëœ Kafka ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„
- 3ëŒ€ ì´ìƒì˜ Broker Cluster êµ¬ì„±
- Zookeeper ì—°ë™<br>- ì—­í• : ë©”íƒ€ë°ì´í„° (Broker ID, Controller ID ë“±) ì €ì¥<br>- Controller ì •ë³´ ì €ì¥<br>![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-08 á„‹á…©á„’á…® 11 00 29](https://user-images.githubusercontent.com/59405576/194711330-adf88d45-f2a5-431e-9e89-f833b74e5f60.png){: width="300" height="300"}
- nê°œ Broker ì¤‘ 1ëŒ€ëŠ” Controller ê¸°ëŠ¥ ìˆ˜í–‰

> Controllerì˜ ì—­í• ?<br>
- ê° Brokerì—ê²Œ ë‹´ë‹¹ íŒŒí‹°ì…˜ í• ë‹¹ ìˆ˜í–‰
- Broker ì •ìƒ ë™ì‘ ëª¨ë‹ˆí„°ë§ ê´€ë¦¬

# Apache Kafka ì„¤ì¹˜
> Kafka í™ˆí˜ì´ì§€<br>
[http://kafka.apache.org](http://kafka.apache.org) (Windows ë²„ì „ê³¼ MacOS ë²„ì „ ë‘˜ ë‹¤ ì••ì¶•íŒŒì¼ì„ ë‹¤ìš´ ë°›ìœ¼ë©´ ëœë‹¤.)

ìœ„ ì‚¬ì´íŠ¸ì—ì„œ ì••ì¶• íŒŒì¼ì„ ë‹¤ìš´ ë°›ì€ ë’¤ì—, ì›í•˜ëŠ” ê³³ìœ¼ë¡œ ì˜®ê²¨ ì••ì¶•ì„ í•´ì œí•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ë””ë ‰í† ë¦¬ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-08 á„‹á…©á„’á…® 11 31 28](https://user-images.githubusercontent.com/59405576/194712675-e8b193d8-45bf-426e-8ffe-61c3e877cbdd.png)

## ì„¤ì •
ì••ì¶•ì„ í‘¼ í´ë”ì— ê°€ì„œ `/config/server.properties` íŒŒì¼ì„ vimí˜¹ì€ vscodeë¡œ ì—°ë‹¤.
```bash
$ cd config
$ code server.properties # ì„¤ì • ë³€ê²½
```
ê·¸ë¦¬ê³  `listenres`, `advertised-listener`, `listenr.security` ë¶€ë¶„ì„ í™œì„±í™” ì‹œì¼œì£¼ê³  ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•œë‹¤.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-09 á„‹á…©á„Œá…¥á†« 12 55 08](https://user-images.githubusercontent.com/59405576/194716309-5572488e-79fe-495c-93ab-1c2162d1c0f0.png)<br>
ì°¸ê³ ë¡œ ì•„ë˜ ì²« ë²ˆì§¸ ë¸”ë¡œê·¸ì—ì„œëŠ” `vi ~/.zshrc` ì»¤ë§¨ë“œë¡œ í™˜ê²½ë³€ìˆ˜ë„ ì¶”ê°€í–ˆëŠ”ë°, ë‚˜ëŠ” í•˜ì§€ ì•Šì•˜ë‹¤.

> ì°¸ê³ <br>
- [https://velog.io/@kurikuri/m1-%EC%97%90-kafka%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0brew-x](https://velog.io/@kurikuri/m1-%EC%97%90-kafka%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0brew-x)
- [https://yooloo.tistory.com/68](https://yooloo.tistory.com/68)





# Apache Kafka ì‚¬ìš©
## Ecosystem - 1. Kafka Client
- Kafkaì™€ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” Java Library<br>- [https://mvnrepository.com/artifact/org.apache.kafka/kafka-clients](https://mvnrepository.com/artifact/org.apache.kafka/kafka-clients)
- Producer, Consumer, Admin, Stream ë“± Kafka ê´€ë ¨ API ì œê³µ
- ë‹¤ì–‘í•œ 3rd party library ì¡´ì¬: C/C++, Node.js, Python, .NET ë“±<br>- [https://cwiki.apache.org/confluence/display/KAFKA/Clients](https://cwiki.apache.org/confluence/display/KAFKA/Clients)

### Kafka ì„œë²„ êµ¬ë™ ë° Topic ìƒì„±
ì••ì¶• í‘¼ í´ë”ë¡œ ì´ë™ í›„ ì•„ë˜ ì»¤ë§¨ë“œë¥¼ ì‹¤í–‰í•œë‹¤.<br>
zookeeper ì„œë²„ë¥¼ ë¨¼ì € êµ¬ë™í•œ ë’¤ì— kafka ì„œë²„ë¥¼ êµ¬ë™í•˜ê³ , ìƒˆë¡œìš´ topicì„ ìƒì„±í•´ë³´ì.
```bash
# Zookeeper ì„œë²„ êµ¬ë™
$ ./bin/zookeeper-server-start.sh ./config/zookeeper.properties

# Kafka ì„œë²„ êµ¬ë™
$ ./bin/kafka-server-start.sh ./config/server.properties
```

```bash
# Topic ìƒì„±
$ ./bin/kafka-topics.sh --bootstrap-server localhost:9092 --create -topic quickstart-events --partitions 1

# Topic ëª©ë¡ í™•ì¸
$ ./bin/kafka-topics.sh --bootstrap-server localhost:9092 --list

# Topic ì •ë³´ í™•ì¸
$ ./bin/kafka-topics.sh --bootstrap-server localhost:9092 --describe --topic quickstart-events
```
`quickstart-events`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í† í”½ì„ ìƒì„±í•œ ë’¤, ì´ë¥¼ í™•ì¸í•´ë³´ì.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-09 á„‹á…©á„Œá…¥á†« 1 09 32](https://user-images.githubusercontent.com/59405576/194716914-a5cc7050-6707-47ba-98eb-1d8ebff8717a.png)<br><br>
kafkaëŠ” producer ìª½ì—ì„œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©´, ê·¸ ë©”ì‹œì§€ëŠ” Topic ì´ë¼ëŠ” ê³³ì— ì €ì¥ëœë‹¤.<br>
í•´ë‹¹ Topicì„ êµ¬ë…í•œ consumerëŠ” Topicì— ìƒˆë¡œìš´ ë©”ì‹œì§€ê°€ ë“¤ì–´ì˜¬ ë•Œ, ì¼ê´„ì ìœ¼ë¡œ ì „ë‹¬ë°›ì„ ìˆ˜ ìˆë‹¤.<br>
ë”°ë¼ì„œ, ë³´ë‚´ëŠ” ìª½(producer)ê³¼ ë°›ëŠ” ìª½(consumer)ì€ ìƒëŒ€ê°€ ëˆ„êµ¬ì¸ì§€ ì‹ ê²½ì“°ì§€ ì•Šê³ , Topicì„ ìƒëŒ€ë¡œ í•œë‹¤.

### ë©”ì‹œì§€ ìƒì‚° ë° ì†Œë¹„
ì••ì¶• í‘¼ í´ë”ë¡œ ì´ë™ í›„ ì•„ë˜ ì»¤ë§¨ë“œë¥¼ ì‹¤í–‰í•œë‹¤.
```bash
# ë©”ì‹œì§€ ìƒì‚°(produce)
$ ./bin/kafka-console-producer.sh --broker-list localhost:9092 --topic quickstart-events

# ë©”ì‹œì§€ ì†Œë¹„(consume)
$ ./bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic quickstart-events --from-beginning
```
`--from-beginning`ì€ ëª¨ë“  ë©”ì‹œì§€ë¥¼ ì²˜ìŒë¶€í„° ì–»ì–´ì˜¤ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.<br><br>
ë‘ ê°œì˜ ì½˜ì†”ë¡œ í…ŒìŠ¤íŠ¸í•´ë³´ì.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-09 á„‹á…©á„Œá…¥á†« 1 16 38](https://user-images.githubusercontent.com/59405576/194717208-f232d1b2-6c81-4aa5-bb1b-dd891fff1930.png)<br>
producerê°€ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ë©´, consumer ìª½ì—ì„œ ë°”ë¡œë°”ë¡œ ë°›ì•„ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br><br>
ì´ë²ˆì—ëŠ” í•˜ë‚˜ì˜ ì½˜ì†”ì°½ì„ ì¶”ê°€ë¡œ ì—´ì–´ì„œ, <br>
ì´ì „ê³¼ ê°™ì´ `./bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic quickstart-events --from-beginning` ì»¤ë§¨ë“œë¡œ ë‘ ë²ˆì§¸ consumerë¥¼ ë“±ë¡í•´ë³´ì.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-09 á„‹á…©á„Œá…¥á†« 1 47 21](https://user-images.githubusercontent.com/59405576/194718368-789b12b0-e187-40fb-a7ba-9fe25946918a.png)<br>
ë§¨ ì•„ë˜ì— ë³´ì´ëŠ”ê²Œ ë‘ ë²ˆì§¸ë¡œ ë§Œë“  consumerì¸ë°, `--from-beginning` ì˜µì…˜ ë•Œë¬¸ì— ì²˜ìŒ ë©”ì‹œì§€ë¶€í„° ê°€ì ¸ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br>
ê·¸ë¦¬ê³  producerê°€ `hello second consumer`ë¼ëŠ” ë©”ì‹œì§€ë¥¼ í† í”½ì— ì „ë‹¬í•˜ë‹ˆ, ë‘ ê°œì˜ consumerì—ì„œ ë™ì‹œì— ë°›ì•„ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## Ecosystem - 2. Kafka Connect





## Kafka Connect














***
<br>


    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}