---
title:  "[E-commerce App] Docker Containerë¥¼ ì´ìš©í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ - 8. Catalog Microservice "

categories:
  - SpringCloud
tags:
  - [SpringCloud]

toc: true
toc_sticky: true
 
date: 2022-10-19 00:55:55
last_modified_at: 2022-10-19 00:55:58
---

ì´ì „ ê¸€ì— ì´ì–´ì„œ ì§„í–‰í•´ë³´ì.<br>

# Docker Container
## 12. `catalog-service` ë³€ê²½
### 1) `KafkaConsumerConfig.java`
ì´ì „ì˜ `order-service`ì—ì„œ `KafkaProducerConfig.java` ì½”ë“œë¥¼ ë³€ê²½í–ˆì„ ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ<br>
`catalog-service`ì—ì„œë„, kafka brokerì˜ IP Addressë¥¼ kafka broker containerì˜ IP Addressë¡œ ë³€ê²½í•˜ì.<br><br>
ë³€ê²½ ì „<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-19 á„‹á…©á„Œá…¥á†« 1 04 17](https://user-images.githubusercontent.com/59405576/196483753-d75e4fa2-0d0e-4092-b839-d0a4e3c37372.png)<br><br>
ë³€ê²½ í›„<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-19 á„‹á…©á„Œá…¥á†« 1 04 42](https://user-images.githubusercontent.com/59405576/196483826-bd97edac-7107-4817-ac3a-f4ce9eb69d56.png)


### 2) Dockerfileì„ í†µí•´ ì´ë¯¸ì§€ ë§Œë“¤ê¸°
```Dockerfile
FROM openjdk:17-ea-11-jdk-slim

VOLUME /tmp

COPY target/catalog-service-0.0.1-SNAPSHOT.jar CatalogService.jar

ENTRYPOINT ["java","-jar","CatalogService.jar"]
```

### 3) ì´ë¯¸ì§€ ë¹Œë“œ ë° ë„ì»¤ í—ˆë¸Œì— ì—…ë¡œë“œ
```bash
# ìµœì‹  ë²„ì „ìœ¼ë¡œ ì»´íŒŒì¼
$ mvn clean compile package -DskipTests=true
# cleanì€ ê¸°ì¡´ íŒŒì¼ì„ ì§€ìš´ë‹¤.
# package ì˜µì…˜ìœ¼ë¡œ jar íŒŒì¼ê¹Œì§€ ìƒì„±í•  ìˆ˜ ìˆë‹¤.
# í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” skip

# ì´ë¯¸ì§€ íŒŒì¼ ë¹Œë“œ
$ docker build -t ln8847/catalog-service:1.0  .

# ìƒì„±ëœ ì´ë¯¸ì§€ í™•ì¸
$ docker images | grep catalog-service

# ë„ì»¤ í—ˆë¸Œì— ì—…ë¡œë“œ
$ docker push ln8847/catalog-service:1.0
```

### 4) ë„ì»¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
ê¸°ì¡´ì˜ `application.yml`ì—ì„œ `127.0.0.1` í˜¹ì€ `localhost`ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ë¶€ë¶„ì„ `-e` ì˜µì…˜ì„ í†µí•´ ë„ì»¤ ì»¨í…Œì´ë„ˆì˜ ì´ë¦„ìœ¼ë¡œ ë°”ê¿”ì„œ ì‹¤í–‰í•˜ì.
```bash
$ docker run -d --network ecommerce-network \
-e "eureka.client.serviceUrl.defaultZone=http://service-discovery:8761/eureka/" \
-e "logging.file=/api-logs/catalogs-ws.log" \
--name catalog-service \
ln8847/catalog-service:1.0
```
<img width="1420" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-19 á„‹á…©á„Œá…¥á†« 1 09 03" src="https://user-images.githubusercontent.com/59405576/196484768-eb3f06df-521f-41b7-819b-d1af3bb40a3e.png">

ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•´ë³´ì.
```bash
$ docker network inspect ecommerce-network
```
<img width="611" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-19 á„‹á…©á„Œá…¥á†« 1 09 56" src="https://user-images.githubusercontent.com/59405576/196484941-b1b30b4d-ab15-4b87-b4a2-25cfa1bf0af7.png">

ë¡œê·¸ë¥¼ í™•ì¸í•´ë³´ì.
```bash
$ docker logs catalog-service
```
<img width="1426" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-19 á„‹á…©á„Œá…¥á†« 1 11 15" src="https://user-images.githubusercontent.com/59405576/196485216-117e03a6-8779-43a7-91da-874ac1995a80.png"><br>
ë³„ë‹¤ë¥¸ ì˜¤ë¥˜ ì—†ì´ ì •ìƒì ìœ¼ë¡œ ê¸°ë™ë˜ì—ˆë‹¤.

`http://127.0.0.1:8761`ì— ì ‘ì†í•´ catalog-serviceê°€ ì˜ ë“±ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ì.<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-19 á„‹á…©á„Œá…¥á†« 1 12 01](https://user-images.githubusercontent.com/59405576/196485358-38bd87c9-ce04-48b6-a275-4a69e6234693.png)


> ì°¸ê³ <br>
ì§€ê¸ˆì€ configuration ì„œë²„ì™€ rabbitmqëŠ” ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì¶”ê°€í•˜ì§€ ì•Šì•˜ì§€ë§Œ, <br>
ë‚˜ì¤‘ì— ì‚¬ìš©í•˜ê²Œ ëœë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ `-e` ì˜µì…˜ì„ ì´ìš©í•´ ì¶”ê°€í•˜ë©´ ëœë‹¤.
```bash
$ docker run -d --network ecommerce-network \
-e "spring.cloud.config.uri=http://config-service:8888" \
-e "spring.rabbitmq.host=rabbitmq" \
-e "eureka.client.serviceUrl.defaultZone=http://service-discovery:8761/eureka/" \
-e "logging.file=/api-logs/catalogs-ws.log" \
--name catalog-service \
ln8847/catalog-service:1.0
```







***
<br>


    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}