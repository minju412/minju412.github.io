---
title:  "[Trouble Shooting] javax.persistence.nonuniqueresultexception: query did not return a unique result: 8 í•´ê²° "

categories:
  - TroubleShooting
tags:
  - [TroubleShooting]

toc: true
toc_sticky: true
 
date: 2023-03-08 22:41:00
last_modified_at: 2023-03-08 22:41:03
---

## ë¬¸ì œ ìƒí™©
ì„œë²„ api ë¥¼ í´ë¦¬ì´ì–¸íŠ¸ì™€ ì—°ë™í•˜ë©° ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.<br>
í˜¼ì í…ŒìŠ¤íŠ¸ í•  ë•Œì—ëŠ” ì˜ ì‹¤í–‰ë˜ë˜ apiê°€ `query did not return a unique result`ë¥¼ ë¿œì—ˆë‹¤.


## ë¬¸ì œ ì›ì¸
> [ì´ ê¸€](https://velog.io/@rladuswl/javax.persistence.nonuniqueresultexception-query-did-not-return-a-unique-result-2)ì„ ì°¸ê³ í–ˆë‹¤.

ë‚´ê°€ ì§„í–‰í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œëŠ” ë™ë¬¼ ë³´í˜¸ê°€ ì¢…ë£Œë˜ë©´, ë‹¤ì‹œë³´ê¸° ì»¨í…ì¸ (`Record`)ë¥¼ ìƒì„±í•œë‹¤.<br>
ì´ë•Œ ë³´í˜¸ ì¢…ë£Œ apië¥¼ ë‘ ë²ˆ ì´ìƒ í˜¸ì¶œí•˜ì§€ ëª»í•˜ë„ë¡ ë§‰ì•˜ì–´ì•¼ í–ˆëŠ”ë°, <br>
í•´ë‹¹ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ì•ˆí•˜ëŠ” ë°”ëŒì— `Record`ê°€ ì—¬ëŸ¬ë²ˆ ìƒì„±ë˜ì—ˆë˜ê²Œ ì—ëŸ¬ì˜ ì›ì¸ì´ì—ˆë‹¤.


## í•´ê²° ë°©ë²•
`record`ë¥¼ ì—¬ëŸ¬ë²ˆ ìƒì„±í•  ìˆ˜ ì—†ë„ë¡ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í–ˆë‹¤.

```java
@Service
@RequiredArgsConstructor
public class ProtectionServiceImpl implements ProtectionService {
    // ë³´í˜¸ ì¢…ë£Œ
    public void saveEndStatus(ProtectionEndReqDto protectionEndReqDto) { 
        ...
        Pet pet = findPet(protectionEndReqDto.getPet(), user);
        if (pet.getProtectionEndedAt() != null) {
            throw new CustomException(PET_PROTECTION_ALREADY_ENDED); // ğŸ‘‰ ì´ë¯¸ ë³´í˜¸ê°€ ì¢…ë£Œëœ ë™ë¬¼ì€ ë‹¤ì‹œë³´ê¸° recordë¥¼ ë˜ ìƒì„±í•  ìˆ˜ ì—†ë„ë¡ ì˜ˆì™¸ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€
        }
        ...

        // ë‹¤ì‹œë³´ê¸° record ìƒì„±
        recordRepository.save(record);
        ...
    }
}
```









***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}