---
title:  "[Trouble Shooting] JAP query did not return a unique result: 2 í•´ê²° "

categories:
  - TroubleShooting
tags:
  - [TroubleShooting]

toc: true
toc_sticky: true
 
date: 2022-09-26 20:00:17
last_modified_at: 2022-09-26 20:00:25
---

## ë¬¸ì œ ìƒí™©
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-09-26 á„‹á…©á„’á…® 6 26 20](https://user-images.githubusercontent.com/59405576/192260527-4e438a71-c29f-44df-b254-22370442b7b6.png)<br>
spring bootì™€ jpaë¥¼ ì‚¬ìš©í•´ `ì¢‹ì•„ìš”í•œ ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ api`ë¥¼ êµ¬í˜„í•˜ë˜ ì¤‘, ìœ„ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤.

## ë¬¸ì œ ì›ì¸
ì´ëŠ” `LikeService`ì—ì„œ `postId`ë¡œë§Œ ê²Œì‹œê¸€ì„ ì¡°íšŒí•´ì„œ ìƒê¸°ëŠ” ë¬¸ì œì˜€ë‹¤.<br>
"ë‚´ê°€" ì¢‹ì•„ìš”í•œ ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜¤ê³  ì‹¶ì—ˆë˜ ê²ƒì´ê¸° ë•Œë¬¸ì—,<br>
`postId`ì™€ `memberId`ê°€ ë‘˜ ë‹¤ ì¼ì¹˜í•˜ëŠ” `like`ë¥¼ ê°€ì ¸ì™”ì–´ì•¼ í•œë‹¤.<br><br>
ê¸°ì¡´ì—ëŠ” `postId`ë§Œ ì¼ì¹˜í•˜ëŠ” `like`ë¥¼ ê°€ì ¸ì™”ì—ˆê¸° ë•Œë¬¸ì— <br>
`like`ê°€ í•œ ê°œê°€ ì•„ë‹Œ ì—¬ëŸ¬ê°œê°€ ì¡°íšŒë˜ì–´ ìœ„ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•œ ê²ƒì´ë‹¤.<br><br>
ì˜ˆë¥¼ ë“¤ì–´ 10ë²ˆ ë©¤ë²„ì™€ 11ë²ˆ ë©¤ë²„ê°€ 5ë²ˆ ê²Œì‹œê¸€ì„ ì¢‹ì•„ìš” í•œ ê²½ìš°ì—,<br>
`like`ëŠ” ì•„ë˜ì²˜ëŸ¼ 2ê°œê°€ ìƒì„±ë  ê²ƒì´ë‹¤.
```
like_id | post_id | member_id
   1    |    5    |    10
   2    |    5    |    11
```
ì´ ë•Œ, `postId`ê°€ 5ì¸ `like`ë¥¼ ì¡°íšŒí•œë‹¤ë©´, ì´ 2ê°œê°€ ì¡°íšŒ ë  ê²ƒì´ê¸° ë•Œë¬¸ì—<br>
`postId`ì™€ `memberId`ê°€ ë‘˜ ë‹¤ ì¼ì¹˜í•˜ëŠ” 1ê°œì˜ `like`ë§Œ ê°€ì ¸ì˜¤ë„ë¡ `LikeRepository`ë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤.

## í•´ê²° ë°©ë²•
ê¸°ì¡´ì˜ LikeRepositoryë¥¼ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•˜ì˜€ë‹¤.<br>
### ê¸°ì¡´
`LikeService`
```java
Like like = likeRepository.findByPostId(postId) // postIdê°€ ì¼ì¹˜í•˜ëŠ” like ë¥¼ ë°˜í™˜
                .orElseThrow(() -> new CustomException(LIKE_ERROR));
```
`LikeRepository`
```java
public interface LikeRepository extends JpaRepository<Like, Long> {
    Optional<Like> findByPostId(long postId);
}
```

### ë³€ê²½
`LikeService`
```java
Like like = likeRepository.findByMemberIdAndPostId(member.getId(), postId) // postIdì™€ memberId ë‘˜ ë‹¤ ì¼ì¹˜í•˜ëŠ” like ë¥¼ ë°˜í™˜
                .orElseThrow(() -> new CustomException(LIKE_ERROR));
```
`LikeRepository`
```java
public interface LikeRepository extends JpaRepository<Like, Long> {
    Optional<Like> findByMemberIdAndPostId(long memberId, long postId);
}
```



# Ref.
- [https://wakestand.tistory.com/943](https://wakestand.tistory.com/943)



***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}