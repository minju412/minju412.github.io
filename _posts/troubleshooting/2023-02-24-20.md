---
title:  "[Trouble Shooting] TransientPropertyValueException: object references an unsaved transient instance 해결 "

categories:
  - TroubleShooting
tags:
  - [TroubleShooting]

toc: true
toc_sticky: true
 
date: 2023-02-24 15:40:29
last_modified_at: 2023-02-24 15:40:32
---

## 문제 상황
엔티티 클래스 작성 후 서버를 실행하고, 포스트맨을 이용해 요청하는 도중에 해당 에러가 발생하였다. 

## 문제 원인
영속성때문에 나는 오류이다. <br>
FK로 쓰는 객체가 아직 저장이 안 되서 오류가 발생한다고 한다.<br>
객체간 `@OneToMany`, `@ManyToOne` 같은 어노테이션을 사용할 때 발생할 수 있다.<br><br>
내 경우에는, 관계 정의가 아래와 같이 되어있었는데<br>
![IMG_0401](https://user-images.githubusercontent.com/59405576/221110696-c25c895b-f751-4181-9f65-92baf3c4cf3d.jpg){: width="700" height="700"}<br>
`Pet` 클래스에서 에러가 발생했다.


## 해결 방법
> [이 글](https://conservative-vector.tistory.com/entry/%EC%98%A4%EB%A5%98)을 참고했다.

join하는쪽에 `cascade = CascadeType.ALL`를 설정해준다.<br>
`Pet` 클래스의 변경 전과 후의 코드를 보면 이해가 쉬울 것이다.<br>

변경 전
```java
@Entity
@Getter
public class Pet {
    ...

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "ownerId")
    private User owner;
}
```

변경 후
```java
@Entity
@Getter
public class Pet {
    ...
    
    @ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @JoinColumn(name = "ownerId")
    private User owner;
}
```









***
<br>

    💛 개인 공부 기록용 블로그입니다. 👻

[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}