---
title:  "[Trouble Shooting] TransientPropertyValueException: object references an unsaved transient instance í•´ê²° "

categories:
  - TroubleShooting
tags:
  - [TroubleShooting]

toc: true
toc_sticky: true
 
date: 2023-02-24 15:40:29
last_modified_at: 2023-02-24 15:40:32
---

## ë¬¸ì œ ìƒí™©
ì—”í‹°í‹° í´ë˜ìŠ¤ ì‘ì„± í›„ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê³ , í¬ìŠ¤íŠ¸ë§¨ì„ ì´ìš©í•´ ìš”ì²­í•˜ëŠ” ë„ì¤‘ì— í•´ë‹¹ ì—ëŸ¬ê°€ ë°œìƒí•˜ì˜€ë‹¤. 

## ë¬¸ì œ ì›ì¸
ì˜ì†ì„±ë•Œë¬¸ì— ë‚˜ëŠ” ì˜¤ë¥˜ì´ë‹¤. <br>
FKë¡œ ì“°ëŠ” ê°ì²´ê°€ ì•„ì§ ì €ì¥ì´ ì•ˆ ë˜ì–´ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ê³  í•œë‹¤.<br>
ê°ì²´ê°„ `@OneToMany`, `@ManyToOne` ê°™ì€ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•  ë•Œ ë°œìƒí•  ìˆ˜ ìˆë‹¤.<br><br>
ë‚´ ê²½ìš°ì—ëŠ”, ê´€ê³„ ì •ì˜ê°€ ì•„ë˜ì™€ ê°™ì´ ë˜ì–´ìˆì—ˆëŠ”ë°<br>
![IMG_0401](https://user-images.githubusercontent.com/59405576/221110696-c25c895b-f751-4181-9f65-92baf3c4cf3d.jpg){: width="700" height="700"}<br>
`Pet` í´ë˜ìŠ¤ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤.<br><br>
ìœ„ ì—”í‹°í‹°ë¥¼ ì¡°ê¸ˆ ê°„ì†Œí™”í•´ì„œ ì„¤ëª…í•˜ìë©´,<br>
`User (id, username, password)` ì´ë¼ëŠ” í…Œì´ë¸”ê³¼ `Pet (id, petName, user_id)` ì´ë¼ëŠ” í…Œì´ë¸” ê´€ê³„ê°€ ìˆì„ ë•Œ, <br>
`User` ë°ì´í„°ë¥¼ ë„£ì§€ ì•Šê³  `Pet` ë°ì´í„°ë¥¼ ë„£ìœ¼ë ¤ê³  í•˜ë©´ `user_id` ê°’ì´ ì—†ì–´ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ëŠ” ê²ƒì´ë‹¤.

```java
User user = new User("test123", "password");
Pet pet = new Pet("Yebbi", user);

petRepository.save(pet);    // ì—ëŸ¬ ë°œìƒ (user ì˜ id ê°’ì„ ëª¨ë¥´ëŠ”ë° í…Œì´ë¸”ì— ë„£ìœ¼ë ¤ê³  í•´ì„œ)
```


## í•´ê²° ë°©ë²•
> [ì´ ê¸€](https://conservative-vector.tistory.com/entry/%EC%98%A4%EB%A5%98)ê³¼ [ì´ ê¸€](https://bcp0109.tistory.com/344)ì„ ì°¸ê³ í–ˆë‹¤.

ì—°ê´€ ê´€ê³„ ë§¤í•‘í•´ì¤„ ë•Œ ì‚¬ìš©í•˜ëŠ” `@ManyToOne`, `@OneToOne`, `@OneToMany` ì–´ë…¸í…Œì´ì…˜ì— cascade ì˜µì…˜ì„ ì„¤ì •í•´ì¤€ë‹¤.<br>
cascade ëŠ” "ì˜ì†ì„± ì „ì´" ë¼ê³  í•˜ëŠ” ê°œë…ì¸ë° íŠ¹ì • ì—”í‹°í‹°ë¥¼ ì˜ì†í™” í•  ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì†í™” í•œë‹¤.<br><br>
ì €ì¥í•  ë•Œë§Œ ì‚¬ìš©í•˜ë ¤ë©´ `cascade = CascadeType.PERSIST` ë¡œ ì„¤ì •í•´ì£¼ë©´ ë˜ë©°, ì „ì²´ ì ìš©ì¸ `CascadeType.ALL` ë¡œ ì„¤ì •í•´ë„ ëœë‹¤.<br>
ê·¸ëŸ¼ Pet ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ì „ì— User ê°’ë¶€í„° ì €ì¥í•œë‹¤.<br><br>
`Pet` í´ë˜ìŠ¤ì˜ ë³€ê²½ ì „ê³¼ í›„ì˜ ì½”ë“œë¥¼ ë³´ë©´ ì´í•´ê°€ ì‰¬ìš¸ ê²ƒì´ë‹¤.<br>

ë³€ê²½ ì „
```java
@Entity
@Getter
public class Pet {
    ...

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "ownerId")
    private User owner;
}
```

ë³€ê²½ í›„
```java
@Entity
@Getter
public class Pet {
    ...
    
    @ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @JoinColumn(name = "ownerId")
    private User owner;
}
```









***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}