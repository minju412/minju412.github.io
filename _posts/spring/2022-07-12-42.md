---
title:  "[SPRING] spring security + swagger ì‚¬ìš©í•˜ê¸° "

categories:
  - Spring
tags:
  - [Framework, Spring, Java]

toc: true
toc_sticky: true
 
date: 2022-07-12 01:24:15
last_modified_at: 2022-07-12 01:24:18
---

# Swaggerë€?
ë¡œì íŠ¸ ë‚´ APIë¥¼ Swagger ì„¤ì •ì„ í†µí•´ ìë™ìœ¼ë¡œ ë¬¸ì„œí™”í•´ì£¼ëŠ” ë„êµ¬ë¡œ<br>
ì‚¬ëŒì´ ì¼ì¼ì´ ì‘ì—…í•  í•„ìš” ì—†ì´ í”„ë¡œì íŠ¸ ì‹¤í–‰ì„ í†µí•´<br>
ì½”ë“œ ë‚´ì—ì„œ ë³€ê²½ì‚¬í•­(return ìœ í˜•ì´ë‚˜ parameter ìˆ˜ ë³€ê²½ ë“±)ì´ ë°œìƒí•˜ì—¬ë„ ë°”ë¡œ ìë™ìœ¼ë¡œ APIë¬¸ì„œë¥¼ ë§Œë“¤ì–´ì£¼ë¯€ë¡œ ë§¤ìš° í¸ë¦¬í•œ ë„êµ¬ì´ë‹¤.<br><br>
ë˜í•œ UIë¥¼ í†µí•´ ì‰½ê²Œ API ëª©ë¡ ì¡°íšŒì™€ API í˜¸ì¶œì„ í†µí•œ í…ŒìŠ¤íŠ¸(`Try it out`)ë¥¼ ì§ì ‘ í•´ë³¼ ìˆ˜ ìˆë‹¤. 

# Swagger ì ìš©í•˜ê¸°
## 1. `build.gradle`
```
dependencies{
  
  // Swagger
  implementation 'io.springfox:springfox-boot-starter:3.0.0'
  implementation 'io.springfox:springfox-swagger-ui:3.0.0'

  // Spring Security + JWT
  implementation 'io.jsonwebtoken:jjwt:0.9.1'
  implementation 'org.springframework.boot:spring-boot-starter-security'
  testImplementation 'org.springframework.security:spring-security-test'
}
```

### ë§Œì•½ ì´ëŸ° ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´?
```
org.springframework.context.ApplicationContextException: Failed to start bean 'documentationPluginsBootstrapper'; nested exception is java.lang.NullPointerException
```
#### 1-1. `application.yml`
`application.yml`ì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•˜ì!
```
spring:
    mvc:
      pathmatch:
            matching-strategy: ant_path_matcher
```

## 2. `SwaggerConfig.java`
```java
package naem.server;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.*;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;

@Configuration
public class SwaggerConfig {

    @Bean
    public Docket api() {
        return new Docket(DocumentationType.OAS_30)
                .useDefaultResponseMessages(true) // Swagger ì—ì„œ ì œê³µí•´ì£¼ëŠ” ê¸°ë³¸ ì‘ë‹µ ì½”ë“œ (200, 401, 403, 404) ë“±ì˜ ë…¸ì¶œ ì—¬ë¶€
                .apiInfo(apiInfo()) // Swagger UI ë¡œ ë…¸ì¶œí•  ì •ë³´
                .select()
                .apis(RequestHandlerSelectors.basePackage("naem.server.web")) // api ìŠ¤í™ì´ ì‘ì„±ë˜ì–´ ìˆëŠ” íŒ¨í‚¤ì§€ (controller)
                .paths(PathSelectors.any()) // apis ì— ìœ„ì¹˜í•˜ëŠ” API ì¤‘ íŠ¹ì • path ë¥¼ ì„ íƒ
                .build();
    }

    public ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("Swagger Test")
                .description("SwaggerConfig")
                .version("0.1")
                .build();
    }

}

```


# ë¬¸ì œ ìƒí™©
ì—¬ê¸°ê¹Œì§€ í•˜ê³  ì„œë²„ë¥¼ ë„ìš´ í›„ [http://localhost:8080/swagger-ui/](http://localhost:8080/swagger-ui/)ë¡œ ì ‘ì†í•´ë³´ë©´,<br>
í™”ë©´ì´ ë³´ì´ì§€ ì•Šê³  please sign in í˜ì´ì§€ê°€ ëœ¬ë‹¤..

## 3. `SpringSecurityConfiguration.java`

```java
package naem.server;

import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@Configuration
public class SpringSecurityConfiguration extends WebSecurityConfigurerAdapter {

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
                .antMatchers(
                        "/v3/api-docs",
                        "/swagger*/**").permitAll()
                .anyRequest().authenticated();
    }
}

```

# ì ìš© í™•ì¸
ì„œë²„ë¥¼ ë„ìš´ í›„ [http://localhost:8080/swagger-ui/](http://localhost:8080/swagger-ui/)ë¡œ ì ‘ì†í•´ë³´ë©´ swagger-ui í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤ğŸ™‚<br>
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-12 á„‹á…©á„Œá…¥á†« 1 48 16](https://user-images.githubusercontent.com/59405576/178316076-941da540-513f-42a7-9ca4-0145e22846d4.png)

# Ref.
- [https://lemontia.tistory.com/1067](https://lemontia.tistory.com/1067) - swagger-ui ì‚¬ìš© ì‹œ spring securityì— ê²½ë¡œ ë“±ë¡
- [https://blog2.deliwind.com/20201127/java-swagger-ui-3-0-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/](https://blog2.deliwind.com/20201127/java-swagger-ui-3-0-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/)


***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}