---
title:  "[SPRING] ê²€ì¦ - ì˜¤ë¥˜ ì½”ë“œì™€ ë©”ì‹œì§€ ì²˜ë¦¬ "

categories:
  - Spring
tags:
  - [Framework, Spring, Java]

toc: true
toc_sticky: true
 
date: 2022-07-04 00:06:33
last_modified_at: 2022-07-04 00:06:36
---

# ì˜¤ë¥˜ ì½”ë“œì™€ ë©”ì‹œì§€ ì²˜ë¦¬ 1
## FieldError ìƒì„±ì
`FieldError` ëŠ” ë‘ ê°€ì§€ ìƒì„±ìë¥¼ ì œê³µí•œë‹¤.
```
public FieldError(String objectName, String field, String defaultMessage);
public FieldError(String objectName, String field, @Nullable Object rejectedValue, boolean bindingFailure, @Nullable String[] codes, @Nullable Object[] arguments, @Nullable String defaultMessage)
```
- íŒŒë¼ë¯¸í„° ëª©ë¡<br>
â€¢ `objectName` : ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê°ì²´ ì´ë¦„<br>
â€¢ `field` : ì˜¤ë¥˜ í•„ë“œ<br>
â€¢ `rejectedValue` : ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’(ê±°ì ˆëœ ê°’)<br>
â€¢ `bindingFailure` : íƒ€ì… ì˜¤ë¥˜ ê°™ì€ ë°”ì¸ë”© ì‹¤íŒ¨ì¸ì§€, ê²€ì¦ ì‹¤íŒ¨ì¸ì§€ êµ¬ë¶„ ê°’ 
â€¢ `codes` : ë©”ì‹œì§€ ì½”ë“œ<br>
â€¢ `arguments` : ë©”ì‹œì§€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì¸ì<br>
â€¢ `defaultMessage` : ê¸°ë³¸ ì˜¤ë¥˜ ë©”ì‹œì§€

`FieldError` , `ObjectError` ì˜ ìƒì„±ìëŠ” `errorCode` , `arguments` ë¥¼ ì œê³µí•œë‹¤. <br>
ì´ê²ƒì€ ì˜¤ë¥˜ ë°œìƒì‹œ ì˜¤ë¥˜ ì½”ë“œë¡œ ë©”ì‹œì§€ë¥¼ ì°¾ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤.

## `errors.properties` ìƒì„± ë° ì„¤ì •

### 1. errors ë©”ì‹œì§€ íŒŒì¼ ìƒì„±
`src/main/resources/errors.properties`ë¥¼ ìƒì„±í•œ ë’¤ì— ì•„ë˜ ë‚´ìš©ì„ ì¶”ê°€í•œë‹¤.<br>
(`messages.properties `ë¥¼ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ, ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ êµ¬ë¶„í•˜ê¸° ì‰½ê²Œ `errors.properties` ë¼ëŠ” ë³„ë„ì˜ íŒŒì¼ë¡œ ê´€ë¦¬í•´ë³´ì.)
```
required.item.itemName=ìƒí’ˆ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.
range.item.price=ê°€ê²©ì€ {0} ~ {1} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.
max.item.quantity=ìˆ˜ëŸ‰ì€ ìµœëŒ€ {0} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.
totalPriceMin=ê°€ê²© * ìˆ˜ëŸ‰ì˜ í•©ì€ {0}ì› ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ ê°’ = {1}
```

> ì°¸ê³ <br>
`errors_en.properties` íŒŒì¼ì„ ìƒì„±í•˜ë©´ ì˜¤ë¥˜ ë©”ì‹œì§€ë„ êµ­ì œí™” ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.

#### í•œê¸€ ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´?
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-04 á„‹á…©á„Œá…¥á†« 12 38 54](https://user-images.githubusercontent.com/59405576/177046871-48980420-218e-4f89-91fc-c493ac73ea8f.png)
1. ì¸í…”ë¦¬ì œì´ì—ì„œ Preferenceì— ë“¤ì–´ê°„ë‹¤.
2. [Editor] -> [File Encodings] ë©”ë‰´ì—ì„œ<br>
Global Encodeing, Project Encoding, Default encoding for properties filesë¥¼ ëª¨ë‘ UTF-8ë¡œ ì„¤ì •í•˜ê³  ì¸í…”ë¦¬ì œì´ë¥¼ ì¬ì‹œì‘í•œë‹¤.
3. ê·¸ í›„ `errors.properties` ë¥¼ ë‹¤ì‹œ ì—´ì–´ë³´ë©´ í•œê¸€ì´ ê¹¨ì§„ìƒíƒœë¡œ ê¸°ë¡ë˜ì–´ìˆëŠ”ë°, <br>
ì´ê²ƒì„ ë‹¤ì‹œ í•œê¸€ë¡œ ì…ë ¥í•´ì„œ ì €ì¥í•œ í›„ í…ŒìŠ¤íŠ¸ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•œë‹¤.

### 2. ìŠ¤í”„ë§ ë¶€íŠ¸ ë©”ì‹œì§€ ì„¤ì • ì¶”ê°€
ë¨¼ì € ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ í•´ë‹¹ ë©”ì‹œì§€ íŒŒì¼ì„ ì¸ì‹í•  ìˆ˜ ìˆê²Œ `src/main/resources/application.properties`ì—ì„œ ë‹¤ìŒ ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.
```
spring.messages.basename=messages,errors
```
ì´ë ‡ê²Œí•˜ë©´ `messages.properties` , `errors.properties` ë‘ íŒŒì¼ì„ ëª¨ë‘ ì¸ì‹í•œë‹¤. <br>
(ìƒëµí•˜ë©´ `messages.properties` ë§Œ ê¸°ë³¸ìœ¼ë¡œ ì¸ì‹í•œë‹¤.)<br>

## ì»¨íŠ¸ë¡¤ëŸ¬ - `ValidationItemControllerV2`
ì´ì œ `errors` ì— ë“±ë¡í•œ ë©”ì‹œì§€ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì½”ë“œë¥¼ ë³€ê²½í•´ë³´ì.<br>
`addItem()`ì„ ìˆ˜ì •í•œë‹¤.
```java
@Slf4j
@Controller
@RequestMapping("/validation/v2/items")
@RequiredArgsConstructor
public class ValidationItemControllerV2 {
...
 @PostMapping("/add")
    public String addItemV3(@ModelAttribute Item item, BindingResult bindingResult, RedirectAttributes redirectAttributes, Model model) {

        // ê²€ì¦ ë¡œì§
        if (!StringUtils.hasText(item.getItemName())){
            bindingResult.addError(new FieldError("item","itemName", item.getItemName(), false, new String[]{"required.item.itemName"}, null, null)); // ğŸŒŸ íŒŒë¼ë¯¸í„° ë³€ê²½
        }
        if (item.getPrice()==null || item.getPrice()<1000 || item.getPrice()>1000000){
            bindingResult.addError(new FieldError("item","price", item.getPrice(), false, new String[]{"range.item.price"}, new Object[]{1000,1000000}, null)); // ğŸŒŸ íŒŒë¼ë¯¸í„° ë³€ê²½
        }
        if (item.getQuantity()==null || item.getQuantity()>=9999){
            bindingResult.addError(new FieldError("item","quantity", item.getQuantity(), false, new String[]{"max.item.quantity"}, new Object[]{9999}, null)); // ğŸŒŸ íŒŒë¼ë¯¸í„° ë³€ê²½
        }

        // íŠ¹ì • í•„ë“œê°€ ì•„ë‹Œ ë³µí•© ë£° ê²€ì¦
        if (item.getPrice()!=null && item.getQuantity()!=null){
            int resultPrice = item.getPrice() * item.getQuantity();
            if (resultPrice<10000){
                bindingResult.addError(new ObjectError("item", new String[]{"totalPriceMin"}, new Object[]{10000,resultPrice}, null)); // ğŸŒŸ íŒŒë¼ë¯¸í„° ë³€ê²½
            }
        }

        // ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´ ë‹¤ì‹œ ì…ë ¥ í¼ìœ¼ë¡œ
        if (bindingResult.hasErrors()){
            log.info("errors={}", bindingResult);
            return "validation/v2/addForm";
        }

        // ì„±ê³µ ë¡œì§
        Item savedItem = itemRepository.save(item);
        redirectAttributes.addAttribute("itemId", savedItem.getId());
        redirectAttributes.addAttribute("status", true);
        return "redirect:/validation/v2/items/{itemId}";
    }
...
}
```

### codesì™€ arguments íŒŒë¼ë¯¸í„°
```java
//range.item.price=ê°€ê²©ì€ {0} ~ {1} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.
// FieldError ìƒì„±ì - objectName,field, rejectedValue, bindingFailure, codes, arguments, defaultMessage
new FieldError("item","price", item.getPrice(), false, new String[]{"range.item.price"}, new Object[]{1000,1000000}, null)
```
- `codes` : `required.item.itemName` ë¥¼ ì‚¬ìš©í•´ì„œ ë©”ì‹œì§€ ì½”ë“œë¥¼ ì§€ì •í•œë‹¤. ë©”ì‹œì§€ ì½”ë“œëŠ” í•˜ë‚˜ê°€ ì•„ë‹ˆë¼ ë°°ì—´ë¡œ ì—¬ëŸ¬ ê°’ì„ ì „ë‹¬í•  ìˆ˜ ìˆëŠ”ë°, ìˆœì„œëŒ€ë¡œ ë§¤ì¹­í•´ì„œ ì²˜ìŒ ë§¤ì¹­ë˜ëŠ” ë©”ì‹œì§€ê°€ ì‚¬ìš©ëœë‹¤.
- `arguments` : `Object[]{1000, 1000000}` ë¥¼ ì‚¬ìš©í•´ì„œ ì½”ë“œì˜ `{0}` , `{1}` ë¡œ ì¹˜í™˜í•  ê°’ì„ ì „ë‹¬í•œë‹¤.
- `defaultMessage` : `codes`ì—ì„œ ì§€ì •í•œ ë©”ì‹œì§€ ì½”ë“œ ì¤‘ì— ë§¤ì¹­ë˜ëŠ”ê²Œ ì—†ì„ ë•Œ ì‚¬ìš©ëœë‹¤. `null`ë¡œ ì„¤ì •í•˜ë©´, ë§¤ì¹­ë˜ëŠ”ê²Œ ì—†ì„ ë•Œ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.

# ì˜¤ë¥˜ ì½”ë“œì™€ ë©”ì‹œì§€ ì²˜ë¦¬ 2
- `FieldError` , `ObjectError` ëŠ” ë‹¤ë£¨ê¸° ë„ˆë¬´ ë²ˆê±°ë¡­ë‹¤.
- ì˜¤ë¥˜ ì½”ë“œë„ ì¢€ ë” ìë™í™” í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ? ì˜ˆ) `item.itemName` ì²˜ëŸ¼?

ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ `BindingResult` ëŠ” ê²€ì¦í•´ì•¼ í•  ê°ì²´ì¸ `target` ë°”ë¡œ ë‹¤ìŒì— ì˜¨ë‹¤. <br>
ë”°ë¼ì„œ `BindingResult` ëŠ” ì´ë¯¸ ë³¸ì¸ì´ ê²€ì¦í•´ì•¼ í•  ê°ì²´ì¸ `target` ì„ ì•Œê³  ìˆë‹¤.

## ì»¨íŠ¸ë¡¤ëŸ¬ - `ValidationItemControllerV2`
`BindingResult` ê°€ ì œê³µí•˜ëŠ” `rejectValue()` , `reject()` ë¥¼ ì‚¬ìš©í•˜ë©´ `FieldError` , `ObjectError` ë¥¼ ì§ì ‘ ìƒì„±í•˜ì§€ ì•Šê³ , ê¹”ë”í•˜ê²Œ ê²€ì¦ ì˜¤ë¥˜ë¥¼ ë‹¤ë£° ìˆ˜ ìˆë‹¤.<br>
`addItem()`ì„ ìˆ˜ì •í•œë‹¤.
```java
@Slf4j
@Controller
@RequestMapping("/validation/v2/items")
@RequiredArgsConstructor
public class ValidationItemControllerV2 {
...
    @PostMapping("/add")
    public String addItemV4(@ModelAttribute Item item, BindingResult bindingResult, RedirectAttributes redirectAttributes, Model model) {

        // ê²€ì¦ ë¡œì§
        if (!StringUtils.hasText(item.getItemName())){
            bindingResult.rejectValue("itemName", "required"); // ğŸŒŸ ë©”ì„œë“œ ë³€ê²½
        }
        if (item.getPrice()==null || item.getPrice()<1000 || item.getPrice()>1000000){
            bindingResult.rejectValue("price", "range", new Object[]{1000, 10000000}, null); // ğŸŒŸ ë©”ì„œë“œ ë³€ê²½
        }
        if (item.getQuantity()==null || item.getQuantity()>=9999){
            bindingResult.rejectValue("quantity", "max", new Object[]{9999}, null); // ğŸŒŸ ë©”ì„œë“œ ë³€ê²½
        }

        // íŠ¹ì • í•„ë“œê°€ ì•„ë‹Œ ë³µí•© ë£° ê²€ì¦
        if (item.getPrice()!=null && item.getQuantity()!=null){
            int resultPrice = item.getPrice() * item.getQuantity();
            if (resultPrice<10000){
                bindingResult.reject("totalPriceMin", new Object[]{10000, resultPrice}, null); // ğŸŒŸ ë©”ì„œë“œ ë³€ê²½
            }
        }

        // ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´ ë‹¤ì‹œ ì…ë ¥ í¼ìœ¼ë¡œ
        if (bindingResult.hasErrors()){
            log.info("errors={}", bindingResult);
            return "validation/v2/addForm";
        }

        // ì„±ê³µ ë¡œì§
        Item savedItem = itemRepository.save(item);
        redirectAttributes.addAttribute("itemId", savedItem.getId());
        redirectAttributes.addAttribute("status", true);
        return "redirect:/validation/v2/items/{itemId}";
    }
...
}
```

### `rejectValue()`
```java
 void rejectValue(@Nullable String field, String errorCode, @Nullable Object[] errorArgs, @Nullable String defaultMessage);
```
- `field` : ì˜¤ë¥˜ í•„ë“œëª…
- `errorCode` : ì˜¤ë¥˜ ì½”ë“œ(ì´ ì˜¤ë¥˜ ì½”ë“œëŠ” ë©”ì‹œì§€ì— ë“±ë¡ëœ ì½”ë“œê°€ ì•„ë‹ˆë‹¤. ë’¤ì—ì„œ ì„¤ëª…í•  `messageResolverë¥¼` ìœ„í•œ ì˜¤ë¥˜ ì½”ë“œì´ë‹¤.)
- `errorArgs` : ì˜¤ë¥˜ ë©”ì‹œì§€ì—ì„œ `{0}` ì„ ì¹˜í™˜í•˜ê¸° ìœ„í•œ ê°’ 
- `defaultMessage` : ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ë©”ì‹œì§€

```java
 void rejectValue("price", "range", new Object[]{1000, 1000000}, null);
```
ì•ì—ì„œ `BindingResult` ëŠ” ì–´ë–¤ ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ê²€ì¦í•˜ëŠ”ì§€ `targetì„` ì´ë¯¸ ì•Œê³  ìˆë‹¤ê³  í–ˆë‹¤. <br>
ë”°ë¼ì„œ `target(item)`ì— ëŒ€í•œ ì •ë³´ëŠ” ì—†ì–´ë„ ëœë‹¤. ì˜¤ë¥˜ í•„ë“œëª…ì€ ë™ì¼í•˜ê²Œ `price` ë¥¼ ì‚¬ìš©í–ˆë‹¤.<br><br>
`FieldError()` ë¥¼ ì§ì ‘ ë‹¤ë£° ë•ŒëŠ” ì˜¤ë¥˜ ì½”ë“œë¥¼ `range.item.price` ì™€ ê°™ì´ ëª¨ë‘ ì…ë ¥í–ˆë‹¤. ê·¸ëŸ°ë° `rejectValue()` ë¥¼ ì‚¬ìš©í•˜ê³  ë¶€í„°ëŠ” ì˜¤ë¥˜ ì½”ë“œë¥¼ `range` ë¡œ ê°„ë‹¨í•˜ê²Œ ì…ë ¥í–ˆë‹¤. <br>
ê·¸ë˜ë„ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì˜ ì°¾ì•„ì„œ ì¶œë ¥í•œë‹¤. ë¬´ì–¸ê°€ ê·œì¹™ì´ ìˆëŠ” ê²ƒ ì²˜ëŸ¼ ë³´ì¸ë‹¤. <br>
ì´ ë¶€ë¶„ì„ ì´í•´í•˜ë ¤ë©´ `MessageCodesResolver` ë¥¼ ì´í•´í•´ì•¼ í•œë‹¤. ì™œ ì´ëŸ°ì‹ìœ¼ë¡œ ì˜¤ë¥˜ ì½”ë“œë¥¼ êµ¬ì„±í•˜ëŠ”ì§€ ë°”ë¡œ ë‹¤ìŒì— ìì„¸íˆ ì•Œì•„ë³´ì.

### `reject()`
```java
 void reject(String errorCode, @Nullable Object[] errorArgs, @Nullable String defaultMessage);
```
`rejectValue()`ëŠ” `FieldError()` ëŒ€ì‹ ì— ì‚¬ìš©í•˜ë©°, `reject()`ëŠ” `ObjectError()` ëŒ€ì‹ ì— ì‚¬ìš©í•œë‹¤.









***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}