---
title:  "[SPRING] FrontController íŒ¨í„´ "

categories:
  - Spring
tags:
  - [Framework, Spring, Java]

toc: true
toc_sticky: true
 
date: 2022-06-16 12:06:37
last_modified_at: 2022-06-16 12:06:41
---
# ê°œìš”
## FrontController ë„ì… ì „
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 12 29 30](https://user-images.githubusercontent.com/59405576/174219180-af4395c1-5346-415f-aeec-4fee10991059.png)
## FrontControllerëŸ¬ ë„ì… í›„
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 12 29 40](https://user-images.githubusercontent.com/59405576/174219189-f0139f38-52fd-4609-8198-df46bab0bad3.png)

## FrontController íŒ¨í„´ íŠ¹ì§•
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì„œë¸”ë¦¿ í•˜ë‚˜ë¡œ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ìŒ
- í”„ë¡ í„° ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìš”ì²­ì— ë§ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ì•„ì„œ í˜¸ì¶œ
- ì…êµ¬ë¥¼ í•˜ë‚˜ë¡œ!
- ê³µí†µ ì²˜ë¦¬ ê°€ëŠ¥
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì„œë¸”ë¦¿ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë¨

## ìŠ¤í”„ë§ ì›¹ MVCì™€ FrontController
- ìŠ¤í”„ë§ ì›¹ MVCì˜ í•µì‹¬ë„ ë°”ë¡œ FrontController
- ìŠ¤í”„ë§ ì›¹ MVCì˜ DispatcherServletì´ FrontController íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆìŒ

# FrontController êµ¬í˜„
## ğŸ’ v1
ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ -> ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´ -> í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ìˆœìœ¼ë¡œ ê°œë°œí•œë‹¤.
### v1 êµ¬ì¡°
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 1 52 29](https://user-images.githubusercontent.com/59405576/174227489-6a6b756c-dd99-4e83-819e-c7dd0bbf68cd.png)
1. í´ë¼ì´ì–¸íŠ¸ì˜ http ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´. FrontControllerëŠ” URL ë§¤í•‘ ì •ë³´ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì¡°íšŒí•œ ë’¤ì— í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤.
2. ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì§ì ‘ JSP forwardë¥¼ ì§„í–‰í•œë‹¤.
3. JSPê°€ html ì‘ë‹µì„ ì „ì†¡í•œë‹¤.


### 1. ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤
```java
public interface ControllerV1 {
    void process(HttpServletRequest request, HttpServletResponse response)
throws ServletException, IOException;
}
```
ì„œë¸”ë¦¿ê³¼ ë¹„ìŠ·í•œ ëª¨ì–‘ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë„ì…í•œë‹¤. ê° ì»¨íŠ¸ë¡¤ëŸ¬ë“¤ì€ ì´ ì¸í„°í˜ì—ìŠ¤ë¥¼ êµ¬í˜„í•˜ë©´ ëœë‹¤. <br>
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì´ ì¸í„°í˜ì´ìŠ¤ë¥¼ í˜¸ì¶œí•´ì„œ êµ¬í˜„ê³¼ ê´€ê³„ì—†ì´ ë¡œì§ì˜ ì¼ê´€ì„±ì„ ê°€ì ¸ê°ˆ ìˆ˜ ìˆë‹¤.<br>
ì´ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“  ë’¤ì—, í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“ ë‹¤.

### 2. ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´
`MemberSaveControllerV1.java`
```java
public class MemberSaveControllerV1 implements ControllerV1 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public void process(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        String username = req.getParameter("username");
        int age = Integer.parseInt(req.getParameter("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);

        // Modelì— ë°ì´í„°ë¥¼ ë³´ê´€í•œë‹¤.
        req.setAttribute("member", member);

        // ì»¨íŠ¸ë¡¤ëŸ¬ -> ë·° í˜¸ì¶œ
        String viewPath = "/WEB-INF/views/save-result.jsp";
        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, res);
    }
}
```
`MemberSaveController`ëŠ” íšŒì›ì„ ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. ì´ ì´ì—ë„ `MemberFormController`ì™€ `MemberListController`ê°€ ì¡´ì¬í•œë‹¤.

### 3. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬
```java
@WebServlet(name = "frontControllerServletV1", urlPatterns = "/front-controller/v1/*") // /front-controller/v1 ì„ í¬í•¨í•œ ëª¨ë“  í•˜ìœ„ ìš”ì²­ì€ ì´ ì„œë¸”ë¦¿ì—ì„œ ë°›ì•„ë“¤ì¸ë‹¤.
public class FrontControllerServletV1 extends HttpServlet {

    // ë§¤í•‘ ì •ë³´ ì €ì¥ // (key, value): (ë§¤í•‘ URL, í˜¸ì¶œë  ì»¨íŠ¸ë¡¤ëŸ¬)
    private Map<String, ControllerV1> controllerMap = new HashMap<>();

    public FrontControllerServletV1() {
        controllerMap.put("/front-controller/v1/members/new-form", new MemberFormControllerV1());
        controllerMap.put("/front-controller/v1/members/save", new MemberSaveControllerV1());
        controllerMap.put("/front-controller/v1/members", new MemberListControllerV1());
    }

    // service(): requestURLë¥¼ ë°›ì€ ë’¤, ì‹¤ì œ í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ controllerMapì—ì„œ ì°¾ì•„ í˜¸ì¶œí•œë‹¤.
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {
        System.out.println("FrontControllerServletV1.service");

        String requestURI = req.getRequestURI();
        ControllerV1 controller = controllerMap.get(requestURI); // ë¶€ëª¨ëŠ” ìì‹ì„ ë°›ì„ ìˆ˜ ìˆë‹¤. (ë‹¤í˜•ì„±)

        if (controller == null) {
            res.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        controller.process(req, res); // í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì‹¤í–‰í•œë‹¤.
    }
}

```
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” URIì— ë”°ë¥¸ ì»¨íŠ¸ë¡¤ëŸ¬ ë§¤í•‘ ì •ë³´ë¥¼ ì €ì¥í•œë‹¤.<br>
`service()`ì—ì„œ í•´ë‹¹í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤.

## ğŸ’ v2
v1ì—ëŠ” ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë·°ë¡œ ì´ë™í•˜ëŠ” ë¶€ë¶„ì— ì¤‘ë³µì´ ìˆê³  ê¹”ë”í•˜ì§€ ì•Šë‹¤.
```java
 String viewPath = "/WEB-INF/views/members.jsp";
        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, res);
```
ì´ ë¶€ë¶„ì„ ê¹”ë”í•˜ê²Œ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ ë³„ë„ë¡œ ë·°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê°ì²´ë¥¼ ë§Œë“¤ì.

### v2 êµ¬ì¡°
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 1 51 32](https://user-images.githubusercontent.com/59405576/174227373-8e0e7fb2-64bf-42ea-bb6a-c502a6359cf3.png)
1. í´ë¼ì´ì–¸íŠ¸ì˜ http ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ FrontControllerê°€ ë§¤í•‘ì •ë³´ë¥¼ ì°¾ì•„ì„œ í•´ë‹¹í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤.
2. ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì§ì ‘ JSP forwardë¥¼ í•˜ì§€ ì•Šê³ , ë·° ì—­í• ì„ í•˜ëŠ” MyView ë¼ëŠ” ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
3. FrontControllerê°€ MyViewì— ìˆëŠ” render()ë¥¼ í˜¸ì¶œí•œë‹¤.
4. MyViewê°€ JSP fowardë¥¼ ì§„í–‰í•œë‹¤.
5. JSPê°€ html ì‘ë‹µì„ ì „ì†¡í•œë‹¤.

### 1. MyView
```java
public class MyView {

    private String viewPath;

    public MyView(String viewPath) {
        this.viewPath = viewPath;
    }

    public void render(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, res);
    }
}
```
ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë·°ë¡œ ì´ë™í•˜ëŠ” ì½”ë“œë¥¼ MyViewì— ë”°ë¡œ ëº€ë‹¤.

### 2. ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤
```java
public interface ControllerV2 {

    MyView process(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException; // ğŸŒŸ ë¦¬í„´íƒ€ì…ì´ MyViewì´ë‹¤.
}
```
ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ëŠ” v1ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ë¦¬í„´íƒ€ì…ì´ voidê°€ ì•„ë‹Œ MyViewì´ë‹¤.

### 3. ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´
`MemberSaveControllerV2.java`
```java
public class MemberSaveControllerV2 implements ControllerV2 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public MyView process(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        String username = req.getParameter("username");
        int age = Integer.parseInt(req.getParameter("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);
        req.setAttribute("member", member); // Modelì— ë°ì´í„°ë¥¼ ë³´ê´€í•œë‹¤.

        return new MyView("/WEB-INF/views/save-result.jsp"); // ğŸŒŸ MyView ê°ì²´ì— viewPathë¥¼ ë‹´ì•„ì„œ ë°˜í™˜í•œë‹¤.
    }
}
```

### 4. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬
```java
@WebServlet(name = "frontControllerServletV2", urlPatterns = "/front-controller/v2/*") // /front-controller/v2 ì„ í¬í•¨í•œ ëª¨ë“  í•˜ìœ„ ìš”ì²­ì€ ì´ ì„œë¸”ë¦¿ì—ì„œ ë°›ì•„ë“¤ì¸ë‹¤.
public class FrontControllerServletV2 extends HttpServlet {

    // ë§¤í•‘ ì •ë³´ ì €ì¥ // (key, value): (ë§¤í•‘ URL, í˜¸ì¶œë  ì»¨íŠ¸ë¡¤ëŸ¬)
    private Map<String, ControllerV2> controllerMap = new HashMap<>();

    public FrontControllerServletV2() {
        controllerMap.put("/front-controller/v2/members/new-form", new MemberFormControllerV2());
        controllerMap.put("/front-controller/v2/members/save", new MemberSaveControllerV2());
        controllerMap.put("/front-controller/v2/members", new MemberListControllerV2());
    }

    // service(): requestURLë¥¼ ë°›ì€ ë’¤, ì‹¤ì œ í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ controllerMapì—ì„œ ì°¾ì•„ í˜¸ì¶œí•œë‹¤.
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        String requestURI = req.getRequestURI();
        ControllerV2 controller = controllerMap.get(requestURI); // ë¶€ëª¨ëŠ” ìì‹ì„ ë°›ì„ ìˆ˜ ìˆë‹¤. (ë‹¤í˜•ì„±)

        if (controller == null) {
            res.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        MyView view = controller.process(req, res);// ğŸŒŸ MyView ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
        view.render(req, res); // ğŸŒŸ MyViewì— ìˆëŠ” render()ë¥¼ í˜¸ì¶œí•˜ë©´ foward ë¡œì§ì„ ìˆ˜í–‰í•´ì„œ JSPê°€ ì‹¤í–‰ëœë‹¤.

    }
}
```
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë„ì…ìœ¼ë¡œ `MyView` ê°ì²´ì˜ `render()`ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì„ ëª¨ë‘ ì¼ê´€ë˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. <br>
ê°ê°ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” `MyView` ê°ì²´ë¥¼ ìƒì„±ë§Œ í•´ì„œ ë°˜í™˜í•˜ë©´ ëœë‹¤.


***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}