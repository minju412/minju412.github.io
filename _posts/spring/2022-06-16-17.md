---
title:  "[SPRING] FrontController íŒ¨í„´ (v1~v5) "

categories:
  - Spring
tags:
  - [Framework, Spring, Java]

toc: true
toc_sticky: true
 
date: 2022-06-16 12:06:37
last_modified_at: 2022-06-16 12:06:41
---
# ê°œìš”
## FrontController ë„ì… ì „
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 12 29 30](https://user-images.githubusercontent.com/59405576/174219180-af4395c1-5346-415f-aeec-4fee10991059.png)
## FrontController ë„ì… í›„
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 12 29 40](https://user-images.githubusercontent.com/59405576/174219189-f0139f38-52fd-4609-8198-df46bab0bad3.png)

## FrontController íŒ¨í„´ íŠ¹ì§•
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì„œë¸”ë¦¿ í•˜ë‚˜ë¡œ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ìŒ
- í”„ë¡ í„° ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìš”ì²­ì— ë§ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ì•„ì„œ í˜¸ì¶œ
- ì…êµ¬ë¥¼ í•˜ë‚˜ë¡œ!
- ê³µí†µ ì²˜ë¦¬ ê°€ëŠ¥
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì„œë¸”ë¦¿ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë¨

## ìŠ¤í”„ë§ ì›¹ MVCì™€ FrontController
- ìŠ¤í”„ë§ ì›¹ MVCì˜ í•µì‹¬ë„ ë°”ë¡œ FrontController
- ìŠ¤í”„ë§ ì›¹ MVCì˜ DispatcherServletì´ FrontController íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆìŒ

# ğŸ’ v1 - í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ë„ì…
ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ -> ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´ -> í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ìˆœìœ¼ë¡œ ê°œë°œí•œë‹¤.
## v1 êµ¬ì¡°
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 1 52 29](https://user-images.githubusercontent.com/59405576/174227489-6a6b756c-dd99-4e83-819e-c7dd0bbf68cd.png)
1. í´ë¼ì´ì–¸íŠ¸ì˜ http ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´. FrontControllerëŠ” URL ë§¤í•‘ ì •ë³´ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì¡°íšŒí•œ ë’¤ì— í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤.
2. ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì§ì ‘ JSP forwardë¥¼ ì§„í–‰í•œë‹¤.
3. JSPê°€ html ì‘ë‹µì„ ì „ì†¡í•œë‹¤.

## v1 êµ¬í˜„
### 1. ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤
```java
public interface ControllerV1 {
    void process(HttpServletRequest request, HttpServletResponse response)
throws ServletException, IOException;
}
```
ì„œë¸”ë¦¿ê³¼ ë¹„ìŠ·í•œ ëª¨ì–‘ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë„ì…í•œë‹¤. ê° ì»¨íŠ¸ë¡¤ëŸ¬ë“¤ì€ ì´ ì¸í„°í˜ì—ìŠ¤ë¥¼ êµ¬í˜„í•˜ë©´ ëœë‹¤. <br>
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì´ ì¸í„°í˜ì´ìŠ¤ë¥¼ í˜¸ì¶œí•´ì„œ êµ¬í˜„ê³¼ ê´€ê³„ì—†ì´ ë¡œì§ì˜ ì¼ê´€ì„±ì„ ê°€ì ¸ê°ˆ ìˆ˜ ìˆë‹¤.<br>
ì´ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“  ë’¤ì—, í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“ ë‹¤.

### 2. ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´
`MemberSaveControllerV1.java`
```java
public class MemberSaveControllerV1 implements ControllerV1 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public void process(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        String username = req.getParameter("username");
        int age = Integer.parseInt(req.getParameter("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);

        // Modelì— ë°ì´í„°ë¥¼ ë³´ê´€í•œë‹¤.
        req.setAttribute("member", member);

        // ì»¨íŠ¸ë¡¤ëŸ¬ -> ë·° í˜¸ì¶œ
        String viewPath = "/WEB-INF/views/save-result.jsp";
        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, res);
    }
}
```
`MemberSaveController`ëŠ” íšŒì›ì„ ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. ì´ ì´ì—ë„ `MemberFormController`ì™€ `MemberListController`ê°€ ì¡´ì¬í•œë‹¤.

### 3. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬
```java
@WebServlet(name = "frontControllerServletV1", urlPatterns = "/front-controller/v1/*") // /front-controller/v1 ì„ í¬í•¨í•œ ëª¨ë“  í•˜ìœ„ ìš”ì²­ì€ ì´ ì„œë¸”ë¦¿ì—ì„œ ë°›ì•„ë“¤ì¸ë‹¤.
public class FrontControllerServletV1 extends HttpServlet {

    // ë§¤í•‘ ì •ë³´ ì €ì¥ // (key, value): (ë§¤í•‘ URL, í˜¸ì¶œë  ì»¨íŠ¸ë¡¤ëŸ¬)
    private Map<String, ControllerV1> controllerMap = new HashMap<>();

    public FrontControllerServletV1() {
        controllerMap.put("/front-controller/v1/members/new-form", new MemberFormControllerV1());
        controllerMap.put("/front-controller/v1/members/save", new MemberSaveControllerV1());
        controllerMap.put("/front-controller/v1/members", new MemberListControllerV1());
    }

    // service(): requestURLë¥¼ ë°›ì€ ë’¤, ì‹¤ì œ í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ controllerMapì—ì„œ ì°¾ì•„ í˜¸ì¶œí•œë‹¤.
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {
        System.out.println("FrontControllerServletV1.service");

        String requestURI = req.getRequestURI();
        ControllerV1 controller = controllerMap.get(requestURI); // ë¶€ëª¨ëŠ” ìì‹ì„ ë°›ì„ ìˆ˜ ìˆë‹¤. (ë‹¤í˜•ì„±)

        if (controller == null) {
            res.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        controller.process(req, res); // í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì‹¤í–‰í•œë‹¤.
    }
}

```
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” URIì— ë”°ë¥¸ ì»¨íŠ¸ë¡¤ëŸ¬ ë§¤í•‘ ì •ë³´ë¥¼ ì €ì¥í•œë‹¤.<br>
`service()`ì—ì„œ í•´ë‹¹í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤.

# ğŸ’ v2 - View ë¶„ë¦¬
v1ì—ëŠ” ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë·°ë¡œ ì´ë™í•˜ëŠ” ë¶€ë¶„ì— ì¤‘ë³µì´ ìˆê³  ê¹”ë”í•˜ì§€ ì•Šë‹¤.
```java
 String viewPath = "/WEB-INF/views/members.jsp";
        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, res);
```
ì´ ë¶€ë¶„ì„ ê¹”ë”í•˜ê²Œ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ ë³„ë„ë¡œ ë·°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê°ì²´ë¥¼ ë§Œë“¤ì.

## v2 êµ¬ì¡°
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 1 51 32](https://user-images.githubusercontent.com/59405576/174227373-8e0e7fb2-64bf-42ea-bb6a-c502a6359cf3.png)
1. í´ë¼ì´ì–¸íŠ¸ì˜ http ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ FrontControllerê°€ ë§¤í•‘ì •ë³´ë¥¼ ì°¾ì•„ì„œ í•´ë‹¹í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤.
2. ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì§ì ‘ JSP forwardë¥¼ í•˜ì§€ ì•Šê³ , ë·° ì—­í• ì„ í•˜ëŠ” MyView ë¼ëŠ” ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
3. FrontControllerê°€ MyViewì— ìˆëŠ” `render()`ë¥¼ í˜¸ì¶œí•œë‹¤.
4. MyViewê°€ JSP fowardë¥¼ ì§„í–‰í•œë‹¤.
5. JSPê°€ html ì‘ë‹µì„ ì „ì†¡í•œë‹¤.

## v2 êµ¬í˜„
### 1. MyView
```java
public class MyView {

    private String viewPath;

    public MyView(String viewPath) {
        this.viewPath = viewPath;
    }

    public void render(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, res);
    }
}
```
ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë·°ë¡œ ì´ë™í•˜ëŠ” ì½”ë“œë¥¼ MyViewì— ë”°ë¡œ ëº€ë‹¤.

### 2. ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤
```java
public interface ControllerV2 {

    MyView process(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException; // ğŸŒŸ ë¦¬í„´íƒ€ì…ì´ MyViewì´ë‹¤.
}
```
ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ëŠ” v1ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ë¦¬í„´íƒ€ì…ì´ voidê°€ ì•„ë‹Œ MyViewì´ë‹¤.

### 3. ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´
`MemberSaveControllerV2.java`
```java
public class MemberSaveControllerV2 implements ControllerV2 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public MyView process(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        String username = req.getParameter("username");
        int age = Integer.parseInt(req.getParameter("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);
        req.setAttribute("member", member); // Modelì— ë°ì´í„°ë¥¼ ë³´ê´€í•œë‹¤.

        return new MyView("/WEB-INF/views/save-result.jsp"); // ğŸŒŸ MyView ê°ì²´ì— viewPathë¥¼ ë‹´ì•„ì„œ ë°˜í™˜í•œë‹¤.
    }
}
```

### 4. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬
```java
@WebServlet(name = "frontControllerServletV2", urlPatterns = "/front-controller/v2/*") // /front-controller/v2 ì„ í¬í•¨í•œ ëª¨ë“  í•˜ìœ„ ìš”ì²­ì€ ì´ ì„œë¸”ë¦¿ì—ì„œ ë°›ì•„ë“¤ì¸ë‹¤.
public class FrontControllerServletV2 extends HttpServlet {

    // ë§¤í•‘ ì •ë³´ ì €ì¥ // (key, value): (ë§¤í•‘ URL, í˜¸ì¶œë  ì»¨íŠ¸ë¡¤ëŸ¬)
    private Map<String, ControllerV2> controllerMap = new HashMap<>();

    public FrontControllerServletV2() {
        controllerMap.put("/front-controller/v2/members/new-form", new MemberFormControllerV2());
        controllerMap.put("/front-controller/v2/members/save", new MemberSaveControllerV2());
        controllerMap.put("/front-controller/v2/members", new MemberListControllerV2());
    }

    // service(): requestURLë¥¼ ë°›ì€ ë’¤, ì‹¤ì œ í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ controllerMapì—ì„œ ì°¾ì•„ í˜¸ì¶œí•œë‹¤.
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        String requestURI = req.getRequestURI();
        ControllerV2 controller = controllerMap.get(requestURI); // ë¶€ëª¨ëŠ” ìì‹ì„ ë°›ì„ ìˆ˜ ìˆë‹¤. (ë‹¤í˜•ì„±)

        if (controller == null) {
            res.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        MyView view = controller.process(req, res);// ğŸŒŸ MyView ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
        view.render(req, res); // ğŸŒŸ MyViewì— ìˆëŠ” render()ë¥¼ í˜¸ì¶œí•˜ë©´ foward ë¡œì§ì„ ìˆ˜í–‰í•´ì„œ JSPê°€ ì‹¤í–‰ëœë‹¤.

    }
}
```
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë„ì…ìœ¼ë¡œ `MyView` ê°ì²´ì˜ `render()`ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì„ ëª¨ë‘ ì¼ê´€ë˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. <br>
ê°ê°ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” `MyView` ê°ì²´ë¥¼ ìƒì„±ë§Œ í•´ì„œ ë°˜í™˜í•˜ë©´ ëœë‹¤.

# ğŸ’ v3 - Model ì¶”ê°€ ğŸŒŸ
## ì„œë¸”ë¦¿ ì¢…ì†ì„± ì œê±°
ì»¨íŠ¸ë¡¤ëŸ¬ ì…ì¥ì—ì„œ HttpServletRequestì™€ HttpServletResponseê°€ ê¼­ í•„ìš”í• ê¹Œ?<br>
ìš”ì²­ íŒŒë¼ë¯¸í„° ì •ë³´ëŠ” ìë°”ì˜ Mapìœ¼ë¡œ ëŒ€ì‹  ë„˜ê¸°ë„ë¡ í•˜ë©´ ì§€ê¸ˆ êµ¬ì¡°ì—ì„œëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì„œë¸”ë¦¿ ê¸°ìˆ ì„ ëª°ë¼ë„ ë™ì‘í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  request ê°ì²´ë¥¼ Modelë¡œ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹ ì— ë³„ë„ì˜ Model ê°ì²´ë¥¼ ë§ˆë“¤ì–´ì„œ ë°˜í™˜í•˜ë©´ ëœë‹¤.<br>
ìš°ë¦¬ê°€ êµ¬í˜„í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì„œë¸”ë¦¿ ê¸°ìˆ ì„ ì „í˜€ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ ë³€ê²½í•´ë³´ì. ì´ë ‡ê²Œ í•˜ë©´ êµ¬í˜„ ì½”ë“œë„ ë§¤ìš° ë‹¨ìˆœí•´ì§€ê³ , í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì´ ì‰½ë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.

## ë·° ì´ë¦„ ì¤‘ë³µ ì œê±°
ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì§€ì •í•˜ëŠ” ë·° ì´ë¦„ì— ì¤‘ë³µì´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ì‡ë‹¤.<br>
ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” 'ë·°ì˜ ë…¼ë¦¬ ì´ë¦„'ì„ ë°˜í™˜í•˜ê³ . ì‹¤ì œ ë¬¼ë¦¬ ìœ„ì¹˜ì˜ ì´ë¦„ì€ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ ë‹¨ìˆœí™” í•˜ì.<br>
ğŸ’¡ ì´ë ‡ê²Œ í•´ë‘ë©´ í–¥í›„ ë·°ì˜ í´ë” ìœ„ì¹˜ê°€ ì´ë™í•˜ë”ë¼ë„, ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´ë¥¼ ì¼ì¼ì´ ë³€ê²½í•  í•„ìš” ì—†ì´, í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë§Œ ë³€ê²½í•˜ë©´ ëœë‹¤.
- `/SEB-INF/views/new-form.jsp` -> new-form
- `/SEB-INF/views/save-result.jsp` -> save-result
- `/SEB-INF/views/members.jsp` -> members

## v3 êµ¬ì¡°
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 3 17 07](https://user-images.githubusercontent.com/59405576/174237073-eb77e7d6-c912-4318-aa19-de7ba3ab8655.png)
1. í´ë¼ì´ì–¸íŠ¸ì˜ http ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ FrontControllerê°€ ë§¤í•‘ì •ë³´ë¥¼ ì°¾ì•„ì„œ í•´ë‹¹í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤.
2. ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ëª¨ë¸ê³¼ ë·°ê°€ ê°™ì´ ì„ì—¬ ìˆëŠ” ModelViewë¼ëŠ” ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
3. FrontControllerê°€ viewResolverë¥¼ í˜¸ì¶œí•˜ë©´, viewResolverì—ì„œ ë…¼ë¦¬ ì´ë¦„ì„ ë¬¼ë¦¬ ìœ„ì¹˜ë¡œ ë³€í™˜í•´ì„œ MyView ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
4. FrontControllerê°€ MyView ì•ˆì— ìˆëŠ” `render(model)`ë¥¼ í˜¸ì¶œí•œë‹¤.

## v3 êµ¬í˜„
### 1. ModelView
ì§€ê¸ˆê¹Œì§€ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì„œë¸”ë¦¿ì— ì¢…ì†ì ì¸ HttpServletRequestë¥¼ ì‚¬ìš©í–ˆë‹¤. ê·¸ë¦¬ê³  Modelë„ `req.setAttribute()`ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ë·°ì— ì „ë‹¬í–ˆë‹¤.<br>
ì„œë¸”ë¦¿ì˜ ì¢…ì†ì„±ì„ ì œê±°í•˜ê¸° ìœ„í•´ Modelì„ ì§ì ‘ ë§Œë“¤ê³ , ì¶”ê°€ë¡œ View ì´ë¦„ê¹Œì§€ ì „ë‹¬í•˜ëŠ” ê°ì²´ë¥¼ ë§Œë“¤ì–´ë³´ì.<br>
(ì´ì „ ë²„ì „ì—ì„œëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ HttpServletRequestë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤, ë”°ë¼ì„œ ì§ì ‘ `req.setAttribute()`ë¥¼ í˜¸ì¶œí•  ìˆ˜ë„ ì—†ë‹¤. ë”°ë¼ì„œ Modelì´ ë³„ë„ë¡œ í•„ìš”í•˜ë‹¤.)<br>
```java
public class ModelView {

    private String viewName; // ë·°ì˜ ë…¼ë¦¬ ì´ë¦„
    private Map<String, Object> model = new HashMap<>(); // ëª¨ë¸ ê°ì²´

    public ModelView(String viewName) {
        this.viewName = viewName;
    }

    public String getViewName() {
        return viewName;
    }

    public void setViewName(String viewName) {
        this.viewName = viewName;
    }

    public Map<String, Object> getModel() {
        return model;
    }

    public void setModel(Map<String, Object> model) {
        this.model = model;
    }
}
```

### 2. ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤
```java
public interface ControllerV3 {

    ModelView process(Map<String, String> paramMap); // ì„œë¸”ë¦¿ì— ì¢…ì†ì ì´ì§€ ì•Šë‹¤.
}
```
ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ HttpServletRequestì™€ HttpServletResponseë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒìœ¼ë¡œì¨ ì„œë¸”ë¦¿ ì¢…ì†ì„±ì„ ì œê±°í–ˆë‹¤.<br>
`process()`ëŠ” ModelView ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.

### 3. ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´ 
`MemberSaveControllerV3.java`
```java
public class MemberSaveControllerV3 implements ControllerV3 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public ModelView process(Map<String, String> paramMap) {

        // ğŸŒŸ  paramMapì—ì„œ íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ êº¼ë‚´ ì“´ë‹¤.
        String username = paramMap.get("username");
        int age = Integer.parseInt(paramMap.get("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);

        ModelView mv = new ModelView("save-result"); // ğŸŒŸ ë·°ì˜ ì „ì²´ pathê°€ ì•„ë‹Œ ë…¼ë¦¬ì ì¸ ì´ë¦„ì„ ë„£ëŠ”ë‹¤.
        mv.getModel().put("member", member);

        return mv;
    }
}
```

### 4. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬
```java
@WebServlet(name = "frontControllerServletV3", urlPatterns = "/front-controller/v3/*") // /front-controller/v3 ì„ í¬í•¨í•œ ëª¨ë“  í•˜ìœ„ ìš”ì²­ì€ ì´ ì„œë¸”ë¦¿ì—ì„œ ë°›ì•„ë“¤ì¸ë‹¤.
public class FrontControllerServletV3 extends HttpServlet {

    // ë§¤í•‘ ì •ë³´ ì €ì¥ // (key, value): (ë§¤í•‘ URL, í˜¸ì¶œë  ì»¨íŠ¸ë¡¤ëŸ¬)
    private Map<String, ControllerV3> controllerMap = new HashMap<>();

    public FrontControllerServletV3() {
        controllerMap.put("/front-controller/v3/members/new-form", new MemberFormControllerV3());
        controllerMap.put("/front-controller/v3/members/save", new MemberSaveControllerV3());
        controllerMap.put("/front-controller/v3/members", new MemberListControllerV3());
    }

    // service(): requestURLë¥¼ ë°›ì€ ë’¤, ì‹¤ì œ í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ controllerMapì—ì„œ ì°¾ì•„ í˜¸ì¶œí•œë‹¤.
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        String requestURI = req.getRequestURI();
        ControllerV3 controller = controllerMap.get(requestURI); // ë¶€ëª¨ëŠ” ìì‹ì„ ë°›ì„ ìˆ˜ ìˆë‹¤. (ë‹¤í˜•ì„±)

        if (controller == null) {
            res.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        Map<String, String> paramMap = createParamMap(req);
        ModelView mv = controller.process(paramMap);// ğŸŒŸ paramMapì„ ë„˜ê²¨ì¤€ë‹¤.

        String viewName = mv.getViewName(); // ë…¼ë¦¬ì´ë¦„ (ex. new-form)
        MyView view = viewResolver(viewName); // ğŸŒŸ ë…¼ë¦¬ì´ë¦„ìœ¼ë¡œ ë¬¼ë¦¬ìœ„ì¹˜ë¥¼ ë°˜í™˜í•œë‹¤.

        view.render(mv.getModel(), req, res); // ğŸŒŸ render()ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ Model ì •ë³´ë¥¼ ë„˜ê¸´ë‹¤.
    }

    private MyView viewResolver(String viewName) {
        return new MyView("/WEB-INF/views/" + viewName + ".jsp");
    }

    // ğŸŒŸ HttpServletRequestì—ì„œ íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ ëª¨ë‘ êº¼ë‚´ì„œ Mapìœ¼ë¡œ ë°˜í™˜í•œë‹¤.
    private Map<String, String> createParamMap(HttpServletRequest req) {

        Map<String, String> paramMap = new HashMap<>();

        // íŒŒë¼ë¯¸í„° ì´ë¦„ê³¼ valueë¥¼ êº¼ë‚´ì„œ paramMapì— ì§‘ì–´ë„£ëŠ”ë‹¤.(put)
        req.getParameterNames().asIterator()
                .forEachRemaining(paramName -> paramMap.put(paramName, req.getParameter(paramName)));

        return paramMap;
    }
}
```
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì½”ë“œê°€ ë³µì¡í•´ì§„ ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´ë“¤ì˜ ì½”ë“œê°€ ê°„ê²°í•´ì¡Œìœ¼ë©° ìœ ì§€ë³´ìˆ˜ í•˜ê¸°ì—ë„ ì¢‹ì•„ì¡Œë‹¤.

### 5. MyView
```java
public class MyView {

    private String viewPath;

    public MyView(String viewPath) {
        this.viewPath = viewPath;
    }

    public void render(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, res);
    }

    public void render(Map<String, Object> model, HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        modelToRequestAttribute(model, req); // ğŸŒŸ Modelì— ìˆëŠ” ë°ì´í„°ë¥¼ RequestAttributeë¡œ ë°”ê¾¼ë‹¤.
        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, res);
    }

    private void modelToRequestAttribute(Map<String, Object> model, HttpServletRequest req) {
        // ğŸŒŸ JSPëŠ” req.getAttribute()ë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ê¸° ë•Œë¬¸ì—, ëª¨ë¸ì˜ ë°ì´í„°ë¥¼ êº¼ë‚´ì„œ req.setAttrubute()ë¡œ ë‹´ì•„ë‘”ë‹¤.
        model.forEach((key, value) -> req.setAttribute(key, value)); 
    }
}
```

# ğŸ’ v4 - ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì¸ ì»¨íŠ¸ë¡¤ëŸ¬
ì•ì„œ ë§Œë“  v3 ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì„œë¸”ë¦¿ ì¢…ì†ì„±ì„ ì œê±°í•˜ê³  ë·° ê²½ë¡œì˜ ì¤‘ë³µì„ ì œê±°í•˜ëŠ” ë“±, ì˜ ì„¤ê³„ëœ ì»¨íŠ¸ë¡¤ëŸ¬ì´ë‹¤.<br>
ê·¸ëŸ°ë° ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ê°œë°œì ì…ì¥ì—ì„œ ë³´ë©´, í•­ìƒ ModelView ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ë°˜í™˜í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì´ ì¡°ê¸ˆì€ ë²ˆê±°ë¡­ë‹¤.<br>
ì¢‹ì€ í”„ë ˆì„ì›Œí¬ëŠ” ì•„í‚¤í…ì²˜ë„ ì¤‘ìš”í•˜ì§€ë§Œ, ê·¸ì™€ ë”ë¶ˆì–´ ì‹¤ì œ ê°œë°œí•˜ëŠ” ê°œë°œìê°€ ë‹¨ìˆœí•˜ê³  í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ì†Œìœ„ ì‹¤ìš©ì„±ì´ ìˆì–´ì•¼ í•œë‹¤.<br>
ì´ë²ˆì—ëŠ” v3ë¥¼ ì¡°ê¸ˆ ë³€ê²½í•´ì„œ ì‹¤ì œ êµ¬í˜„í•˜ëŠ” ê°œë°œìë“¤ì´ ë§¤ìš° í¸ë¦¬í•˜ê²Œ ê°œë°œí•  ìˆ˜ ìˆëŠ” v4 ë²„ì „ì„ ê°œë°œí•´ë³´ì.

## v4 êµ¬ì¡°
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 5 13 16](https://user-images.githubusercontent.com/59405576/174256538-d3c6b041-71d0-4e5c-a225-d1e526e60244.png)
1. í´ë¼ì´ì–¸íŠ¸ì˜ http ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ FrontControllerê°€ ë§¤í•‘ì •ë³´ë¥¼ ì°¾ì•„ì„œ í•´ë‹¹í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤. (ì´ë•Œ, modelì„ ê°™ì´ ë„˜ê²¨ì¤€ë‹¤. ğŸŒŸ)
2. ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ModelView ëŒ€ì‹ ì— ViewNameì„ ë°˜í™˜í•œë‹¤. ğŸŒŸ
3. FrontControllerê°€ viewResolverë¥¼ í˜¸ì¶œí•˜ë©´, viewResolverì—ì„œ ë…¼ë¦¬ ì´ë¦„ì„ ë¬¼ë¦¬ ìœ„ì¹˜ë¡œ ë³€í™˜í•´ì„œ MyView ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
4. FrontControllerê°€ MyView ì•ˆì— ìˆëŠ” `render(model)`ë¥¼ í˜¸ì¶œí•œë‹¤.

ì „ì²´ì ì¸ êµ¬ì¡°ëŠ” v3ì™€ ìœ ì‚¬í•˜ë‹¤.

## v4 êµ¬í˜„
### 1. ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤
```java
public interface ControllerV4 {

    /**
     * @param paramMap
     * @param model
     * @return viewName
     */
    String process(Map<String, String> paramMap, Map<String, Object> model); // ğŸŒŸ model ê°ì²´ë„ ë°›ì•„ì˜¨ë‹¤.
}
```
ì´ë²ˆ ë²„ì „ì€ ì¸í„°í˜ì´ìŠ¤ì— ModelViewê°€ ì—†ë‹¤. model ê°ì²´ëŠ” íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë˜ê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ ì‚¬ìš©í•˜ë©´ ë˜ê³ , ê²°ê³¼ë¡œ ë·°ì˜ ì´ë¦„ë§Œ ë°˜í™˜í•´ì£¼ë©´ ëœë‹¤.

### 2. ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ì²´
```java
public class MemberSaveControllerV4 implements ControllerV4 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public String process(Map<String, String> paramMap, Map<String, Object> model) {

        String username = paramMap.get("username");
        int age = Integer.parseInt(paramMap.get("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);

        model.put("member", member); // ğŸŒŸ ëª¨ë¸ì´ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë˜ê¸° ë•Œë¬¸ì—, ëª¨ë¸ì„ ì§ì ‘ ìƒì„±í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

        return "save-result";  // ğŸŒŸ ModelView ê°ì²´ê°€ ì•„ë‹Œ, ë‹¨ìˆœí•˜ê²Œ ë·°ì˜ ë…¼ë¦¬ì´ë¦„ì„ ì§ì ‘ ë°˜í™˜í•œë‹¤.
    }
}
```

### 3. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬
```java
@WebServlet(name = "frontControllerServletV4", urlPatterns = "/front-controller/v4/*") // /front-controller/v4 ì„ í¬í•¨í•œ ëª¨ë“  í•˜ìœ„ ìš”ì²­ì€ ì´ ì„œë¸”ë¦¿ì—ì„œ ë°›ì•„ë“¤ì¸ë‹¤.
public class FrontControllerServletV4 extends HttpServlet {

    // ë§¤í•‘ ì •ë³´ ì €ì¥ // (key, value): (ë§¤í•‘ URL, í˜¸ì¶œë  ì»¨íŠ¸ë¡¤ëŸ¬)
    private Map<String, ControllerV4> controllerMap = new HashMap<>();

    public FrontControllerServletV4() {
        controllerMap.put("/front-controller/v4/members/new-form", new MemberFormControllerV4());
        controllerMap.put("/front-controller/v4/members/save", new MemberSaveControllerV4());
        controllerMap.put("/front-controller/v4/members", new MemberListControllerV4());
    }

    // service(): requestURLë¥¼ ë°›ì€ ë’¤, ì‹¤ì œ í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ controllerMapì—ì„œ ì°¾ì•„ í˜¸ì¶œí•œë‹¤.
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        String requestURI = req.getRequestURI();
        ControllerV4 controller = controllerMap.get(requestURI); // ë¶€ëª¨ëŠ” ìì‹ì„ ë°›ì„ ìˆ˜ ìˆë‹¤. (ë‹¤í˜•ì„±)

        if (controller == null) {
            res.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        Map<String, String> paramMap = createParamMap(req);
        Map<String, Object> model = new HashMap<>(); // ğŸŒŸ ëª¨ë¸ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.

        String viewName = controller.process(paramMap, model); // ğŸŒŸ ëª¨ë¸ ê°ì²´ë¥¼ í•¨ê»˜ ë„˜ê²¨ì¤€ë‹¤.

        MyView view = viewResolver(viewName); // ë…¼ë¦¬ì´ë¦„ìœ¼ë¡œ ë¬¼ë¦¬ìœ„ì¹˜ë¥¼ ë°˜í™˜í•œë‹¤.
        view.render(model, req, res); // render()ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ Model ì •ë³´ë¥¼ ë„˜ê¸´ë‹¤.
    }

    private MyView viewResolver(String viewName) {
        return new MyView("/WEB-INF/views/" + viewName + ".jsp");
    }

    // HttpServletRequestì—ì„œ íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ ëª¨ë‘ êº¼ë‚´ì„œ Mapìœ¼ë¡œ ë°˜í™˜í•œë‹¤.
    private Map<String, String> createParamMap(HttpServletRequest req) {
        Map<String, String> paramMap = new HashMap<>();
        req.getParameterNames().asIterator()
                .forEachRemaining(paramName -> paramMap.put(paramName, req.getParameter(paramName)));
        return paramMap;
    }
}
```
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” v3ì™€ ê±°ì˜ ë™ì¼í•˜ë‹¤.<br>
ë‹¬ë¼ì§„ ì ì€, ëª¨ë¸ ê°ì²´ë¥¼ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ìƒì„±í•´ì„œ ë„˜ê²¨ì¤€ë‹¤ëŠ” ê²ƒì´ë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ëª¨ë¸ ê°ì²´ì— ê°’ì„ ë‹´ìœ¼ë©´ ì—¬ê¸°ì— ê·¸ëŒ€ë¡œ ë‹´ê²¨ìˆê²Œ ëœë‹¤. ğŸŒŸ 

## ì •ë¦¬
ì´ë²ˆ ë²„ì „ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë§¤ìš° ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì´ë‹¤. ê¸°ì¡´ êµ¬ì¡°(=v3)ì—ì„œ ëª¨ë¸ì„ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ê³ , viewModel ëŒ€ì‹  ë·°ì˜ ë…¼ë¦¬ ì´ë¦„ì„ ë°˜í™˜í•œë‹¤ëŠ” ì‘ì€ ì•„ì´ë””ì–´ë¥¼ ì ìš©í–ˆì„ ë¿ì¸ë°, ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ êµ¬í˜„í•˜ëŠ” ê°œë°œì ì…ì¥ì—ì„œ ë³´ë©´ ì´ì œ êµ°ë”ë”ê¸° ì—†ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.<br>
ë˜í•œ ì¤‘ìš”í•œ ì‚¬ì‹¤ì€ ì—¬ê¸°ê¹Œì§€ í•œë²ˆì— ì˜¨ ê²ƒì´ ì•„ë‹ˆë¼ëŠ” ì ì´ë‹¤. í”„ë ˆì„ì›Œí¬ê°€ ì ì§„ì ìœ¼ë¡œ ë°œì „í•˜ëŠ” ê³¼ì • ì†ì—ì„œ ì´ëŸ° ë°©ë²•ë„ ì°¾ì„ ìˆ˜ ìˆë‹¤.

# ğŸ’ v5 - ìœ ì—°í•œ ì»¨íŠ¸ë¡¤ëŸ¬ 1
ë§Œì•½ ì–´ë–¤ ê°œë°œìëŠ” `ControllerV3` ë°©ì‹ìœ¼ë¡œ ê°œë°œí•˜ê³  ì‹¶ê³ , ì–´ë–¤ ê°œë°œìëŠ” `ControllerV4` ë°©ì‹ìœ¼ë¡œ ê°œë°œí•˜ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?
```java
public interface ControllerV3 {
    String process(Map<String, String> paramMap);
}
```
```java
public interface ControllerV4 {
    String process(Map<String, String> paramMap, Map<String, Object> model);
}
```
## ì–´ëŒ‘í„° íŒ¨í„´
ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ ê°œë°œí•œ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” í•œ ê°€ì§€ ë°©ì‹ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br>
`ControllerV3`ì™€ `ControllerV4`ëŠ” ì™„ì „íˆ ë‹¤ë¥¸ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. ë”°ë¼ì„œ í˜¸í™˜ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ë§ˆì¹˜ v3ëŠ” 110vì´ê³ , v4ëŠ” 220v ì „ê¸° ì½˜ì„¼íŠ¸ ê°™ì€ ê²ƒì´ë‹¤.<br>
ì´ëŸ´ ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë°”ë¡œ ì–´ëŒ‘í„°ì´ë‹¤. ì–´ëŒ‘í„° íŒ¨í„´ì„ ì‚¬ìš©í•´ì„œ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë‹¤ì–‘í•œ ë°©ì‹ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë³€ê²½í•´ë³´ì.

## v5 êµ¬ì¡°
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-17 á„‹á…©á„’á…® 6 14 59](https://user-images.githubusercontent.com/59405576/174267924-c28c4fda-2ce4-4ef0-90b7-7a9753749ba5.png)
1. í´ë¼ì´ì–¸íŠ¸ì˜ http ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ í•¸ë“¤ëŸ¬ ë§¤í•‘ ì •ë³´ì—ì„œ í•¸ë“¤ëŸ¬ë¥¼ ì¡°íšŒí•œë‹¤. ğŸŒŸ
2. í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ëª©ë¡ì—ì„œ í•¸ë“¤ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ì¡°íšŒí•œë‹¤. ğŸŒŸ<br>(`ControllerV3`ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì–´ëŒ‘í„°, `ControllerV4`ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì–´ëŒ‘í„°, ...)
3. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ í†µí•´ì„œë§Œ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤. ğŸŒŸ
4. í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ê°€ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ í˜¸ì¶œí•œ ë’¤ì— ModelViewë¥¼ ë°˜í™˜í•œë‹¤. ğŸŒŸ
5. v4ì—ì„œì™€ ë§ˆì°¬ê°€ì§€ë¡œ viewResolverë¥¼ í˜¸ì¶œí•˜ë©´, viewResolverì—ì„œ ë…¼ë¦¬ ì´ë¦„ì„ ë¬¼ë¦¬ ìœ„ì¹˜ë¡œ ë³€í™˜í•´ì„œ MyView ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
6. FrontControllerê°€ MyView ì•ˆì— ìˆëŠ” render(model)ë¥¼ í˜¸ì¶œí•œë‹¤.

### í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°
ì¤‘ê°„ì— ì–´ëŒ‘í„° ì—­í• ì„ í•˜ëŠ” ì–´ëŒ‘í„°ê°€ ì¶”ê°€ë˜ì—ˆëŠ”ë°, ì´ë¦„ì´ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ì´ë‹¤. ì—¬ê¸°ì„œ ì–´ëŒ‘í„° ì—­í• ì„ í•´ì£¼ëŠ” ë•ë¶„ì— ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.
### í•¸ë“¤ëŸ¬
ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì´ë¦„ì„ ë” ë„“ì€ ë²”ìœ„ì¸ í•¸ë“¤ëŸ¬ë¡œ ë³€ê²½í–ˆë‹¤. ê·¸ ì´ìœ ëŠ” ì´ì œ ì–´ëŒ‘í„°ê°€ ìˆê¸° ë•Œë¬¸ì—, ê¼­ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ê°œë… ë¿ë§Œ ì•„ë‹ˆë¼ ì–´ë–¤í•œ ê²ƒì´ë“  í•´ë‹¹í•˜ëŠ” ì¢…ë¥˜ì˜ ì–´ëŒ‘í„°ë§Œ ìˆìœ¼ë©´ ë‹¤ ì²˜ë¦¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

## v5 êµ¬í˜„ (ControllerV3)
### 1. MyHandlerAdapter
ì–´ëŒ‘í„°ëŠ” ì´ë ‡ê²Œ êµ¬í˜„í•´ì•¼ í•œë‹¤ëŠ” ì–´ëŒ‘í„°ìš© ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.
```java
public interface MyHandlerAdapter {

    // í•´ë‹¹ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ ì§€ì›í•  ìˆ˜ ìˆìœ¼ë©´ True
    boolean supports(Object handler);

    // ì–´ëŒ‘í„°ëŠ” ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ê³ , ê·¸ ê²°ê³¼ë¡œ ModelViewë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤.
    ModelView handle(HttpServletRequest req, HttpServletResponse res, Object handler) throws ServletException, IOException;
}
```
`handle()`ì—ì„œ ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ModelViewë¥¼ ë°˜í™˜í•˜ì§€ ëª»í•˜ë©´, ì–´ëŒ‘í„°ê°€ ModelViewë¥¼ ì§ì ‘ ìƒì„±í•´ì„œë¼ë„ ë°˜í™˜í•´ì•¼ í•œë‹¤.<br>
ì´ì „ì—ëŠ” í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí–ˆì§€ë§Œ, ì´ì œëŠ” ì´ ì–´ëŒ‘í„°ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í˜¸ì¶œëœë‹¤.

### 2. í—¨ë“¤ëŸ¬ ì–´ëŒ‘í„°
ControllerV3ë¥¼ ì§€ì›í•˜ëŠ” ì–´ëŒ‘í„°ì´ë‹¤.
```java
public class ControllerV3HandlerAdapter implements MyHandlerAdapter {

    @Override
    public boolean supports(Object handler) {

        // handelr ê°ì²´ê°€ ControllerV3ì˜ êµ¬í˜„ì²´ë¼ë©´ True ë°˜í™˜
        return (handler instanceof ControllerV3);
    }

    @Override
    public ModelView handle(HttpServletRequest req, HttpServletResponse res, Object handler) throws ServletException, IOException {

        ControllerV3 controller = (ControllerV3) handler; // supports()ë¥¼ í†µí•´ ControllerV3ë§Œ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— íƒ€ì…ë³€í™˜ì„ ì‹¤í–‰í•´ë„ ëœë‹¤.

        Map<String, String> paramMap = createParamMap(req);
        ModelView mv = controller.process(paramMap); // í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ê°€ ì‹¤ì œ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ í˜¸ì¶œí•´ modelViewë¥¼ ë°›ì•„ì˜¨ë‹¤.

        return mv;
    }

    // HttpServletRequestì—ì„œ íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ ëª¨ë‘ êº¼ë‚´ì„œ Mapìœ¼ë¡œ ë°˜í™˜í•œë‹¤.
    private Map<String, String> createParamMap(HttpServletRequest req) {
        Map<String, String> paramMap = new HashMap<>();
        req.getParameterNames().asIterator()
                .forEachRemaining(paramName -> paramMap.put(paramName, req.getParameter(paramName)));
        return paramMap;
    }
}
```

### 3. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬
```java
@WebServlet(name = "frontControllerServletV5", urlPatterns = "/front-controller/v5/*")
public class FrontControllerServletV5 extends HttpServlet {

    private final Map<String, Object> handlerMappingMap = new HashMap<>(); // ğŸŒŸ ë§¤í•‘ ì •ë³´ì˜ ê°’ì´ ControllerV3, ControllerV4 ê°™ì€ ì¸í„°í˜ì´ìŠ¤ê°€ ì•„ë‹ˆë¼, ì•„ë¬´ ê°’ì´ë‚˜ ë°›ì„ ìˆ˜ ìˆëŠ” Objectë¡œ ë³€ê²½ë˜ì—ˆë‹¤.
    private final List<MyHandlerAdapter> handlerAdapters = new ArrayList<>();

    public FrontControllerServletV5() {

        initHandlerMappingMap(); // í•¸ë“¤ëŸ¬ ë§¤í•‘ ì´ˆê¸°í™”
        initHandlerAdapters(); // ì–´ëŒ‘í„° ì´ˆê¸°í™”
    }

    // ControllerV3 í•¸ë“¤ëŸ¬ ë§¤í•‘ ì •ë³´ ì €ì¥
    private void initHandlerMappingMap() {
        handlerMappingMap.put("/front-controller/v5/v3/members/new-form", new MemberFormControllerV3());
        handlerMappingMap.put("/front-controller/v5/v3/members/save", new MemberSaveControllerV3());
        handlerMappingMap.put("/front-controller/v5/v3/members", new MemberListControllerV3());
    }

    // í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
    private void initHandlerAdapters() {
        handlerAdapters.add(new ControllerV3HandlerAdapter());
    }

    @Override
    protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {

        // 1. í•¸ë“¤ëŸ¬ ì¡°íšŒ ğŸŒŸ
        Object handler = getHandler(req); // MemberFormControllerV3 ë°˜í™˜
        if (handler == null) {
            res.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        // 2. í•¸ë“¤ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì–´ëŒ‘í„° ì¡°íšŒ ğŸŒŸ
        MyHandlerAdapter adapter = getHandlerAdapter(handler);

        // 3. handle() ë©”ì„œë“œë¥¼ í†µí•´ ì–´ëŒ‘í„°ë¥¼ í˜¸ì¶œí•˜ê³ , ì–´ëŒ‘í„°ëŠ” í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬) í˜¸ì¶œ í›„ ì–´ëŒ‘í„°ì— ë§ëŠ” modelViewë¥¼ ë°˜í™˜í•œë‹¤. ğŸŒŸ
        ModelView mv = adapter.handle(req, res, handler);

        // 4. viewResolver í˜¸ì¶œ
        String viewName = mv.getViewName(); // ë…¼ë¦¬ì´ë¦„ (ex. new-form)
        MyView view = viewResolver(viewName); // ë…¼ë¦¬ì´ë¦„ìœ¼ë¡œ ë¬¼ë¦¬ìœ„ì¹˜ë¥¼ ë°˜í™˜í•œë‹¤.

        // 5. render(model) í˜¸ì¶œ
        view.render(mv.getModel(), req, res); // render()ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ Model ì •ë³´ë¥¼ ë„˜ê¸´ë‹¤.
    }

    // í•´ë‹¹ handlerë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì–´ëŒ‘í„°ë¥¼ adapter.supports()ë¥¼ í†µí•´ ì°¾ëŠ”ë‹¤.
    private MyHandlerAdapter getHandlerAdapter(Object handler) {

        // 1. handlerê°€ ControllerV3 ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í–ˆë‹¤ë©´,
        for (MyHandlerAdapter adapter : handlerAdapters) {
            if (adapter.supports(handler)){
                return adapter; // 2. ControllerV3HandlerAdapter ê°ì²´ê°€ ë°˜í™˜ëœë‹¤.
            }
        }
        throw new IllegalArgumentException("handler adapterë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. handler = " + handler);
    }

    // í•¸ë“¤ëŸ¬ ë§¤í•‘ ì •ë³´ì¸ handlerMappingMapì—ì„œ URLì— ë§¤í•‘ëœ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬) ê°ì²´ë¥¼ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤.
    private Object getHandler(HttpServletRequest req) {

        String requestURI = req.getRequestURI();
        return handlerMappingMap.get(requestURI); 
    }

    private MyView viewResolver(String viewName) {
        return new MyView("/WEB-INF/views/" + viewName + ".jsp");
    }
```

# ğŸ’ v5 - ìœ ì—°í•œ ì»¨íŠ¸ë¡¤ëŸ¬ 2
ê¸°ì¡´ v5 ì½”ë“œì— ì¶”ê°€í•œë‹¤.
## v5 êµ¬í˜„ (ControllerV4)

### 1. í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°
ControllerV4ë¥¼ ì§€ì›í•˜ëŠ” ì–´ëŒ‘í„°ì´ë‹¤.
```java
public class ControllerV4HandlerAdapter implements MyHandlerAdapter {

    @Override
    public boolean supports(Object handler) {

        // handelr ê°ì²´ê°€ ControllerV4ì˜ êµ¬í˜„ì²´ë¼ë©´ True ë°˜í™˜
        return (handler instanceof ControllerV4);
    }

    @Override
    public ModelView handle(HttpServletRequest req, HttpServletResponse res, Object handler) throws ServletException, IOException {

        ControllerV4 controller = (ControllerV4) handler;

        Map<String, String> paramMap = createParamMap(req);
        HashMap<String, Object> model = new HashMap<>(); // ëª¨ë¸ ì¶”ê°€

        String viewName = controller.process(paramMap, model); // ì»¨íŠ¸ë¡¤ëŸ¬ì˜ process() ë©”ì„œë“œì—ì„œ ëª¨ë¸ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ë‹´ì•„ë†“ëŠ”ë‹¤.

        /*
        * ControllerV4ëŠ” ModelViewê°€ ì•„ë‹ˆë¼ viewNameì„ ë°˜í™˜í•œë‹¤.
        * ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ModelViewë¥¼ ë°˜í™˜í•˜ì§€ ëª»í•˜ë©´, ì–´ëŒ‘í„°ê°€ ModelViewë¥¼ ì§ì ‘ ìƒì„±í•´ì„œë¼ë„ ë°˜í™˜í•´ì•¼ í•œë‹¤. ğŸŒŸ
        */
        ModelView mv = new ModelView(viewName); // ë·° setting
        mv.setModel(model); // ëª¨ë¸ setting

        return mv;
    }

    // HttpServletRequestì—ì„œ íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ ëª¨ë‘ êº¼ë‚´ì„œ Mapìœ¼ë¡œ ë°˜í™˜í•œë‹¤.
    private Map<String, String> createParamMap(HttpServletRequest req) {
        Map<String, String> paramMap = new HashMap<>();
        req.getParameterNames().asIterator()
                .forEachRemaining(paramName -> paramMap.put(paramName, req.getParameter(paramName)));
        return paramMap;
    }
}

```
`handle()`ì—ì„œ ì–´ëŒ‘í„°ê°€ ê¼­ í•„ìš”í•œ ì´ìœ ê°€ ë‚˜ì˜¨ë‹¤.<br>
`ControllerV4`ëŠ” ë·°ì˜ ì´ë¦„ì„ ë°˜í™˜í–ˆì§€ë§Œ, ì–´ëŒ‘í„°ëŠ” ì´ê²ƒì„ ModelViewë¡œ ë§Œë“¤ì–´ì„œ í˜•ì‹ì„ ë§ì¶”ì–´ ë°˜í™˜í•œë‹¤.<br>
ë§ˆì¹˜ 110v ì „ê¸° ì½˜ì„¼íŠ¸ë¥¼ 220v ì „ê¸° ì½˜ì„¼íŠ¸ë¡œ ë³€ê²½í•˜ë“¯ì´!

### 2. í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬
`FrontControllerServletV5`ì— `ControllerV4` ê¸°ëŠ¥ì„ ì¶”ê°€í•´ë³´ì.
```java
...

  // ControllerV3ì™€  ControllerV4 í•¸ë“¤ëŸ¬ ë§¤í•‘ ì •ë³´ ì €ì¥
    private void initHandlerMappingMap() {
        handlerMappingMap.put("/front-controller/v5/v3/members/new-form", new MemberFormControllerV3());
        handlerMappingMap.put("/front-controller/v5/v3/members/save", new MemberSaveControllerV3());
        handlerMappingMap.put("/front-controller/v5/v3/members", new MemberListControllerV3());

        // ğŸŒŸ ì¶”ê°€
        handlerMappingMap.put("/front-controller/v5/v4/members/new-form", new MemberFormControllerV4());
        handlerMappingMap.put("/front-controller/v5/v4/members/save", new MemberSaveControllerV4());
        handlerMappingMap.put("/front-controller/v5/v4/members", new MemberListControllerV4());
    }

...

  // í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
    private void initHandlerAdapters() {
        handlerAdapters.add(new ControllerV3HandlerAdapter());
        handlerAdapters.add(new ControllerV4HandlerAdapter()); // ğŸŒŸ ì¶”ê°€
    }

...
```
í•¸ë“¤ëŸ¬ ë§¤í•‘(`handlerMappingMap`)ì— `ControllerV4`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì¶”ê°€í•˜ê³ , í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì–´ëŒ‘í„°ì¸ `ControllerV4HandlerAdapter`ë„ ì¶”ê°€í•˜ì.

# ì •ë¦¬
ì§€ê¸ˆê¹Œì§€ v1~v5ë¡œ ì ì§„ì ìœ¼ë¡œ í”„ë ˆì„ì›Œí¬ë¥¼ ë°œì „ì‹œì¼œ ì™”ë‹¤. ì§€ê¸ˆê¹Œì§€ í•œ ì‘ì—…ì„ ì •ë¦¬í•´ë³´ì.
1. v1: í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë„ì…
- ê¸°ì¡´ êµ¬ì¡°ë¥¼ ìµœëŒ€í•œ ìœ ì§€í•˜ë©´ì„œ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë„ì…

2. v2: View ë¶„ë¥˜
- ë‹¨ìˆœ ë°˜ë³µë˜ëŠ” ë·° ë¡œì§ ë¶„ë¦¬

3. v3: Model ì¶”ê°€
- ì„œë¸”ë¦¿ ì¢…ì†ì„± ì œê±°
- ë·° ì´ë¦„ ì¤‘ë³µ ì œê±°

4. v4: ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì¸ ì»¨íŠ¸ë¡¤ëŸ¬
- v3ì™€ ê±°ì˜ ë¹„ìŠ·
- êµ¬í˜„ ì…ì¥ì—ì„œ ModelViewë¥¼ ì§ì ‘ ìƒì„±í•´ì„œ ë°˜í™˜í•˜ì§€ ì•Šë„ë¡ í¸ë¦¬í•œ ì¸í„°í˜ì´ìŠ¤ ì œê³µ

5. v5: ìœ ì—°í•œ ì»¨íŠ¸ë¡¤ëŸ¬
- ì–´ëŒ‘í„° ë„ì…
- ì–´ëŒ‘í„°ë¥¼ ì¶”ê°€í•´ì„œ í”„ë ˆì„ ì›Œí¬ë¥¼ ìœ ì—°í•˜ê³  í™•ì¥ì„± ìˆê²Œ ì„¤ê³„

ì—¬ê¸°ì— ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë” í¸ë¦¬í•˜ê²Œ ë°œì „ì‹œí‚¬ ìˆ˜ë„ ìˆë‹¤. ë§Œì•½ ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?<br>
ë°”ë¡œ ì• ë…¸í…Œì´ì…˜ì„ ì§€ì›í•˜ëŠ” ì–´ëŒ‘í„°ë¥¼ ì¶”ê°€í•˜ë©´ ëœë‹¤!<br>
ë‹¤í˜•ì„±ê³¼ ì–´ëŒ‘í„° ë•ë¶„ì— ê¸°ì¡´ êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë©´ì„œ, í”„ë ˆì„ì›Œí¬ì˜ ê¸°ëŠ¥ì„ í™•ì¥í•  ìˆ˜ ìˆë‹¤.<br>

## ìŠ¤í”„ë§ MVC
ì—¬ê¸°ì„œ ë” ë°œì „ì‹œí‚¤ë©´ ì¢‹ê² ì§€ë§Œ, ìŠ¤í”„ë§ MVCì˜ í•µì‹¬ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ëŠ”ë° í•„ìš”í•œ ë¶€ë¶„ì€ ëª¨ë‘ ë§Œë“¤ì–´ë³´ì•˜ë‹¤.<br>
ì‚¬ì‹¤ ìš°ë¦¬ê°€ ì§€ê¸ˆê¹Œì§€ ì‘ì„±í•œ ì½”ë“œëŠ” ìŠ¤í”„ë§ MVC í”„ë ˆì„ì›Œí¬ì˜ í•µì‹¬ ì½”ë“œì˜ ì¶•ì•½ ë²„ì „ì´ê³ , êµ¬ì¡°ë„ ê±°ì˜ ê°™ë‹¤.<br>
ìŠ¤í”„ë§ MVCëŠ” ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ë‚´ìš©ê³¼ ê±°ì˜ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.


***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}