---
title:  "[SPRING] HTTP ìš”ì²­ íŒŒë¼ë¯¸í„° & HTTP ìš”ì²­ ë©”ì‹œì§€ "

categories:
  - Spring
tags:
  - [Framework, Spring, Java]

toc: true
toc_sticky: true
 
date: 2022-06-22 13:17:35
last_modified_at: 2022-06-22 13:17:39
---

# HTTP ìš”ì²­ - ê¸°ë³¸, í—¤ë” ì¡°íšŒ
ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ì˜ ìŠ¤í”„ë§ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë‹¤ì–‘í•œ íŒŒë¦¬ë¯¸í„°ë¥¼ ì§€ì›í•œë‹¤. HTTP í—¤ë” ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì.
```java
@Slf4j // ë¡œê·¸ë¥¼ ì„ ì–¸í•´ì¤€ë‹¤.
@RestController
public class RequestHeaderController {

    @RequestMapping("/headers")
    public String headers(HttpServletRequest req,
                          HttpServletResponse res,
                          HttpMethod httpMethod,
                          Locale locale,
                          @RequestHeader MultiValueMap<String, String> headerMap,
                          @RequestHeader("host") String host,
                          @CookieValue(value="myCookie", required = false) String cookie){

        log.info("request={}", req);
        log.info("response={}", res);
        log.info("httpMethod={}", httpMethod);
        log.info("locale={}", locale);
        log.info("headerMap={}", headerMap);
        log.info("header host={}", host);
        log.info("myCookie={}", cookie);

        return "ok";
    }
}
```
- `HttpMethod`: HTTP ë©”ì„œë“œë¥¼ ì¡°íšŒí•œë‹¤.
- `Locale`: Locale ì •ë³´ë¥¼ ì¡°íšŒí•œë‹¤.
- `@RequestHeader MultiValueMap<String, String> headerMap`: ëª¨ë“  HTTP í—¤ë”ë¥¼ MultiValueMap í˜•ì‹ìœ¼ë¡œ ì¡°íšŒí•œë‹¤.
- `@RequestHeader("host") String host`: íŠ¹ì • HTTP í—¤ë”ë¥¼ ì¡°íšŒí•œë‹¤.
- `@CookieValue(value="myCookie", required = false) String cookie`: íŠ¹ì • ì¿ í‚¤ë¥¼ ì¡°íšŒí•œë‹¤.

## MultiValueMap
- Maprê³¼ ìœ ì‚¬í•œë°, í•˜ë‚˜ì˜ í‚¤ì— ì—¬ëŸ¬ ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.
- HTTP header, HTTP ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì™€ ê°™ì´ í•˜ë‚˜ì˜ í‚¤ì— ì—¬ëŸ¬ ê°’ì„ ë°›ì„ ë•Œ ì‚¬ìš©í•œë‹¤.<br>- keyA=value1&keyA=value2

### ì‚¬ìš© ì˜ˆì‹œ
```java
MultiValueMap<String, String> map = new LinkedMultiValueMap();
    map.add("keyA", "value1");
    map.add("keyA", "value2");
    
    List<String> values = map.get("keyA"); //[value1,value2]ì²˜ëŸ¼ ë°°ì—´ í˜•íƒœë¡œ ë°˜í™˜
```

> ì°¸ê³ <br>
`@Conroller`ì˜ ì‚¬ìš© ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„° ëª©ë¡ì€ ë‹¤ìŒ ê³µì‹ ë©”ë‰´ì–¼ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br>
[https://docs.spring.io/spring-framework/docs/current/reference/html/web.html#mvc-ann-arguments](https://docs.spring.io/spring-framework/docs/current/reference/html/web.html#mvc-ann-arguments)

> ì°¸ê³ <br>
`@Conroller`ì˜ ì‚¬ìš© ê°€ëŠ¥í•œ ì‘ë‹µ ê°’ ëª©ë¡ì€ ë‹¤ìŒ ê³µì‹ ë©”ë‰´ì–¼ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br>
[https://docs.spring.io/spring-framework/docs/current/reference/html/web.html#mvc-ann-return-types](https://docs.spring.io/spring-framework/docs/current/reference/html/web.html#mvc-ann-return-types)


# HTTP ìš”ì²­ ë°ì´í„° ì¡°íšŒ
## ê°œìš”
ì„œë¸”ë¦¿ì—ì„œ í•™ìŠµí–ˆë˜ HTTP ìš”ì²­ ë°ì´í„°ë¥¼ ì¡°íšŒ í•˜ëŠ” ë°©ë²•ì„ ë‹¤ì‹œ ë– ì˜¬ë ¤ë³´ì. ê·¸ë¦¬ê³  ì„œë¸”ë¦¿ìœ¼ë¡œ í•™ìŠµí–ˆë˜ ë‚´ìš©ì„ ìŠ¤í”„ë§ì´ ì–¼ë§ˆë‚˜ ê¹”ë”í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ë°”ê¾¸ì–´ì£¼ëŠ”ì§€ ì•Œì•„ë³´ì.<br>
HTTP ìš”ì²­ ë©”ì‹œì§€ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ë•ŒëŠ” ì£¼ë¡œ ë‹¤ìŒ 3ê°€ì§€ ë°©ë²•ì„ ì‚¬ìš©í•œë‹¤.<br>

1ë²ˆê³¼ 2ë²ˆ ë°©ì‹ì€ `HttpServletRequest`ì˜ `request.getParameter()`ë¥¼ ì‚¬ìš©í•´ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
GET ì¿¼ë¦¬ íŒŒë¦¬ë¯¸í„° ì „ì†¡ ë°©ì‹ì´ë“ , POST HTML Form ì „ì†¡ ë°©ì‹ì´ë“  ë‘˜ë‹¤ í˜•ì‹ì´ ê°™ìœ¼ë¯€ë¡œ êµ¬ë¶„ì—†ì´ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.<br>
ì´ê²ƒì„ ê°„ë‹¨íˆ ìš”ì²­ íŒŒë¼ë¯¸í„°(request parameter) ì¡°íšŒë¼ í•œë‹¤.<br>

3ë²ˆ ë°©ì‹ì€ ë°ì´í„° ë°”ë””ì— ì§ì ‘ ì˜¤ê¸° ë•Œë¬¸ì— í•´ë‹¹ ë¯¸ë””ì–´ íƒ€ì…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” HTTP ë©”ì‹œì§€ ì»¨ë²„í„°ê°€ ì‹¤í–‰ëœë‹¤.<br>

1. GET - ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°
- /url?username=hello&age=20
- ë©”ì‹œì§€ ë°”ë”” ì—†ì´, URLì˜ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì— ë°ì´í„°ë¥¼ í¬í•¨í•´ì„œ ì „ë‹¬ 
- ì˜ˆ) ê²€ìƒ‰, í•„í„°, í˜ì´ì§•ë“±ì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
- ì˜ˆì‹œ
```
http://localhost:8080/request-param?username=hello&age=20
```

2. POST - HTML Form
- content-type: application/x-www-form-urlencoded
- ë©”ì‹œì§€ ë°”ë””ì— ì¿¼ë¦¬ íŒŒë¦¬ë¯¸í„° í˜•ì‹ìœ¼ë¡œ ì „ë‹¬ username=hello&age=20 
- ì˜ˆ) íšŒì› ê°€ì…, ìƒí’ˆ ì£¼ë¬¸, HTML Form ì‚¬ìš©
- ì˜ˆì‹œ
```
POST /request-param ...
content-type: application/x-www-form-urlencoded
username=hello&age=20
```

3. HTTP message bodyì— ë°ì´í„°ë¥¼ ì§ì ‘ ë‹´ì•„ì„œ ìš”ì²­
- HTTP APIì—ì„œ ì£¼ë¡œ ì‚¬ìš©, JSON, XML, TEXT 
- ë°ì´í„° í˜•ì‹ì€ ì£¼ë¡œ JSON ì‚¬ìš©
- POST, PUT, PATCH

í•˜ë‚˜ì”© ì•Œì•„ë³´ì.

## ğŸŒ¸ HTTP ìš”ì²­ íŒŒë¼ë¯¸í„° (ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°, HTML Form) ì¡°íšŒ - @RequestParam
ì§€ê¸ˆë¶€í„° ìŠ¤í”„ë§ìœ¼ë¡œ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•ì„ ë‹¨ê³„ì ìœ¼ë¡œ ì•Œì•„ë³´ì.

### hello-form.html
í…ŒìŠ¤íŠ¸ìš© HTML Formìœ¼ë¡œ `/resources/static` ì•„ë˜ì— ë‘ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ìë™ìœ¼ë¡œ ì¸ì‹í•œë‹¤.
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form action="/request-param-v1" method="post">
    username: <input type="text" name="username"/>
    age: <input type="text" name="age"/>
    <button type="submit">ì „ì†¡</button>
</form>
</body>
</html>
```
### v1 - HttpServletRequest
`RequestParamController`
```java
@Slf4j
@Controller
public class RequestParamController {

    @RequestMapping("/request-param-v1")
    public void requestParamV1(HttpServletRequest req, HttpServletResponse res) throws IOException {

        String username = req.getParameter("username");
        int age = Integer.parseInt(req.getParameter("age"));
        log.info("username={}, age={}", username, age);

        res.getWriter().write("ok");
    }
}
```
ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœíˆ HttpServletRequestê°€ ì œê³µí•˜ëŠ” `req.getParameter()`ìœ¼ë¡œ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°íšŒí–ˆë‹¤.



### v2 - @RequestParam
ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” `@RequestParam`ì„ ì‚¬ìš©í•˜ë©´ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ë§¤ìš° í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br>
`RequestParamController`
```java
@Slf4j
@Controller
public class RequestParamController {

    @ResponseBody // View ì¡°íšŒë¥¼ ë¬´ì‹œí•˜ê³ , HTTP message bodyì— ì§ì ‘ í•´ë‹¹ ë‚´ìš© ì…ë ¥
    @RequestMapping("/request-param-v2")
    public String requestParamV2(
            @RequestParam("username") String memberName,
            @RequestParam("age") int MemberAge){

        log.info("username={}, age={}", memberName, MemberAge);

        return "ok";
    }
}
```
- `@RequestParam`: íŒŒë¼ë¯¸í„° ì´ë¦„ìœ¼ë¡œ ë°”ì¸ë”©
- `@ResponseBody`: View ì¡°íšŒë¥¼ ë¬´ì‹œí•˜ê³ , HTTP message bodyì— ì§ì ‘ í•´ë‹¹ ë‚´ìš© ì…ë ¥

### v3 - @RequestParam
`RequestParamController`
```java
@Slf4j
@Controller
public class RequestParamController {

    @ResponseBody
    @RequestMapping("/request-param-v3")
    public String requestParamV3(
            @RequestParam String username, // íŒŒë¼ë¯¸í„°ì˜ ì´ë¦„ê³¼ ë³€ìˆ˜ëª…ì´ ê°™ì€ ê²½ìš° ìƒëµ ê°€ëŠ¥
            @RequestParam int age){

        log.info("username={}, age={}", username, age);

        return "ok";
    }
}
```
- HTTP íŒŒë¼ë¯¸í„° ì´ë¦„ì´ ë³€ìˆ˜ ì´ë¦„ê³¼ ê°™ìœ¼ë©´ @RequestParam(name="xx") ìƒëµ ê°€ëŠ¥

### v4 - @RequestParam
`RequestParamController`
```java
@Slf4j
@Controller
public class RequestParamController {

    @ResponseBody
    @RequestMapping("/request-param-v4")
    public String requestParamV4(
            String username, // íŒŒë¼ë¯¸í„°ì˜ ì´ë¦„ê³¼ ë³€ìˆ˜ëª…ì´ ê°™ì€ ê²½ìš° @RequestParamë„ ìƒëµ ê°€ëŠ¥
            int age){

        log.info("username={}, age={}", username, age);

        return "ok";
    }
}
```
- String , int , Integer ë“±ì˜ ë‹¨ìˆœ íƒ€ì…ì´ë©´ `@RequestParam`ë„ ìƒëµ ê°€ëŠ¥

> ì£¼ì˜<br>
 @RequestParam ì• ë…¸í…Œì´ì…˜ì„ ìƒëµí•˜ë©´ ìŠ¤í”„ë§ MVCëŠ” ë‚´ë¶€ì—ì„œ required=false ë¥¼ ì ìš©í•œë‹¤.

 > ì°¸ê³ <br>
 ì´ë ‡ê²Œ ì• ë…¸í…Œì´ì…˜ì„ ì™„ì „íˆ ìƒëµí•´ë„ ë˜ëŠ”ë°, ë„ˆë¬´ ì—†ëŠ” ê²ƒë„ ì•½ê°„ ê³¼í•˜ë‹¤ëŠ” ì£¼ê´€ì  ìƒê°ì´ ìˆë‹¤. <br>
 `@RequestParam`ì´ ìˆìœ¼ë©´ ëª…í™•í•˜ê²Œ ìš”ì²­ íŒŒë¦¬ë¯¸í„°ì—ì„œ ë°ì´í„°ë¥¼ ì½ëŠ” ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

### íŒŒë¼ë¯¸í„° í•„ìˆ˜ ì—¬ë¶€ - required
`RequestParamController`
```java
@Slf4j
@Controller
public class RequestParamController {

    @ResponseBody
    @RequestMapping("/request-param-required")
    public String requestParamRequired(
            @RequestParam(required = true) String username, // í•´ë‹¹ íŒŒë¼ë¯¸í„°ëŠ” ë¬´ì¡°ê±´ ìˆì–´ì•¼ í•œë‹¤. (defaultê°€ true)
            @RequestParam(required = false) Integer age){ // í•´ë‹¹ íŒŒë¼ë¯¸í„°ê°€ ì—†ì–´ë„ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.

        log.info("username={}, age={}", username, age);

        return "ok";
    }
}
```
- `@RequestParam.required`<br>- íŒŒë¦¬ë¯¸í„° í•„ìˆ˜ ì—¬ë¶€<br>- ê¸°ë³¸ê°’ì´ íŒŒë¦¬ë¯¸í„° í•„ìˆ˜(true)ì´ë‹¤.

> ì£¼ì˜<br>
`@RequestParam(required = true) String username`ì¼ ë•Œ, `/request-param-required?username=`ì²˜ëŸ¼ íŒŒë¼ë¯¸í„° ì´ë¦„ë§Œ ìˆê³  ê°’ì´ ì—†ëŠ” ê²½ìš°ì— `username=`ë¡œ ë“¤ì–´ì˜¨ë‹¤.<br>
ì™œëƒí–ë©´ `""`(ë¹ˆë¬¸ì)ëŠ” nullì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤.

> ì£¼ì˜<br>
`@RequestParam(required = false) int age`ëŠ” 500 ì˜ˆì™¸ê°€ ë°œìƒí•˜ë‹¤.<br>
ì™œëƒí•˜ë©´ `int`ì— nullì„ ë„£ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ nullì„ ë°›ì„ ìˆ˜ ìˆëŠ” `Integer`ë¡œ ë³€ê²½í•˜ê±°ë‚˜ `defaultValue`ë¥¼ ì‚¬ìš©í•œë‹¤.

### ê¸°ë³¸ ê°’ ì ìš© - defaultValue
`RequestParamController`
```java
@Slf4j
@Controller
public class RequestParamController {

    @ResponseBody
    @RequestMapping("/request-param-default")
    public String requestParamDefault(
            @RequestParam(required = true, defaultValue = "guest") String username,
            @RequestParam(required = false, defaultValue = "-1") int age){ // defaultValueë¥¼ ì§€ì •í•œ ê²½ìš° int ìë£Œí˜•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

        log.info("username={}, age={}", username, age);

        return "ok";
    }
}
```
- íŒŒë¼ë¯¸í„°ì— ê°’ì´ ì—†ëŠ” ê²½ìš° defaultValue ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ ê°’ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
- ì´ë¯¸ ê¸°ë³¸ ê°’ì´ ìˆê¸° ë•Œë¬¸ì— required ëŠ” ì˜ë¯¸ê°€ ì—†ë‹¤.

> ì£¼ì˜<br>
defaultValue ëŠ” ë¹ˆ ë¬¸ìì˜ ê²½ìš°ì—ë„ ì„¤ì •í•œ ê¸°ë³¸ ê°’ì´ ì ìš©ëœë‹¤.
- `@RequestParam(defaultValue = "guest") String username`ì¼ ë•Œ, `/request-param-required?username=`ì²˜ëŸ¼ íŒŒë¼ë¯¸í„° ì´ë¦„ë§Œ ìˆê³  ê°’ì´ ì—†ëŠ” ê²½ìš°ì— `username=guest`ë¡œ ë“¤ì–´ì˜¨ë‹¤.

### ëª¨ë“  íŒŒë¼ë¯¸í„° ì¡°íšŒ - Map
`RequestParamController`
```java
@Slf4j
@Controller
public class RequestParamController {

    @ResponseBody
    @RequestMapping("/request-param-map")
    public String requestParamMap(@RequestParam Map<String, Object> paramMap){

        log.info("username={}, age={}", paramMap.get("username"), paramMap.get("age"));

        return "ok";
    }
}
```
íŒŒë¼ë¯¸í„°ë¥¼ Map, MultiValueMapìœ¼ë¡œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- @RequestParam Map <br>- Map(key=value)
- @RequestParam MultiValueMap<br>- MultiValueMap(key=[value1, value2, ...] <br>- ex) `?userIds=id1&userIds=id2` => (key=userIds, value=[id1, id2])

íŒŒë¼ë¯¸í„°ì˜ ê°’ì´ 1ê°œê°€ í™•ì‹¤í•˜ë‹¤ë©´ `Map`ì„ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ, ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ `MultiValueMap`ì„ ì‚¬ìš©í•˜ì.<br>
(ë³´í†µì˜ ê²½ìš° íŒŒë¼ë¯¸í„° ê°’ì€ 1ê°œë¥¼ ì‚¬ìš©í•œë‹¤.)

## ğŸŒ¸ HTTP ìš”ì²­ íŒŒë¼ë¯¸í„° (ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°, HTML Form) ì¡°íšŒ - @ModelAttribute

### HelloData
```java
import lombok.Data;

@Data // ë¡¬ë³µì—ì„œ ì œê³µí•˜ëŠ” ì• ë…¸í…Œì´ì…˜ì´ë‹¤.
public class HelloData {

    private String username;
    private int age;
}
```

#### lombok - @Data
- `@Getter` , `@Setter` , `@ToString` , `@EqualsAndHashCode` , `@RequiredArgsConstructor`ë¥¼ ìë™ìœ¼ë¡œ ì ìš©í•´ì¤€ë‹¤.

### v1 - @ModelAttribute ì ìš©
`RequestParamController`
```java
@Slf4j
@Controller
public class RequestParamController {

    @ResponseBody
    @RequestMapping("/model-attribute-v1")
    public String modelAttributeV1(@ModelAttribute HelloData helloData){

        log.info("username={}, age={}", helloData.getUsername(), helloData.getAge());
        log.info("helloData={}", helloData); // toStringì„ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.

        return "ok";
    }
}
```
ë§ˆì¹˜ ë§ˆë²•ì²˜ëŸ¼ `HelloData` ê°ì²´ê°€ ìƒì„±ë˜ê³ , ìš”ì²­ íŒŒë¼ë¯¸í„°ì˜ ê°’ë„ ëª¨ë‘ ë“¤ì–´ê°€ ìˆë‹¤.<br>
ìŠ¤í”„ë§ MVCëŠ” `@ModelAttribute`ê°€ ìˆìœ¼ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•œë‹¤.
- `HelloData` ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
- ìš”ì²­ íŒŒë¼ë¯¸í„°ì˜ ì´ë¦„ìœ¼ë¡œ `HelloData` ê°ì²´ì˜ í”„ë¡œí¼í‹°ë¥¼ ì°¾ëŠ”ë‹¤. ê·¸ë¦¬ê³  í•´ë‹¹ í”„ë¡œí¼í‹°ì˜ setterë¥¼ í˜¸ì¶œí•´ì„œ íŒŒë¼ë¯¸í„°ì˜ ê°’ì„ ì…ë ¥(ë°”ì¸ë”©)í•œë‹¤.
- ì˜ˆ) íŒŒë¼ë¯¸í„° ì´ë¦„ì´ `username`ì´ë©´ `setUsername()` ë©”ì„œë“œë¥¼ ì°¾ì•„ì„œ í˜¸ì¶œí•˜ë©´ì„œ ê°’ì„ ì…ë ¥í•œë‹¤.

#### í”„ë¡œí¼í‹°
- ê°ì²´ì— `getUsername()`, `setUsername()` ë©”ì„œë“œê°€ ìˆìœ¼ë©´, ì´ ê°ì²´ëŠ” `username`ì´ë¼ëŠ” í”„ë¡œí¼í‹°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.
- `username` í”„ë¡œí¼í‹°ì˜ ê°’ì„ ë³€ê²½í•˜ë©´ `setUsername()`ì´ í˜¸ì¶œë˜ê³ , ì¡°íšŒí•˜ë©´ `getUsername()`ì´ í˜¸ì¶œëœë‹¤.

```java
class HelloData {
      getUsername();
      setUsername();
}
```

> ì°¸ê³ <br>
`@RequestParam`ì„ ì´ìš©í•œë‹¤ë©´ ì•„ë˜ì²˜ëŸ¼ ì§ì ‘ ê°ì²´ë¥¼ ìƒì„±í•œ ë’¤ì— íŒŒë¼ë¯¸í„° ê°’ì„ ë„£ì—ˆì„ ê²ƒì´ë‹¤.

```java
@Slf4j
@Controller
public class RequestParamController {

    @ResponseBody
    @RequestMapping("/model-attribute-v1")
    public String modelAttributeV1(@RequestParam String username, @RequestParam int age){

        HelloData helloData = new HelloData();
        helloData.setUsername(username);
        helloData.setAge(age);

        log.info("username={}, age={}", helloData.getUsername(), helloData.getAge());
        log.info("helloData={}", helloData); 

        return "ok";
    }
}
```

### v2 - @ModelAttribute ìƒëµ
`RequestParamController`
```java
@Slf4j
@Controller
public class RequestParamController {

    @ResponseBody
    @RequestMapping("/model-attribute-v2")
    public String modelAttributeV2(HelloData helloData){

        log.info("username={}, age={}", helloData.getUsername(), helloData.getAge());

        return "ok";
    }
}
```
`@ModelAttribute`ëŠ” ìƒëµí•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ°ë° `@RequestParam`ë„ ìƒëµí•  ìˆ˜ ìˆìœ¼ë‹ˆ í˜¼ë€ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.<br>
ìŠ¤í”„ë§ì€ í•´ë‹¹ ìƒëµ ì‹œ ë‹¤ìŒê³¼ ê°™ì€ ê·œì§ì„ ì ìš©í•œë‹¤.
- `String`, `int`, `Integer` ê°™ì€ ë‹¨ìˆœ íƒ€ì… -> `@RequestParam`
- ë‚˜ë¨¸ì§€ -> `@ModelAttribute` (argument resolverë¡œ ì§€ì •í•´ë‘” íƒ€ì… ì™¸)

> ì°¸ê³ <br>
argument resolverëŠ” ë’¤ì—ì„œ í•™ìŠµí•œë‹¤.


## ğŸŒ¸ HTTP ìš”ì²­ ë©”ì‹œì§€ (message body) ì¡°íšŒ - ë‹¨ìˆœ í…ìŠ¤íŠ¸
ìš”ì²­ íŒŒë¼ë¯¸í„°ì™€ ë‹¤ë¥´ê²Œ, HTTP ë©”ì‹œì§€ ë°”ë””ë¥¼ í†µí•´ ë°ì´í„°ê°€ ì§ì ‘ ë„˜ì–´ì˜¤ëŠ” ê²½ìš°ëŠ” `@RequestParam`, `@ModelAttribute`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. (ë¬¼ë¡  HTML Form í˜•ì‹ìœ¼ë¡œ ì „ë‹¬ë˜ëŠ” ê²½ìš°ëŠ” ìš”ì²­ íŒŒë¼ë¯¸í„°ë¡œ ì¸ì •ëœë‹¤.)<br>
ë¨¼ì € ê°€ì¥ ë‹¨ìˆœí•œ í…ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ HTTP ë©”ì‹œì§€ ë°”ë””ì— ë‹´ì•„ì„œ ì „ì†¡í•˜ê³ , ì½ì–´ë³´ì.

### v1 - ServletInputStream
`RequestBodyStringController`
```java
@Slf4j
@Controller
public class RequestBodyStringController {

    @PostMapping("/request-body-string-v1")
    public void requestBodyString(HttpServletRequest req, HttpServletResponse res) throws IOException {

        ServletInputStream inputStream = req.getInputStream();
        String meessageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);

        log.info("messageBody={}", meessageBody);

        res.getWriter().write("ok");
    }
}
```
HTTP ë©”ì‹œì§€ ë°”ë””ì˜ ë°ì´í„°ë¥¼ `InputStram`ì„ ì‚¬ìš©í•´ì„œ ì§ì ‘ ì½ì„ ìˆ˜ ìˆë‹¤.

### v2 - InputStream, Writer
`RequestBodyStringController`
```java
@Slf4j
@Controller
public class RequestBodyStringController {

    @PostMapping("/request-body-string-v2")
    public void requestBodyStringV2(InputStream inputStream, Writer responseWriter) throws IOException {

        String meessageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);

        log.info("messageBody={}", meessageBody);

        responseWriter.write("ok");
    }
}
```
ìŠ¤í”„ë§ MVCëŠ” ë‹¤ìŒ íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì›í•œë‹¤.
- InputStream(Reader): HTTP ìš”ì²­ ë©”ì‹œì§€ ë°”ë””ì˜ ë‚´ìš©ì„ ì§ì ‘ ì¡°íšŒ
- OutputStream(Writer): HTTP ì‘ë‹µ ë©”ì‹œì§€ì˜ ë°”ë””ì— ì§ì ‘ ê²°ê³¼ ì¶œë ¥

### v3 - HttpEntity
`RequestBodyStringController`
```java
@Slf4j
@Controller
public class RequestBodyStringController {

    @PostMapping("/request-body-string-v3")
    public HttpEntity<String> requestBodyStringV3(HttpEntity<String> httpEntity) throws IOException {

        String messageBody = httpEntity.getBody();

        log.info("messageBody={}", messageBody);

        return new HttpEntity<>("ok"); // ì‘ë‹µì—ë„ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
    }
}
```
ìŠ¤í”„ë§ MVCëŠ” ë‹¤ìŒ íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì›í•œë‹¤.
- HttpEntity: HTTP header, body ì •ë³´ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒ<br>- ë©”ì‹œì§€ ë°”ë”” ì •ë³´ë¥¼ ì§ì ‘ ì¡°íšŒ<br>- ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ê³¼ ê´€ê³„ ì—†ìŒ `@RequestParam` X, `@ModelAttribute` X 
- HttpEntityëŠ” ì‘ë‹µì—ë„ ì‚¬ìš© ê°€ëŠ¥<br>- ë©”ì‹œì§€ ë°”ë”” ì •ë³´ ì§ì ‘ ë°˜í™˜<br>- í—¤ë” ì •ë³´ í¬í•¨ ê°€ëŠ¥<br>- view ì¡°íšŒX

<br>

> ì°¸ê³ <br>
`HttpEntity`ë¥¼ ìƒì†ë°›ì€ ë‹¤ìŒ ê°ì²´ë“¤ë„ ê°™ì€ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.
- RequestEntity: HttpMethod, url ì •ë³´ê°€ ì¶”ê°€, ìš”ì²­ì—ì„œ ì‚¬ìš©
- ResponseEntity: HTTP ìƒíƒœ ì½”ë“œ ì„¤ì • ê°€ëŠ¥, ì‘ë‹µì—ì„œ ì‚¬ìš© 

```java
@Slf4j
@Controller
public class RequestBodyStringController {

    @PostMapping("/request-body-string-v3")
    public HttpEntity<String> requestBodyStringV3(RequestEntity<String> httpEntity) throws IOException {

        String messageBody = httpEntity.getBody();

        log.info("messageBody={}", messageBody);

        return new ResponseEntity<String>("ok", HttpStatus.CREATED); // ìƒíƒœì½”ë“œë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤.
    }
}
```

> ì°¸ê³ <br>
ìŠ¤í”„ë§MVC ë‚´ë¶€ì—ì„œ HTTP ë©”ì‹œì§€ ë°”ë””ë¥¼ ì½ì–´ì„œ ë¬¸ìë‚˜ ê°ì²´ë¡œ ë³€í™˜í•´ì„œ ì „ë‹¬í•´ì£¼ëŠ”ë°, ì´ë•Œ HTTP ë©”ì‹œì§€ ì»¨ë²„í„°(HttpMessageConverter)ë¼ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤.<br>
ì´ê²ƒì€ ì¡°ê¸ˆ ë’¤ì— HTTP ë©”ì‹œì§€ ì»¨ë²„í„°ì—ì„œ ìì„¸íˆ ì„¤ëª…í•œë‹¤.

### v4 - @RequestBody, @ResponseBody ğŸŒŸ
`RequestBodyStringController`
```java
@Slf4j
@Controller
public class RequestBodyStringController {

    @ResponseBody
    @PostMapping("/request-body-string-v4")
    public String requestBodyStringV4(@RequestBody String messageBody) throws IOException {

        log.info("messageBody={}", messageBody);

        return "ok";
    }
}
```
ì‹¤ë¬´ì—ì„œ ì •ë§ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ë‹¤.

- @RequestBody<br>
`@RequestBody`ë¥¼ ì‚¬ìš©í•˜ë©´ HTTP ë©”ì‹œì§€ ë°”ë”” ì •ë³´ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤. ì°¸ê³ ë¡œ í—¤ë” ì •ë³´ê°€ í•„ìš”í•˜ë‹¤ë©´ HttpEntity ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ `@RequestHeader` ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.<br>
ì´ë ‡ê²Œ ë©”ì‹œì§€ ë°”ë””ë¥¼ ì§ì ‘ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ì€ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°íšŒí•˜ëŠ” `@RequestParam`, `@ModelAttribute` ì™€ëŠ” ì „í˜€ ê´€ê³„ê°€ ì—†ë‹¤.

- @ResponseBody<br>
`@ResponseBody`ë¥¼ ì‚¬ìš©í•˜ë©´ ì‘ë‹µ ê²°ê³¼ë¥¼ HTTP ë©”ì‹œì§€ ë°”ë””ì— ì§ì ‘ ë‹´ì•„ì„œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤. ë¬¼ë¡  ì´ ê²½ìš°ì—ë„ viewë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

## ğŸ¤” ìš”ì²­ íŒŒë¼ë¯¸í„° vs HTTP ë©”ì‹œì§€ ë°”ë””
- ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥: `@RequestParam`, `@ModelAttribute`
- HTTP ë©”ì‹œì§€ ë°”ë””ë¥¼ ì§ì ‘ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥: `@RequestBody`



## ğŸŒ¸ [ìŠ¤í”„ë§] HTTP ìš”ì²­ ë©”ì‹œì§€ (message body) ì¡°íšŒ - JSON
ì´ë²ˆì—ëŠ” HTTP APIì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” JSON ë°ì´í„° í˜•ì‹ì„ ì¡°íšŒí•´ë³´ì.<br>
ê¸°ì¡´ ì„œë¸”ë¦¿ì—ì„œ ì‚¬ìš©í–ˆë˜ ë°©ì‹ê³¼ ë¹„ìŠ·í•˜ê²Œ ì‹œì‘í•´ë³´ì.

### v1 - HttpServletRequest
`RequestBodyJsonController`
```java
@Slf4j
@Controller
public class RequestBodyJsonController {

    private ObjectMapper objectMapper = new ObjectMapper();

    @PostMapping("/request-body-json-v1")
    public void requestBodyJsonV1(HttpServletRequest req, HttpServletResponse res) throws IOException {

        ServletInputStream inputStream = req.getInputStream();
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);

        log.info("messageBody={}", messageBody);
        HelloData helloData = objectMapper.readValue(messageBody, HelloData.class);
        log.info("username={}, age={}", helloData.getUsername(), helloData.getAge());

        res.getWriter().write("ok");
    }
}
```
- `HttpServletRequest`ë¥¼ ì‚¬ìš©í•´ì„œ ì§ì ‘ HTTP ë©”ì‹œì§€ ë°”ë””ì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ì™€ì„œ, ë¬¸ìë¡œ ë³€í™˜í•œë‹¤. 
- ë¬¸ìë¡œ ëœ JSON ë°ì´í„°ë¥¼ Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ `objectMapper`ë¥¼ ì‚¬ìš©í•´ì„œ ìë°” ê°ì²´ë¡œ ë³€í™˜í•œë‹¤.

### v2 - @RequestBody ë¬¸ì ë³€í™˜
`RequestBodyJsonController`
```java
@Slf4j
@Controller
public class RequestBodyJsonController {

    private ObjectMapper objectMapper = new ObjectMapper();

    @ResponseBody
    @PostMapping("/request-body-json-v2")
    public String requestBodyJsonV2(@RequestBody String messageBody) throws IOException {

        log.info("messageBody={}", messageBody);
        HelloData helloData = objectMapper.readValue(messageBody, HelloData.class);
        log.info("username={}, age={}", helloData.getUsername(), helloData.getAge());

        return "ok";
    }
}
```
- ì´ì „ì— í•™ìŠµí–ˆë˜ `@RequestBody`ë¥¼ ì‚¬ìš©í•´ì„œ HTTP ë©”ì‹œì§€ì—ì„œ ë°ì´í„°ë¥¼ êº¼ë‚´ê³  `messageBody`ì— ì €ì¥í•œë‹¤.
- ë¬¸ìë¡œ ëœ JSON ë°ì´í„°ì¸ `messageBody`ë¥¼ `objectMapper`ë¥¼ í†µí•´ì„œ ìë°” ê°ì²´ë¡œ ë³€í™˜í•œë‹¤.
- ë¬¸ìë¡œ ë³€í™˜í•˜ê³  ë‹¤ì‹œ jsonìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ì´ ë¶ˆí¸í•˜ë‹¤. `@ModelAttribute`ì²˜ëŸ¼ í•œë²ˆì— ê°ì²´ë¡œ ë³€í™˜í•  ìˆ˜ëŠ” ì—†ì„ê¹Œ?

### v3 - @RequestBody ê°ì²´ ë³€í™˜
`RequestBodyJsonController`
```java
@Slf4j
@Controller
public class RequestBodyJsonController {

    @ResponseBody
    @PostMapping("/request-body-json-v3")
    public String requestBodyJsonV3(@RequestBody HelloData data) {

        log.info("username={}, age={}", data.getUsername(), data.getAge());

        return "ok";
    }
}
```
- `@RequestBody `ê°ì²´ íŒŒë¼ë¯¸í„°<br>- `@RequestBody HelloData data`<br>- `@RequestBody`ì— ì§ì ‘ ë§Œë“  ê°ì²´ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

#### `@RequestBody`ëŠ” ìƒëµ ë¶ˆê°€ëŠ¥
`@ModelAttribute`ì—ì„œ í•™ìŠµí•œ ë‚´ìš©ì„ ë– ì˜¬ë ¤ë³´ì.<br>
ìŠ¤í”„ë§ì€ `@ModelAttribute`, `@RequestParam`ê³¼ ê°™ì€ í•´ë‹¹ ì• ë…¸í…Œì´ì…˜ì„ ìƒëµì‹œ ë‹¤ìŒê³¼ ê°™ì€ ê·œì¹™ì„ ì ìš©í•œë‹¤.
- String, int, Integer ê°™ì€ ë‹¨ìˆœ íƒ€ì… -> `@RequestParam`ì´ ìë™ìœ¼ë¡œ ì ìš©ëœë‹¤.
- ë‚˜ë¨¸ì§€ -> `@ModelAttribute`ì´ ìë™ìœ¼ë¡œ ì ìš©ëœë‹¤. (argument resolver ë¡œ ì§€ì •í•´ë‘” íƒ€ì… ì™¸)

ë”°ë¼ì„œ ì´ ê²½ìš° HelloDataì— `@RequestBody`ë¥¼ ìƒëµí•˜ë©´ `@ModelAttribute`ê°€ ì ìš©ë˜ì–´ë²„ë¦°ë‹¤.<br>
`HelloData data` -> `@ModelAttribute HelloData data`<br>
ë”°ë¼ì„œ ìƒëµí•˜ë©´ HTTP ë©”ì‹œì§€ ë°”ë””ê°€ ì•„ë‹ˆë¼ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì²˜ë¦¬í•˜ê²Œ ëœë‹¤.


> ì£¼ì˜<br>
HTTP ìš”ì²­ì‹œì— content-typeì´ application/jsonì¸ì§€ ê¼­! í™•ì¸í•´ì•¼ í•œë‹¤. ê·¸ë˜ì•¼ JSONì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” HTTP ë©”ì‹œì§€ ì»¨ë²„í„°ê°€ ì‹¤í–‰ëœë‹¤.

### v4 - HttpEntity
`RequestBodyJsonController`
```java
@Slf4j
@Controller
public class RequestBodyJsonController {

    @ResponseBody
    @PostMapping("/request-body-json-v4")
    public String requestBodyJsonV4(HttpEntity<HelloData> httpEntity) {

        HelloData data = httpEntity.getBody();
        log.info("username={}, age={}", data.getUsername(), data.getAge());

        return "ok";
    }
}
```
ë¬¼ë¡  ì•ì„œ ë°°ìš´ ê²ƒê³¼ ê°™ì´ HttpEntityë¥¼ ì‚¬ìš©í•´ë„ ëœë‹¤.

### v5 - @RequestBody ê°ì²´ë¥¼ ë©”ì‹œì§€ ë°”ë””ì— ì§ì ‘ ë„£ê¸°
`RequestBodyJsonController`
```java
@Slf4j
@Controller
public class RequestBodyJsonController {

    @ResponseBody
    @PostMapping("/request-body-json-v5")
    public HelloData requestBodyJsonV5(@RequestBody HelloData data) { // ë¦¬í„´ íƒ€ì…ì´ HelloData ê°ì²´!

        log.info("username={}, age={}", data.getUsername(), data.getAge());

        return data;
    }
}
```
- @ResponseBody<br>
ì‘ë‹µì˜ ê²½ìš°ì—ë„ `@ResponseBody`ë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ê°ì²´ë¥¼ HTTP ë©”ì‹œì§€ ë°”ë””ì— ì§ì ‘ ë„£ì–´ì¤„ ìˆ˜ ìˆë‹¤.<br>
ë¬¼ë¡  ì´ ê²½ìš°ì—ë„ HttpEntity ë¥¼ ì‚¬ìš©í•´ë„ ëœë‹¤.

- v5 ì •ë¦¬<br>
`@RequestBody` ìš”ì²­<br>- JSON ìš”ì²­ -> HTTP ë©”ì‹œì§€ ì»¨ë²„í„° -> ê°ì²´<br>
`@ResponseBody` ì‘ë‹µ<br>- ê°ì²´ -> HTTP ë©”ì‹œì§€ ì»¨ë²„í„° -> JSON ì‘ë‹µ


***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}