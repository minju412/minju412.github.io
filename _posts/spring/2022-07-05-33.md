---
title:  "[SPRING] ë¡œê·¸ì¸ ì²˜ë¦¬ - 1. ì¿ í‚¤, ì„¸ì…˜ "

categories:
  - Spring
tags:
  - [Framework, Spring, Java]

toc: true
toc_sticky: true
 
date: 2022-07-05 16:30:54
last_modified_at: 2022-07-05 16:30:58
---
ì´ì „ í”„ë¡œì íŠ¸ì— ì´ì–´ì„œ ë¡œê·¸ì¸ ì²˜ë¦¬ ê¸°ëŠ¥ì„ í•™ìŠµí•œë‹¤.
# ğŸ” package êµ¬ì¡°
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-05 á„‹á…©á„’á…® 4 56 36](https://user-images.githubusercontent.com/59405576/177278866-30b0c82a-f5e0-47bf-abe2-0b5dde129091.png)<br>
ë„ë©”ì¸ì´ ê°€ì¥ ì¤‘ìš”í•˜ë‹¤.<br>
ë„ë©”ì¸ = í™”ë©´, UI, ê¸°ìˆ  ì¸í”„ë¼ ë“±ë“±ì˜ ì˜ì—­ì€ ì œì™¸í•œ ì‹œìŠ¤í…œì´ êµ¬í˜„í•´ì•¼ í•˜ëŠ” í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ì—…ë¬´ ì˜ì—­ì„ ë§í•¨<br><br>
í–¥í›„ webì„ ë‹¤ë¥¸ ê¸°ìˆ ë¡œ ë°”ê¾¸ì–´ë„ ë„ë©”ì¸ì€ ê·¸ëŒ€ë¡œ ìœ ì§€í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.<br>
ì´ë ‡ê²Œ í•˜ë ¤ë©´ webì€ domainì„ ì•Œê³ ìˆì§€ë§Œ domainì€ webì„ ëª¨ë¥´ë„ë¡ ì„¤ê³„í•´ì•¼ í•œë‹¤. <br>
ğŸ“ ì´ê²ƒì„ webì€ domainì„ ì˜ì¡´í•˜ì§€ë§Œ, domainì€ webì„ ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í‘œí˜„í•œë‹¤. <br><br>
ì˜ˆë¥¼ ë“¤ì–´ web íŒ¨í‚¤ì§€ë¥¼ ëª¨ë‘ ì‚­ì œí•´ë„ domainì—ëŠ” ì „í˜€ ì˜í–¥ì´ ì—†ë„ë¡ ì˜ì¡´ê´€ê³„ë¥¼ ì„¤ê³„í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤. ğŸŒŸ <br>
ë°˜ëŒ€ë¡œ ì´ì•¼ê¸°í•˜ë©´ domainì€ webì„ ì°¸ì¡°í•˜ë©´ ì•ˆëœë‹¤.

# ğŸ” íšŒì› ê°€ì…
## ğŸ—‚ domain
### `Member`
`src/main/java/hello/login/domain/member/Member.java`
```java
@Data
public class Member {

    private Long id;

    @NotEmpty
    private String loginId; // ë¡œê·¸ì¸ ID
    @NotEmpty
    private String name;
    @NotEmpty
    private String password;
}
```

### `MemberRepository`
`src/main/java/hello/login/domain/member/MemberRepository.java`
```java
@Slf4j
@Repository
public class MemberRepository {

    private static Map<Long, Member> store = new HashMap<>(); // static ì‚¬ìš©
    private static long sequence = 0L; // static ì‚¬ìš©

    public Member save(Member member){
        member.setId(++sequence);
        log.info("save: member={}", member);
        store.put(member.getId(), member);
        return member;
    }

    public Member findById(Long id){
        return store.get(id);
    }

    public Optional<Member> findByLoginId(String loginId){
        return findAll().stream()
                .filter(m -> m.getLoginId().equals(loginId))
                .findFirst();
    }

    public List<Member> findAll(){
        return new ArrayList<>(store.values());
    }

    public void clearStore(){
        store.clear();
    }
}
```

## ğŸ—‚ web
### `MemberController`
`src/main/java/hello/login/web/member/MemberController.java`
```java
@Controller
@RequiredArgsConstructor
@RequestMapping("/members")
public class MemberController {

    private final MemberRepository memberRepository;

    @GetMapping("/add")
    public String addForm(@ModelAttribute("member") Member member){
        return "members/addMemberForm";
    }

    @PostMapping("/add")
    public String save(@Valid @ModelAttribute Member member, BindingResult bindingResult){
        if(bindingResult.hasErrors()){
            return "members/addMemberForm";
        }

        memberRepository.save(member);
        return "redirect:/";
    }
}
```
`@ModelAttribute("member")` ë¥¼ `@ModelAttribute` ë¡œ ë³€ê²½í•´ë„ ê²°ê³¼ëŠ” ê°™ë‹¤. ì—¬ê¸°ì„œëŠ” IDEì—ì„œ ì¸ì‹ ë¬¸ì œê°€ ìˆì–´ì„œ ì ìš©í–ˆë‹¤.

## ğŸ—‚ ë·° í…œí”Œë¦¿ 
### `addMemberForm`
`src/main/resources/templates/members/addMemberForm.html`
```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link th:href="@{/css/bootstrap.min.css}"
          href="../css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container {
            max-width: 560px;
        }
        .field-error {
            border-color: #dc3545;
            color: #dc3545;
        }
    </style>
</head>
<body>

<div class="container">

    <div class="py-5 text-center">
        <h2>íšŒì› ê°€ì…</h2>
    </div>

    <h4 class="mb-3">íšŒì› ì •ë³´ ì…ë ¥</h4>

    <form action="" th:action th:object="${member}" method="post">

        <div th:if="${#fields.hasGlobalErrors()}">
            <p class="field-error" th:each="err : ${#fields.globalErrors()}" th:text="${err}">ì „ì²´ ì˜¤ë¥˜ ë©”ì‹œì§€</p>
        </div>

        <div>
            <label for="loginId">ë¡œê·¸ì¸ ID</label>
            <input type="text" id="loginId" th:field="*{loginId}" class="form-control"
                   th:errorclass="field-error">
            <div class="field-error" th:errors="*{loginId}" />
        </div>
        <div>
            <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="password" th:field="*{password}" class="form-control"
                   th:errorclass="field-error">
            <div class="field-error" th:errors="*{password}" />
        </div>
        <div>
            <label for="name">ì´ë¦„</label>
            <input type="text" id="name" th:field="*{name}" class="form-control"
                   th:errorclass="field-error">
            <div class="field-error" th:errors="*{name}" />
        </div>


        <hr class="my-4">

        <div class="row">
            <div class="col">
                <button class="w-100 btn btn-primary btn-lg" type="submit">íšŒì› ê°€ì…</button>
            </div>
            <div class="col">
                <button class="w-100 btn btn-secondary btn-lg" onclick="location.href='items.html'"
                        th:onclick="|location.href='@{/}'|"
                        type="button">ì·¨ì†Œ</button>
            </div>
        </div>

    </form>

</div> <!-- /container -->
</body>
</html>
```

# ğŸ” ë¡œê·¸ì¸ ê¸°ëŠ¥
## ğŸ—‚ domain
### `LoginService`
`src/main/java/hello/login/domain/login/LoginService.java`
```java
@Service
@RequiredArgsConstructor
public class LoginService {

    private final MemberRepository memberRepository;

    /**
     * @return null ì´ë©´ ë¡œê·¸ì¸ ì‹¤íŒ¨
     */
    public Member login(String loginId, String password){
        return memberRepository.findByLoginId(loginId)
                .filter(m -> m.getPassword().equals(password))
                .orElse(null);
    }
}
```
`LoginService`ëŠ” ë¡œê·¸ì¸ì˜ í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ë‹¤. <br>
íšŒì›ì„ ì¡°íšŒí•œ ë‹¤ìŒì— íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ passwordì™€ ë¹„êµí•´ì„œ ê°™ìœ¼ë©´ íšŒì›ì„ ë°˜í™˜í•˜ê³ , ë§Œì•½ passwordê°€ ë‹¤ë¥´ë©´ `null` ì„ ë°˜í™˜í•œë‹¤.

## ğŸ—‚ web
### `LoginForm`
`src/main/java/hello/login/web/login/LoginForm.java`
```java
@Data
public class LoginForm {

    @NotEmpty
    private String loginId;

    @NotEmpty
    private String password;
}
```

### `LoginController`
`src/main/java/hello/login/web/login/LoginController.java`
```java
@Slf4j
@Controller
@RequiredArgsConstructor
public class LoginController {

    private final LoginService loginService;

    @GetMapping("/login")
    public String loginForm(@ModelAttribute("loginForm") LoginForm form) {
        return "login/loginForm";
    }

    @PostMapping("/login")
    public String login(@Valid @ModelAttribute LoginForm form, BindingResult bindingResult){
        if(bindingResult.hasErrors()){
            return "login/loginForm";
        }

        Member loginMember = loginService.login(form.getLoginId(), form.getPassword());

        if(loginMember==null){
            bindingResult.reject("loginFail", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            return "login/loginForm";
        }

        // ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬ TODO

        return "redirect:/";
    }
}
```
ë¡œê·¸ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë¡œê·¸ì¸ ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•´ì„œ ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ í™ˆ í™”ë©´ìœ¼ë¡œ ì´ë™í•˜ê³ , ë¡œê·¸ì¸ì— ì‹¤íŒ¨í•˜ë©´ `bindingResult.reject()` ë¥¼ ì‚¬ìš©í•´ì„œ ê¸€ë¡œë²Œ ì˜¤ë¥˜( `ObjectError` )ë¥¼ ìƒì„±í•œë‹¤. <br>
ê·¸ë¦¬ê³  ì •ë³´ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ë„ë¡ ë¡œê·¸ì¸ í¼ì„ ë·° í…œí”Œë¦¿ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.



## ğŸ—‚ ë·° í…œí”Œë¦¿ 
### `loginForm`
`src/main/resources/templates/login/loginForm.html`
```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link th:href="@{/css/bootstrap.min.css}"
          href="../css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container {
            max-width: 560px;
        }
        .field-error {
            border-color: #dc3545;
            color: #dc3545;
        }
    </style>
</head>
<body>

<div class="container">

    <div class="py-5 text-center">
        <h2>ë¡œê·¸ì¸</h2>
    </div>

    <form action="item.html" th:action th:object="${loginForm}" method="post">

        <div th:if="${#fields.hasGlobalErrors()}">
            <p class="field-error" th:each="err : ${#fields.globalErrors()}" th:text="${err}">ì „ì²´ ì˜¤ë¥˜ ë©”ì‹œì§€</p>
        </div>

        <div>
            <label for="loginId">ë¡œê·¸ì¸ ID</label>
            <input type="text" id="loginId" th:field="*{loginId}" class="form-control"
                   th:errorclass="field-error">
            <div class="field-error" th:errors="*{loginId}" />
        </div>
        <div>
            <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="password" th:field="*{password}" class="form-control"
                   th:errorclass="field-error">
            <div class="field-error" th:errors="*{password}" />
        </div>

        <hr class="my-4">

        <div class="row">
            <div class="col">
                <button class="w-100 btn btn-primary btn-lg" type="submit">ë¡œê·¸ì¸</button>
            </div>
            <div class="col">
                <button class="w-100 btn btn-secondary btn-lg" onclick="location.href='items.html'"
                        th:onclick="|location.href='@{/}'|"
                        type="button">ì·¨ì†Œ</button>
            </div>
        </div>

    </form>

</div> <!-- /container -->
</body>
</html>
```
ë¡œê·¸ì¸ í¼ ë·° í…œí”Œë¦¿ì—ëŠ” íŠ¹ë³„í•œ ì½”ë“œëŠ” ì—†ë‹¤. `loginId` , `password` ê°€ í‹€ë¦¬ë©´ ê¸€ë¡œë²Œ ì˜¤ë¥˜ê°€ ë‚˜íƒ€ë‚œë‹¤.<br><br>
ê·¸ëŸ°ë° ì•„ì§ ë¡œê·¸ì¸ì´ ë˜ë©´ í™ˆ í™”ë©´ì— ê³ ê° ì´ë¦„ì´ ë³´ì—¬ì•¼ í•œë‹¤ëŠ” ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ì§€ ëª»í•œë‹¤. <br>
ë¡œê·¸ì¸ì˜ ìƒíƒœë¥¼ ìœ ì§€í•˜ë©´ì„œ, ë¡œê·¸ì¸ì— ì„±ê³µí•œ ì‚¬ìš©ìëŠ” í™ˆ í™”ë©´ì— ì ‘ê·¼ì‹œ ê³ ê°ì˜ ì´ë¦„ì„ ë³´ì—¬ì£¼ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?

# ğŸ” ë¡œê·¸ì¸ ì²˜ë¦¬í•˜ê¸° 
## 1. ì¿ í‚¤
ì¿ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ì„ êµ¬í˜„í•´ë³´ì.<br>
ì„œë²„ì—ì„œ ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ HTTP ì‘ë‹µì— ì¿ í‚¤ë¥¼ ë‹´ì•„ì„œ ë¸Œë¼ìš°ì €ì— ì „ë‹¬í•˜ì. <br>
ê·¸ëŸ¬ë©´ ë¸Œë¼ìš°ì €ëŠ” ì•ìœ¼ë¡œ í•´ë‹¹ ì¿ í‚¤ë¥¼ ì§€ì†í•´ì„œ ë³´ë‚´ì¤€ë‹¤.<br><br>
ì¿ í‚¤ì—ëŠ” ì˜ì† ì¿ í‚¤ì™€ ì„¸ì…˜ ì¿ í‚¤ê°€ ìˆë‹¤.
- ì˜ì† ì¿ í‚¤: ë§Œë£Œ ë‚ ì§œë¥¼ ì…ë ¥í•˜ë©´ í•´ë‹¹ ë‚ ì§œê¹Œì§€ ìœ ì§€
- ì„¸ì…˜ ì¿ í‚¤: ë§Œë£Œ ë‚ ì§œë¥¼ ìƒëµí•˜ë©´ ë¸Œë¼ìš°ì € ì¢…ë£Œì‹œ ê¹Œì§€ë§Œ ìœ ì§€

ë¸Œë¼ìš°ì € ì¢…ë£Œì‹œ ë¡œê·¸ì•„ì›ƒì´ ë˜ê¸¸ ê¸°ëŒ€í•˜ë¯€ë¡œ, ìš°ë¦¬ì—ê²Œ í•„ìš”í•œ ê²ƒì€ ì„¸ì…˜ ì¿ í‚¤ì´ë‹¤.

### ë¡œê·¸ì¸ ê¸°ëŠ¥

#### ğŸ—‚ web
##### `LoginController`
###### `login()`
`src/main/java/hello/login/web/login/LoginController.java`
```java
@Slf4j
@Controller
@RequiredArgsConstructor
public class LoginController {

    private final LoginService loginService;

    @PostMapping("/login")
    public String login(@Valid @ModelAttribute LoginForm form, BindingResult bindingResult, HttpServletResponse res){
        if(bindingResult.hasErrors()){
            return "login/loginForm";
        }

        Member loginMember = loginService.login(form.getLoginId(), form.getPassword());

        if(loginMember==null){
            bindingResult.reject("loginFail", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            return "login/loginForm";
        }

        // ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬
        // ğŸŒŸ ì¿ í‚¤ì— ì‹œê°„ ì •ë³´ë¥¼ ì£¼ì§€ ì•Šìœ¼ë©´ ì„¸ì…˜ ì¿ í‚¤ (ë¸Œë¼ìš°ì € ì¢…ë£Œ ì‹œ ëª¨ë‘ ì¢…ë£Œ)
        Cookie idCookie = new Cookie("memberId", String.valueOf(loginMember.getId()));
        res.addCookie(idCookie);

        return "redirect:/";
    }
}
```

###### ì¿ í‚¤ ìƒì„± ë¡œì§
```java
Cookie idCookie = new Cookie("memberId", String.valueOf(loginMember.getId()));
res.addCookie(idCookie);
```
ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ ì¿ í‚¤ë¥¼ ìƒì„±í•˜ê³  `HttpServletResponse` ì— ë‹´ëŠ”ë‹¤. <br>
ì¿ í‚¤ ì´ë¦„ì€ `memberId` ì´ê³ , ê°’ì€ íšŒì›ì˜ `id`ë¥¼ ë‹´ì•„ë‘”ë‹¤.<br>
ì›¹ë¸Œë¼ìš°ì €ëŠ” ì¢…ë£Œ ì „ê¹Œì§€ íšŒì›ì˜ `id`ë¥¼ ì„œë²„ì— ê³„ì† ë³´ë‚´ì¤„ ê²ƒì´ë‹¤.

##### `HomeController` - ë¡œê·¸ì¸ ì²˜ë¦¬
ì´ì œ ìš”êµ¬ì‚¬í•­ì— ë§ì¶”ì–´ ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ ë¡œê·¸ì¸ í•œ ì‚¬ìš©ì ì „ìš© í™ˆ í™”ë©´ì„ ë³´ì—¬ì£¼ì.<br>
`src/main/java/hello/login/web/HomeController.java`
```java
@Slf4j
@Controller
@RequiredArgsConstructor
public class HomeController {

    private final MemberRepository memberRepository;

    @GetMapping("/")
    public String homeLogin(@CookieValue(name = "memberId", required = false) Long memberId, Model model){

        if(memberId == null){
            return "home";
        }

        // ë¡œê·¸ì¸
        Member loginMember = memberRepository.findById(memberId);
        if(loginMember == null){
            return "home";
        }

        model.addAttribute("member", loginMember);
        return "loginHome";
    }
}
```
- `@CookieValue` ë¥¼ ì‚¬ìš©í•˜ë©´ í¸ë¦¬í•˜ê²Œ ì¿ í‚¤ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ì‚¬ìš©ìë„ í™ˆì— ì ‘ê·¼í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— `required = false` ë¥¼ ì‚¬ìš©í•œë‹¤.

ë¡œì§ ë¶„ì„
- ë¡œê·¸ì¸ ì¿ í‚¤( `memberId` )ê°€ ì—†ëŠ” ì‚¬ìš©ìëŠ” ê¸°ì¡´ home ìœ¼ë¡œ ë³´ë‚¸ë‹¤. ì¶”ê°€ë¡œ ë¡œê·¸ì¸ ì¿ í‚¤ê°€ ìˆì–´ë„ íšŒì›ì´ ì—†ìœ¼ë©´ `home` ìœ¼ë¡œ ë³´ë‚¸ë‹¤.
- ë¡œê·¸ì¸ ì¿ í‚¤( `memberId` )ê°€ ìˆëŠ” ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ ì‚¬ìš©ì ì „ìš© í™ˆ í™”ë©´ì¸ `loginHome` ìœ¼ë¡œ ë³´ë‚¸ë‹¤. ì¶”ê°€ë¡œ í™ˆ í™”ë©´ì— í™”ì› ê´€ë ¨ ì •ë³´ë„ ì¶œë ¥í•´ì•¼ í•´ì„œ `member` ë°ì´í„°ë„ ëª¨ë¸ì— ë‹´ì•„ì„œ ì „ë‹¬í•œë‹¤.

#### ğŸ—‚ ë·° í…œí”Œë¦¿
##### `loginHome` - ë¡œê·¸ì¸ ì‚¬ìš©ì ì „ìš©
`src/main/resources/templates/loginHome.html`
```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link th:href="@{/css/bootstrap.min.css}"
          href="../css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container" style="max-width: 600px">
    <div class="py-5 text-center">
        <h2>í™ˆ í™”ë©´</h2>
    </div>

    <h4 class="mb-3" th:text="|ë¡œê·¸ì¸: ${member.name}|">ë¡œê·¸ì¸ ì‚¬ìš©ì ì´ë¦„</h4>

    <hr class="my-4">

    <div class="row">
        <div class="col">
            <button class="w-100 btn btn-secondary btn-lg" type="button"
                    th:onclick="|location.href='@{/items}'|">
                ìƒí’ˆ ê´€ë¦¬
            </button>
        </div>
        <div class="col">
            <form th:action="@{/logout}" method="post">
                <button class="w-100 btn btn-dark btn-lg" onclick="location.href='items.html'" type="submit">
                    ë¡œê·¸ì•„ì›ƒ
                </button>
            </form>
        </div>
    </div>

    <hr class="my-4">

</div> <!-- /container -->

</body>
</html>
```
- `th:text="|ë¡œê·¸ì¸: ${member.name}|"` : ë¡œê·¸ì¸ì— ì„±ê³µí•œ ì‚¬ìš©ì ì´ë¦„ì„ ì¶œë ¥í•œë‹¤. 
- ìƒí’ˆ ê´€ë¦¬, ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì„ ë…¸ì¶œí•œë‹¤.

### ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥
ì´ë²ˆì—ëŠ” ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ì„ ë§Œë“¤ì–´ë³´ì. ë¡œê·¸ì•„ì›ƒ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. 
- ì„¸ì…˜ ì¿ í‚¤ì´ë¯€ë¡œ ì›¹ ë¸Œë¼ìš°ì € ì¢…ë£Œì‹œ
- ì„œë²„ì—ì„œ í•´ë‹¹ ì¿ í‚¤ì˜ ì¢…ë£Œ ë‚ ì§œë¥¼ 0ìœ¼ë¡œ ì§€ì •

#### ğŸ—‚ web
##### `LoginController`
###### `logout()`
`src/main/java/hello/login/web/login/LoginController.java`
```java
@Slf4j
@Controller
@RequiredArgsConstructor
public class LoginController {
    ...
    @PostMapping("/logout")
    public String logout(HttpServletResponse res){
        expireCookie(res, "memberId");
        return "redirect:/";
    }

    private void expireCookie(HttpServletResponse res, String cookieName) {
        Cookie cookie = new Cookie(cookieName, null);
        cookie.setMaxAge(0);
        res.addCookie(cookie);
    }
}
```
ë¡œê·¸ì•„ì›ƒë„ ì‘ë‹µ ì¿ í‚¤ë¥¼ ìƒì„±í•˜ëŠ”ë° `Max-Age=0` ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ ì¿ í‚¤ëŠ” ì¦‰ì‹œ ì¢…ë£Œëœë‹¤.

### ì¿ í‚¤ì™€ ë³´ì•ˆ ë¬¸ì œ
ì¿ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ ë¡œê·¸ì¸Idë¥¼ ì „ë‹¬í•´ì„œ ë¡œê·¸ì¸ì„ ìœ ì§€í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ëŸ°ë° ì—¬ê¸°ì—ëŠ” ì‹¬ê°í•œ ë³´ì•ˆ ë¬¸ì œê°€ ìˆë‹¤.

#### ë³´ì•ˆ ë¬¸ì œ
- ì¿ í‚¤ ê°’ì€ ì„ì˜ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.<br>
â€¢ í´ë¼ì´ì–¸íŠ¸ê°€ ì¿ í‚¤ë¥¼ ê°•ì œë¡œ ë³€ê²½í•˜ë©´ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ëœë‹¤.<br>
â€¢ ì‹¤ì œ ì›¹ë¸Œë¼ìš°ì € ê°œë°œìëª¨ë“œ -> Application -> Cookie ë³€ê²½ìœ¼ë¡œ í™•ì¸<br>
â€¢ `Cookie: memberId=1` -> `Cookie: memberId=2` (ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì´ë¦„ì´ ë³´ì„) 

- ì¿ í‚¤ì— ë³´ê´€ëœ ì •ë³´ëŠ” í›”ì³ê°ˆ ìˆ˜ ìˆë‹¤.<br>
â€¢ ë§Œì•½ ì¿ í‚¤ì— ê°œì¸ì •ë³´ë‚˜, ì‹ ìš©ì¹´ë“œ ì •ë³´ê°€ ìˆë‹¤ë©´?<br>
â€¢ ì´ ì •ë³´ê°€ ì›¹ ë¸Œë¼ìš°ì €ì—ë„ ë³´ê´€ë˜ê³ , ë„¤íŠ¸ì›Œí¬ ìš”ì²­ë§ˆë‹¤ ê³„ì† í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ì „ë‹¬ëœë‹¤. <br>
â€¢ ì¿ í‚¤ì˜ ì •ë³´ê°€ ë‚˜ì˜ ë¡œì»¬ PCê°€ í„¸ë¦´ ìˆ˜ë„ ìˆê³ , ë„¤íŠ¸ì›Œí¬ ì „ì†¡ êµ¬ê°„ì—ì„œ í„¸ë¦´ ìˆ˜ë„ ìˆë‹¤.

- í•´ì»¤ê°€ ì¿ í‚¤ë¥¼ í•œë²ˆ í›”ì³ê°€ë©´ í‰ìƒ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br>
â€¢ í•´ì»¤ê°€ ì¿ í‚¤ë¥¼ í›”ì³ê°€ì„œ ê·¸ ì¿ í‚¤ë¡œ ì•…ì˜ì ì¸ ìš”ì²­ì„ ê³„ì† ì‹œë„í•  ìˆ˜ ìˆë‹¤.

#### ëŒ€ì•ˆ
- ì¿ í‚¤ì— ì¤‘ìš”í•œ ê°’ì„ ë…¸ì¶œí•˜ì§€ ì•Šê³ , ì‚¬ìš©ì ë³„ë¡œ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ì„ì˜ì˜ í† í°(ëœë¤ ê°’)ì„ ë…¸ì¶œí•˜ê³ , ì„œë²„ì—ì„œ í† í°ê³¼ ì‚¬ìš©ì idë¥¼ ë§¤í•‘í•´ì„œ ì¸ì‹í•œë‹¤. <br>
ê·¸ë¦¬ê³  ì„œë²„ì—ì„œ í† í°ì„ ê´€ë¦¬í•œë‹¤.
- í† í°ì€ í•´ì»¤ê°€ ì„ì˜ì˜ ê°’ì„ ë„£ì–´ë„ ì°¾ì„ ìˆ˜ ì—†ë„ë¡ ì˜ˆìƒ ë¶ˆê°€ëŠ¥ í•´ì•¼ í•œë‹¤.
- í•´ì»¤ê°€ í† í°ì„ í„¸ì–´ê°€ë„ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì„œë²„ì—ì„œ í•´ë‹¹ í† í°ì˜ ë§Œë£Œì‹œê°„ì„ ì§§ê²Œ(ì˜ˆ: 30ë¶„) ìœ ì§€í•œë‹¤. <br>
ë˜ëŠ” í•´í‚¹ì´ ì˜ì‹¬ë˜ëŠ” ê²½ìš° ì„œë²„ì—ì„œ í•´ë‹¹ í† í°ì„ ê°•ì œë¡œ ì œê±°í•˜ë©´ ëœë‹¤.

## 2. ì„¸ì…˜ 
ì•ì„œ ì¿ í‚¤ì— ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë³´ê´€í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ ë³´ì•ˆ ì´ìŠˆê°€ ìˆì—ˆë‹¤. <br><br>
ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ ê²°êµ­ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ëª¨ë‘ ì„œë²„ì— ì €ì¥í•´ì•¼ í•œë‹¤. <br>
ê·¸ë¦¬ê³  í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” ì¶”ì • ë¶ˆê°€ëŠ¥í•œ ì„ì˜ì˜ ì‹ë³„ì ê°’ìœ¼ë¡œ ì—°ê²°í•´ì•¼ í•œë‹¤.<br><br>
ì´ë ‡ê²Œ ì„œë²„ì— ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë³´ê´€í•˜ê³  ì—°ê²°ì„ ìœ ì§€í•˜ëŠ” ë°©ë²•ì„ ì„¸ì…˜ì´ë¼ í•œë‹¤.<br>
ì„¸ì…˜ì„ ì–´ë–»ê²Œ ê°œë°œí• ì§€ ë¨¼ì € ê°œë…ì„ ì´í•´í•´ë³´ì.

### ì„¸ì…˜ ë™ì‘ ë°©ì‹
#### 1) ë¡œê·¸ì¸
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-06 á„‹á…©á„Œá…¥á†« 12 20 30](https://user-images.githubusercontent.com/59405576/177361955-dddc2417-24dc-4ea5-b429-069ae34a55b0.png)
- ì‚¬ìš©ìê°€ `loginId` , `password` ì •ë³´ë¥¼ ì „ë‹¬í•˜ë©´ ì„œë²„ì—ì„œ í•´ë‹¹ ì‚¬ìš©ìê°€ ë§ëŠ”ì§€ í™•ì¸í•œë‹¤.

#### 2) ì„¸ì…˜ ìƒì„±
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-06 á„‹á…©á„Œá…¥á†« 12 20 44](https://user-images.githubusercontent.com/59405576/177362001-8a44a5f1-5475-4a42-ab3f-d52cc34bcb92.png)
- ì„¸ì…˜ IDë¥¼ ìƒì„±í•˜ëŠ”ë°, ì¶”ì • ë¶ˆê°€ëŠ¥í•´ì•¼ í•œë‹¤. 
- UUIDëŠ” ì¶”ì •ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.<br>- `Cookie: mySessionId=zz0101xx-bab9-4b92-9b32-dadb280f4b61`
- ìƒì„±ëœ ì„¸ì…˜ IDì™€ ì„¸ì…˜ì— ë³´ê´€í•  ê°’( `memberA` )ì„ ì„œë²„ì˜ ì„¸ì…˜ ì €ì¥ì†Œì— ë³´ê´€í•œë‹¤.

#### 3) ì„¸ì…˜ idë¥¼ ì‘ë‹µ ì¿ í‚¤ë¡œ ì „ë‹¬
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-06 á„‹á…©á„Œá…¥á†« 12 20 58](https://user-images.githubusercontent.com/59405576/177362034-3ba63e11-bc91-4ad3-8bfe-e1c60b14af11.png)<br>
í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” ê²°êµ­ ì¿ í‚¤ë¡œ ì—°ê²°ì´ ë˜ì–´ì•¼ í•œë‹¤.
- ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì— `mySessionId` ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì„¸ì…˜ID ë§Œ ì¿ í‚¤ì— ë‹´ì•„ì„œ ì „ë‹¬í•œë‹¤. 
- í´ë¼ì´ì–¸íŠ¸ëŠ” ì¿ í‚¤ ì €ì¥ì†Œì— `mySessionId` ì¿ í‚¤ë¥¼ ë³´ê´€í•œë‹¤.<br><br>

ğŸŒŸ ì¤‘ìš”<br>
- ì—¬ê¸°ì„œ ì¤‘ìš”í•œ í¬ì¸íŠ¸ëŠ” íšŒì›ê³¼ ê´€ë ¨ëœ ì •ë³´ëŠ” ì „í˜€ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤. 
- ì˜¤ì§ ì¶”ì • ë¶ˆê°€ëŠ¥í•œ ì„¸ì…˜ IDë§Œ ì¿ í‚¤ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•œë‹¤.

#### 4) í´ë¼ì´ì–¸íŠ¸ì˜ ì„¸ì…˜ id ì¿ í‚¤ ì „ë‹¬ - ë¡œê·¸ì¸ ì´í›„ ì ‘ê·¼
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-06 á„‹á…©á„Œá…¥á†« 12 21 09](https://user-images.githubusercontent.com/59405576/177362083-c0475ad5-bd6e-41e0-ba4d-b9a1b1695e3c.png)
- í´ë¼ì´ì–¸íŠ¸ëŠ” ìš”ì²­ì‹œ í•­ìƒ `mySessionId` ì¿ í‚¤ë¥¼ ì „ë‹¬í•œë‹¤.
- ì„œë²„ì—ì„œëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì „ë‹¬í•œ `mySessionId` ì¿ í‚¤ ì •ë³´ë¡œ ì„¸ì…˜ ì €ì¥ì†Œë¥¼ ì¡°íšŒí•´ì„œ ë¡œê·¸ì¸ì‹œ ë³´ê´€í•œ ì„¸ì…˜ ì •ë³´ë¥¼ ì‚¬ìš©í•œë‹¤.

#### ì •ë¦¬
ì„¸ì…˜ì„ ì‚¬ìš©í•´ì„œ ì„œë²„ì—ì„œ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ê´€ë¦¬í•˜ê²Œ ë˜ì—ˆë‹¤. ë•ë¶„ì— ë‹¤ìŒê³¼ ê°™ì€ ë³´ì•ˆ ë¬¸ì œë“¤ì„ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
- ì¿ í‚¤ ê°’ì„ ë³€ì¡° ê°€ëŠ¥ -> ì˜ˆìƒ ë¶ˆê°€ëŠ¥í•œ ë³µì¡í•œ ì„¸ì…˜Idë¥¼ ì‚¬ìš©í•œë‹¤.
- ì¿ í‚¤ì— ë³´ê´€í•˜ëŠ” ì •ë³´ëŠ” í´ë¼ì´ì–¸íŠ¸ í•´í‚¹ì‹œ í„¸ë¦´ ê°€ëŠ¥ì„±ì´ ìˆë‹¤. -> ì„¸ì…˜Idê°€ í„¸ë ¤ë„ ì—¬ê¸°ì—ëŠ” ì¤‘ìš”í•œ ì •ë³´ê°€ ì—†ë‹¤.
- ì¿ í‚¤ íƒˆì·¨ í›„ ì‚¬ìš© -> í•´ì»¤ê°€ í† í°ì„ í„¸ì–´ê°€ë„ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì„œë²„ì—ì„œ ì„¸ì…˜ì˜ ë§Œë£Œì‹œê°„ì„ ì§§ê²Œ(ì˜ˆ: 30ë¶„) ìœ ì§€í•œë‹¤. <br>
ë˜ëŠ” í•´í‚¹ì´ ì˜ì‹¬ë˜ëŠ” ê²½ìš° ì„œë²„ì—ì„œ í•´ë‹¹ ì„¸ì…˜ì„ ê°•ì œë¡œ ì œê±°í•˜ë©´ ëœë‹¤.

## 3. ì„œë¸”ë¦¿ HTTP ì„¸ì…˜ - 1
ì„œë¸”ë¦¿ì€ ì„¸ì…˜ì„ ìœ„í•´ `HttpSession` ì´ë¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

### HttpSession ì†Œê°œ
ì„œë¸”ë¦¿ì„ í†µí•´ `HttpSession` ì„ ìƒì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì¿ í‚¤ë¥¼ ìƒì„±í•œë‹¤. <br>
`Cookie: JSESSIONID=5B78E23B513F50164D6FDD8C97B0AD05`<br>
ì¿ í‚¤ ì´ë¦„ì´ JSESSIONID ì´ê³ , ê°’ì€ ì¶”ì • ë¶ˆê°€ëŠ¥í•œ ëœë¤ ê°’ì´ë‹¤.<br><br>
ì„œë¸”ë¦¿ì´ ì œê³µí•˜ëŠ” `HttpSession` ì„ ì‚¬ìš©í•˜ë„ë¡ ê°œë°œí•´ë³´ì.

### ğŸ—‚ web
#### `SessionConst`
`src/main/java/hello/login/web/SessionConst.java`
```java
public interface SessionConst {
    String LOGIN_MEMBER = "loginMember";
}
```
`HttpSession` ì— ë°ì´í„°ë¥¼ ë³´ê´€í•˜ê³  ì¡°íšŒí•  ë•Œ, ê°™ì€ ì´ë¦„ì´ ì¤‘ë³µ ë˜ì–´ ì‚¬ìš©ë˜ë¯€ë¡œ, ìƒìˆ˜ë¥¼ í•˜ë‚˜ ì •ì˜í–ˆë‹¤.

#### `LoginController`
`src/main/java/hello/login/web/login/LoginController.java`
##### `login()` & `logout()`
```java
@Slf4j
@Controller
@RequiredArgsConstructor
public class LoginController {

    private final LoginService loginService;

    @PostMapping("/login")
    public String loginV3(@Valid @ModelAttribute LoginForm form, BindingResult bindingResult, HttpServletRequest req){
        if(bindingResult.hasErrors()){
            return "login/loginForm";
        }

        Member loginMember = loginService.login(form.getLoginId(), form.getPassword());

        if(loginMember==null){
            bindingResult.reject("loginFail", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            return "login/loginForm";
        }

        // ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬
        HttpSession session = req.getSession();  // ì„¸ì…˜ì´ ìˆìœ¼ë©´ ìˆëŠ” ì„¸ì…˜ì„ ë°˜í™˜, ì—†ìœ¼ë©´ ì‹ ê·œ ì„¸ì…˜ì„ ìƒì„±í•´ì„œ ë°˜í™˜
        session.setAttribute(SessionConst.LOGIN_MEMBER, loginMember); // ì„¸ì…˜ì— ë¡œê·¸ì¸ íšŒì› ì •ë³´ ë³´ê´€

        return "redirect:/";
    }

    @PostMapping("/logout")
    public String logoutV3(HttpServletRequest req){
        HttpSession session = req.getSession(false);
        if(session!=null){
            session.invalidate(); // ì„¸ì…˜ì„ ì œê±°í•œë‹¤.
        }
        return "redirect:/";
    }
}
```

###### ì„¸ì…˜ ìƒì„±ê³¼ ì¡°íšŒ
ì„¸ì…˜ì„ ìƒì„±í•˜ë ¤ë©´ `request.getSession(true)` ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤. <br>
`public HttpSession getSession(boolean create);`<br><br>
ì„¸ì…˜ì˜ `create` ì˜µì…˜ì— ëŒ€í•´ ì•Œì•„ë³´ì. 
- `request.getSession(true)`<br>- ì„¸ì…˜ì´ ìˆìœ¼ë©´ ê¸°ì¡´ ì„¸ì…˜ì„ ë°˜í™˜í•œë‹¤.<br>- ì„¸ì…˜ì´ ì—†ìœ¼ë©´ ìƒˆë¡œìš´ ì„¸ì…˜ì„ ìƒì„±í•´ì„œ ë°˜í™˜í•œë‹¤. 
- `request.getSession(false)`<br>- ì„¸ì…˜ì´ ìˆìœ¼ë©´ ê¸°ì¡´ ì„¸ì…˜ì„ ë°˜í™˜í•œë‹¤.<br>- ì„¸ì…˜ì´ ì—†ìœ¼ë©´ ìƒˆë¡œìš´ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•ŠëŠ”ë‹¤. `null` ì„ ë°˜í™˜í•œë‹¤.
- `request.getSession()` : ì‹ ê·œ ì„¸ì…˜ì„ ìƒì„±í•˜ëŠ” `request.getSession(true)` ì™€ ë™ì¼í•˜ë‹¤. <br>- ì˜µì…˜ì´ ì—†ì„ ë•Œ, default ê°’ì´ `true` ì´ë‹¤.

###### ì„¸ì…˜ì— ë¡œê·¸ì¸ íšŒì› ì •ë³´ ë³´ê´€
`session.setAttribute(SessionConst.LOGIN_MEMBER, loginMember);`<br>
ì„¸ì…˜ì— ë°ì´í„°ë¥¼ ë³´ê´€í•˜ëŠ” ë°©ë²•ì€ `request.setAttribute(..)` ì™€ ë¹„ìŠ·í•˜ë‹¤. <br>
í•˜ë‚˜ì˜ ì„¸ì…˜ì— ì—¬ëŸ¬ ê°’ì„ ì €ì¥í•  ìˆ˜ ìˆë‹¤.

#### `HomeController` 
`src/main/java/hello/login/web/HomeController.java`
```java
@Slf4j
@Controller
@RequiredArgsConstructor
public class HomeController {

    private final MemberRepository memberRepository;

    @GetMapping("/")
    public String homeLoginV3(HttpServletRequest req, Model model){

        HttpSession session = req.getSession(false);
        if(session == null){
            return "home";
        }

        Member loginMember = (Member)session.getAttribute(SessionConst.LOGIN_MEMBER);

        // ì„¸ì…˜ì— íšŒì› ë°ì´í„°ê°€ ì—†ìœ¼ë©´ home
        if(loginMember == null){
            return "home";
        }

        // ì„¸ì…˜ì´ ìœ ì§€ë˜ë©´ ë¡œê·¸ì¸ìœ¼ë¡œ ì´ë™
        model.addAttribute("member", loginMember);
        return "loginHome";
    }
}
```
- `request.getSession(false)` : `request.getSession()` ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ ê°’ì´ `create: true` ì´ë¯€ë¡œ, ë¡œê·¸ì¸ í•˜ì§€ ì•Šì„ ì‚¬ìš©ìë„ ì˜ë¯¸ì—†ëŠ” ì„¸ì…˜ì´ ë§Œë“¤ì–´ì§„ë‹¤. <br>
ë”°ë¼ì„œ ì„¸ì…˜ì„ ì°¾ì•„ì„œ ì‚¬ìš©í•˜ëŠ” ì‹œì ì—ëŠ” `create: false` ì˜µì…˜ì„ ì‚¬ìš©í•´ì„œ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.
- `session.getAttribute(SessionConst.LOGIN_MEMBER)` : ë¡œê·¸ì¸ ì‹œì ì— ì„¸ì…˜ì— ë³´ê´€í•œ íšŒì› ê°ì²´ë¥¼ ì°¾ëŠ”ë‹¤.

## 4. ì„œë¸”ë¦¿ HTTP ì„¸ì…˜ - 2
ìŠ¤í”„ë§ì´ ì§€ì›í•˜ëŠ” `@SessionAttribute`ì„ ì´ìš©í•˜ë©´, ì„¸ì…˜ì„ ì°¾ê³  ì„¸ì…˜ì— ë“¤ì–´ìˆëŠ” ë°ì´í„°ë¥¼ ì°¾ëŠ” ë²ˆê±°ë¡œìš´ ê³¼ì •ì„ í•œë²ˆì— í¸ë¦¬í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

### ğŸ—‚ web
#### `HomeController` 
`src/main/java/hello/login/web/HomeController.java`
```java
@Slf4j
@Controller
@RequiredArgsConstructor
public class HomeController {

    private final MemberRepository memberRepository;

    @GetMapping("/")
    public String homeLoginV3Spring(
            @SessionAttribute(name = SessionConst.LOGIN_MEMBER, required = false) Member loginMember,
            Model model
    ){
        // ì„¸ì…˜ì— íšŒì› ë°ì´í„°ê°€ ì—†ìœ¼ë©´ home
        if(loginMember == null){
            return "home";
        }

        // ì„¸ì…˜ì´ ìœ ì§€ë˜ë©´ ë¡œê·¸ì¸ìœ¼ë¡œ ì´ë™
        model.addAttribute("member", loginMember);
        return "loginHome";
    }
}
```

##### `@SessionAttribute`
ìŠ¤í”„ë§ì€ ì„¸ì…˜ì„ ë” í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ `@SessionAttribute` ì„ ì§€ì›í•œë‹¤.<br><br>
ì´ë¯¸ ë¡œê·¸ì¸ ëœ ì‚¬ìš©ìë¥¼ ì°¾ì„ ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ë©´ ëœë‹¤. <br>
`@SessionAttribute(name = "loginMember", required = false) Member loginMember`<br>
ì°¸ê³ ë¡œ ì´ ê¸°ëŠ¥ì€ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•ŠëŠ”ë‹¤.

### TrackingModes
ë¡œê·¸ì¸ì„ ì²˜ìŒ ì‹œë„í•˜ë©´ URLì´ ë‹¤ìŒê³¼ ê°™ì´ `jsessionid` ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br>
`http://localhost:8080/;jsessionid=F59911518B921DF62D09F0DF8F83F872`<br><br>
ì´ê²ƒì€ ì›¹ ë¸Œë¼ìš°ì €ê°€ ì¿ í‚¤ë¥¼ ì§€ì›í•˜ì§€ ì•Šì„ ë•Œ ì¿ í‚¤ ëŒ€ì‹  URLì„ í†µí•´ì„œ ì„¸ì…˜ì„ ìœ ì§€í•˜ëŠ” ë°©ë²•ì´ë‹¤. <br>
(ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë ¤ë©´ URLì— ì´ ê°’ì„ ê³„ì† í¬í•¨í•´ì„œ ì „ë‹¬í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— í˜„ì‹¤ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ì–´ë µë‹¤.) <br><br>
íƒ€ì„ë¦¬í”„ ê°™ì€ í…œí”Œë¦¿ì€ ì—”ì§„ì„ í†µí•´ì„œ ë§í¬ë¥¼ ê±¸ë©´ `jsessionid` ë¥¼ URLì— ìë™ìœ¼ë¡œ í¬í•¨í•´ì¤€ë‹¤. <br>
ì„œë²„ ì…ì¥ì—ì„œ ì›¹ ë¸Œë¼ìš°ì €ê°€ ì¿ í‚¤ë¥¼ ì§€ì›í•˜ëŠ”ì§€ í•˜ì§€ ì•ŠëŠ”ì§€ ìµœì´ˆì—ëŠ” íŒë‹¨í•˜ì§€ ëª»í•˜ë¯€ë¡œ, ì¿ í‚¤ ê°’ë„ ì „ë‹¬í•˜ê³ , URLì— `jsessionid` ë„ í•¨ê»˜ ì „ë‹¬í•˜ëŠ” ê²ƒì´ë‹¤.<br><br>
URL ì „ë‹¬ ë°©ì‹ì„ ë„ê³  í•­ìƒ ì¿ í‚¤ë¥¼ í†µí•´ì„œë§Œ ì„¸ì…˜ì„ ìœ ì§€í•˜ê³  ì‹¶ìœ¼ë©´ `application.properties`ì— ë‹¤ìŒ ì˜µì…˜ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤. <br>
ì´ë ‡ê²Œ í•˜ë©´ URLì— `jsessionid` ê°€ ë…¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.

#### `application.properties`
```
server.servlet.session.tracking-modes=cookie
```

# ğŸ” ì„¸ì…˜ ì •ë³´ì™€ íƒ€ì„ì•„ì›ƒ ì„¤ì •

## ì„¸ì…˜ ì •ë³´ í™•ì¸
ì„¸ì…˜ì´ ì œê³µí•˜ëŠ” ì •ë³´ë“¤ì„ í™•ì¸í•´ë³´ì.
### ğŸ—‚ web
#### `SessionInfoController`
`src/main/java/hello/login/web/session/SessionInfoController.java`
```java
@Slf4j
@RestController
public class SessionInfoController {

    @GetMapping("/session-info")
    public String sessionInfo(HttpServletRequest req){
        HttpSession session = req.getSession(false);
        if(session == null){
            return "ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤.";
        }

        // ì„¸ì…˜ ë°ì´í„° ì¶œë ¥
        session.getAttributeNames().asIterator()
                .forEachRemaining(name -> log.info("session name={}, value={}", name, session.getAttribute(name)));

        log.info("sessionId={}", session.getId());
        log.info("MaxInactiveInterval={}", session.getMaxInactiveInterval()); // ì„¸ì…˜ì˜ ìœ íš¨ ì‹œê°„ (ì´ˆ)
        log.info("CreationTime={}", new Date(session.getCreationTime())); // ì„¸ì…˜ì´ ìƒì„±ì¼ì‹œ
        log.info("LastAccessedTime={}", new Date(session.getLastAccessedTime())); // ì„¸ì…˜ì— ìµœê·¼ì— ì ‘ê·¼í•œ ì‹œê°„
        log.info("isNew={}", session.isNew()); // ì§€ê¸ˆ ë§Œë“  ì„¸ì…˜ì¸ì§€, ì´ë¯¸ ì¡´ì¬í•˜ë˜ ì„¸ì…˜ì¸ì§€

        return "ì„¸ì…˜ ì¶œë ¥";
    }
}
```
- `sessionId` : ì„¸ì…˜Id, `JSESSIONID` ì˜ ê°’ì´ë‹¤. ì˜ˆ) `34B14F008AA3527C9F8ED620EFD7A4E1`
- `maxInactiveInterval` : ì„¸ì…˜ì˜ ìœ íš¨ ì‹œê°„, ì˜ˆ) 1800ì´ˆ, (30ë¶„)
- `creationTime` : ì„¸ì…˜ ìƒì„±ì¼ì‹œ
- `lastAccessedTime` :ì„¸ì…˜ê³¼ ì—°ê²°ëœ ì‚¬ìš©ìê°€ ìµœê·¼ì— ì„œë²„ì— ì ‘ê·¼í•œ ì‹œê°„,í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ `sessionId` ( `JSESSIONID` )ë¥¼ ìš”ì²­í•œ ê²½ìš°ì— ê°±ì‹ ëœë‹¤.
- `isNew` : ìƒˆë¡œ ìƒì„±ëœ ì„¸ì…˜ì¸ì§€, ì•„ë‹ˆë©´ ì´ë¯¸ ê³¼ê±°ì— ë§Œë“¤ì–´ì¡Œê³ , í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ `sessionId` ( `JSESSIONID` )ë¥¼ ìš”ì²­í•´ì„œ ì¡°íšŒëœ ì„¸ì…˜ì¸ì§€ ì—¬ë¶€

## ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì •
ì„¸ì…˜ì€ ì‚¬ìš©ìê°€ ë¡œê·¸ì•„ì›ƒì„ ì§ì ‘ í˜¸ì¶œí•´ì„œ `session.invalidate()` ê°€ í˜¸ì¶œ ë˜ëŠ” ê²½ìš°ì— ì‚­ì œëœë‹¤. <br>
ê·¸ëŸ°ë° ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ìëŠ” ë¡œê·¸ì•„ì›ƒì„ ì„ íƒí•˜ì§€ ì•Šê³ , ê·¸ëƒ¥ ì›¹ ë¸Œë¼ìš°ì €ë¥¼ ì¢…ë£Œí•œë‹¤. <br><br>
ë¬¸ì œëŠ” HTTPê°€ ë¹„ ì—°ê²°ì„±(ConnectionLess)ì´ë¯€ë¡œ ì„œë²„ ì…ì¥ì—ì„œëŠ” í•´ë‹¹ ì‚¬ìš©ìê°€ ì›¹ ë¸Œë¼ìš°ì €ë¥¼ ì¢…ë£Œí•œ ê²ƒì¸ì§€ ì•„ë‹Œì§€ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ë‹¤. <br>
ë”°ë¼ì„œ ì„œë²„ì—ì„œ ì„¸ì…˜ ë°ì´í„°ë¥¼ ì–¸ì œ ì‚­ì œí•´ì•¼ í•˜ëŠ”ì§€ íŒë‹¨í•˜ê¸°ê°€ ì–´ë µë‹¤.<br><br>
ì´ ê²½ìš° ë‚¨ì•„ìˆëŠ” ì„¸ì…˜ì„ ë¬´í•œì • ë³´ê´€í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
- ì„¸ì…˜ê³¼ ê´€ë ¨ëœ ì¿ í‚¤( `JSESSIONID` )ë¥¼ íƒˆì·¨ ë‹¹í–ˆì„ ê²½ìš° ì˜¤ëœ ì‹œê°„ì´ ì§€ë‚˜ë„ í•´ë‹¹ ì¿ í‚¤ë¡œ ì•…ì˜ì ì¸ ìš”ì²­ì„ í•  ìˆ˜ ìˆë‹¤.
- ì„¸ì…˜ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë©”ëª¨ë¦¬ì— ìƒì„±ëœë‹¤. ë©”ëª¨ë¦¬ì˜ í¬ê¸°ê°€ ë¬´í•œí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ê¼­ í•„ìš”í•œ ê²½ìš°ë§Œ ìƒì„±í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. <br>
10ë§Œëª…ì˜ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•˜ë©´ 10ë§Œê°œì˜ ì„¸ì…˜ì´ ìƒì„±ë˜ëŠ” ê²ƒì´ë‹¤.

## ì„¸ì…˜ì˜ ì¢…ë£Œ ì‹œì 
ì„¸ì…˜ ìƒì„± ì‹œì ì´ ì•„ë‹ˆë¼ ì‚¬ìš©ìê°€ ì„œë²„ì— ìµœê·¼ì— ìš”ì²­í•œ ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ 30ë¶„ ì •ë„ë¥¼ ìœ ì§€í•œë‹¤. <br>
ì´ë ‡ê²Œ í•˜ë©´ ì‚¬ìš©ìê°€ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©´, ì„¸ì…˜ì˜ ìƒì¡´ ì‹œê°„ì´ 30ë¶„ìœ¼ë¡œ ê³„ì† ëŠ˜ì–´ë‚˜ê²Œ ëœë‹¤. <br>
ë”°ë¼ì„œ 30ë¶„ ë§ˆë‹¤ ë¡œê·¸ì¸í•´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ì´ ì‚¬ë¼ì§„ë‹¤. `HttpSession` ì€ ì´ ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.

## ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì •
### ìŠ¤í”„ë§ ë¶€íŠ¸ë¡œ ê¸€ë¡œë²Œ ì„¤ì •
#### `application/properties`
ì•„ë˜ ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.<br>
ê¸°ë³¸ì€ 1800(30ë¶„)ì´ë‹¤.<br>
(ê¸€ë¡œë²Œ ì„¤ì •ì€ ë¶„ ë‹¨ìœ„ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤. 60(1ë¶„), 120(2ë¶„), ...)
```
server.servlet.session.timeout=1800
```

### íŠ¹ì • ì„¸ì…˜ ë‹¨ìœ„ë¡œ ì‹œê°„ ì„¤ì •
```
session.setMaxInactiveInterval(1800); //1800ì´ˆ
```

## ì •ë¦¬
ì„œë¸”ë¦¿ì˜ HttpSession ì´ ì œê³µí•˜ëŠ” íƒ€ì„ì•„ì›ƒ ê¸°ëŠ¥ ë•ë¶„ì— ì„¸ì…˜ì„ ì•ˆì „í•˜ê³  í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br>
ğŸš¨ ì‹¤ë¬´ì—ì„œ ì£¼ì˜í•  ì ì€ ì„¸ì…˜ì—ëŠ” ìµœì†Œí•œì˜ ë°ì´í„°ë§Œ ë³´ê´€í•´ì•¼ í•œë‹¤ëŠ” ì ì´ë‹¤. <br>
ë³´ê´€í•œ ë°ì´í„° ìš©ëŸ‰ * ì‚¬ìš©ì ìˆ˜ë¡œ ì„¸ì…˜ì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ê¸‰ê²©í•˜ê²Œ ëŠ˜ì–´ë‚˜ì„œ ì¥ì• ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆë‹¤. <br>
ì¶”ê°€ë¡œ ì„¸ì…˜ì˜ ì‹œê°„ì„ ë„ˆë¬´ ê¸¸ê²Œ ê°€ì ¸ê°€ë©´ ë©”ëª¨ë¦¬ ì‚¬ìš©ì´ ê³„ì† ëˆ„ì  ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì ë‹¹í•œ ì‹œê°„ì„ ì„ íƒí•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤. <br>
ê¸°ë³¸ì´ 30 ë¶„ì´ë¼ëŠ” ê²ƒì„ ê¸°ì¤€ìœ¼ë¡œ ê³ ë¯¼í•˜ë©´ ëœë‹¤.

***
<br>

    ğŸ’› ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ğŸ‘»

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}